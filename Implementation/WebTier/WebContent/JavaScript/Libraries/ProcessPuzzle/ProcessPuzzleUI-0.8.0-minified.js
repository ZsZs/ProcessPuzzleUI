var ArrayList=new Class({initialize:function(){this.array=new Array()},add:function(a){this.array[this.array.length]=a},addAll:function(b){if(b instanceof Array){for(var a=0;a<b.length;a++){this.add(b[a])}}else{if(b instanceof ArrayList){for(var a=0;a<b.size();a++){this.add(b.get(a))}}}},clear:function(){this.array=new Array()},clone:function(){var a=new ArrayList();this.each(function(c,b){a.add(c)},this);return a},contains:function(b){for(var a=0;a<this.array.length;a++){if(this.array[a]==b){return true}}return false},each:function(c,d){for(var b=0,a=this.size();b<a;b++){c.call(d,this.get(b),b,this)}},equals:function(b){if(!instanceOf(b,ArrayList)){return false}if(b.size()!=this.size()){return false}for(var a=0;a<this.size();a++){if(this.get(a)!=b.get(a)){return false}}return true},get:function(a){return this.array[a]},getLast:function(){return this.get(this.size()-1)},indexOf:function(b){var a=null;this.array.some(function(d,c){if(d.equals(b)){a=c;return true}},this);return a},isEmpty:function(){if(this.size()>0){return false}else{return true}},iterator:function(){return new ArrayListIterator(this)},remove:function(a){var b=this.get(a);if(b){this.array[a]=null;this.array=this.array.clean()}},size:function(){return this.array.length}});var ArrayListIterator=new Class({initialize:function(a){this.arrayList=a;this.index=0},hasNext:function(){return this.index<this.arrayList.size()},next:function(){return this.arrayList.get(this.index++)}});function AssertUtil(){}new AssertUtil();AssertUtil.assertInclude=function(a,b){if(a==null){throw new AssertException("file "+b+" was not included ")}};AssertUtil.assertParamNotNull=function(a,b){if(a==null){throw new IllegalArgumentException("Parameter must not be null: "+b)}};AssertUtil.assertParamIsNotEmpty=function(a,b){AssertUtil.assertParamNotNull(a,b);if(StringUtil.isEmpty(a)){throw new IllegalArgumentException("Parameter must not be empty: "+b)}};AssertUtil.assertIntegerParam=function(b,c){AssertUtil.assertParamNotNull(b,c);var a=parseInt(b,10);if((a==null)||(isNaN(a))){throw new IllegalArgumentException("Invalid Integer Parameter: "+c)}};AssertUtil.assertTrue=function(b,a){if(!b){throw new IllegalArgumentException("Expression: "+a+" evaluated to false.")}};AssertUtil.assertGreaterThanZeroParam=function(b,c){AssertUtil.assertIntegerParam(b,c);var a=parseInt(b,10);if(a<=0){throw new IllegalArgumentException(" assertGreaterThanZeroParam : "+c)}};AssertUtil.assertInstance=function(c,a,b){AssertUtil.assertParamNotNull(c,"param");AssertUtil.assertParamFalse(typeof(a)=="string","Invalid clazz parameter");if(!(c instanceof a)){throw new IllegalArgumentException(" Invalid parameter must be instance of "+b)}};AssertUtil.assertParamInstance=function(c,a,b){if(!(c instanceof a)){throw new IllegalArgumentException(" Invalid parameter must be instance of "+b)}};AssertUtil.assertResultNotNull=function(a,b){if(a==null){throw new AssertException("Invalid result value: "+b)}};AssertUtil.assertParamFalse=function(b,a){if(b){throw new IllegalArgumentException("AssertParamFalse Exception message: "+a)}};AssertUtil.assertMethodExists=function(a,b){AssertUtil.assertParamNotNull(a,"object");if(a[b]==null){throw new AssertException(" Object "+a+" does not have function :"+b)}};AssertUtil.assertMemberState=function(f,b,a,e,d,c){if(d){if(f==null){throw new AssertException(" Member "+b+" must not be null ")}if(!(f instanceof a)){throw new AssertException(" Invalid state "+b+" must be instance of "+e)}}else{if(f!=null){if(!(f instanceof a)){throw new AssertException("Invalid state "+b+" must be instance of "+e)}}}};AssertUtil.assertMemberStateString=function(d,a,c,b){if(c){if(typeof(d)!=typeof(" ")){throw new AssertException(new AssertException("Invalid state "+a+" must be instance of string and not "+typeof(d)))}if(StringUtil.isEmpty(d)){throw new AssertException("AssertException "+a+" must not be empty")}}else{if(d!=null){if(typeof(d)!=typeof(" ")){throw new AssertException("Invalid state "+a+" must be instance string ")}}}};var HashMap=new Class({initialize:function(){this.table=new Array();this.len=8;this.length=0},clear:function(){for(var a=0;a<this.table.length;a++){this.table[a]=null}this.length=0},containsKey:function(b){var d=this.hash(b);var a=this.indexFor(d);var c=this.table[a];while(c!=null){if(c.hash==d&&b.equals(c.key)){return true}c=c.next}return false},containsValue:function(c){if(c==null){return false}var b=this.table;for(var a=0;a<b.length;a++){for(var d=b[a];d!=null;d=d.next){if(c.equals(d.value)){return true}}}return false},each:function(d,e){var c=this.iterator();var a=0;while(c.hasNext()){var b=c.next();d.call(e,b,a,this);a++}},equals:function(f){if(f.size()!=this.size()){return false}for(var b=this.iterator();b.hasNext();){var d=b.next();var a=d.getKey();var c=d.getValue();if(!c.equals(f.get(a))){return false}}return true},get:function(a){if(!a){return null}var b=this.getEntry(a);if(b){return b.value}else{return null}},hashCode:function(){var b=0;for(var a=this.iterator();a.hasNext();){b+=a.next().hashCode()}return b},isEmpty:function(){return this.length==0},iterator:function(){var a=this.table.length;var b=null;while(a>0&&b==null){b=this.table[--a]}return new HashIterator(this.table,a,b)},put:function(c,f){var g=this.hash(c);var a=this.indexFor(g);for(var e=this.table[a];e!=null;e=e.next){if(e.hash==g&&c.equals(e.key)){var b=e.value;e.value=f;return b}}this.addEntry(g,c,f,a);var d=Math.ceil(this.length*1.5);if(d>this.len){this.len=this.len<<1;this.rehash()}return null},putAll:function(d){var a=false;for(var b=d.iterator();b.hasNext();){var c=b.next();if(this.put(c.getKey(),c.getValue())){a=true}}},remove:function(a){var b=this.removeEntryForKey(a);return(b==null?null:b.value)},removeEntryForKey:function(b){var g=this.hash(b);var a=this.indexFor(g);var d=this.table[a];var f=d;while(f!=null){var c=f.next;if(f.hash==g&&b.equals(f.key)){this.length--;if(d.equals(f)){this.table[a]=c}else{d.next=c}return f}d=f;f=c}return f},size:function(){return this.length},toString:function(){return this.getKey()+"="+this.getValue()},addEntry:function(d,b,c,a){this.table[a]=new Entry(d,b,c,this.table[a]);this.length++}.protect(),getEntry:function(b){var d=this.hash(b);var a=this.indexFor(d);var c=this.table[a];while(true){if(c==null){return null}if(c.hash==d&&b.equals(c.key)){return c}c=c.next}},hash:function(a){var b=a.hashCode();return b}.protect(),indexFor:function(b){var a=b&(this.len-1);return a}.protect(),rehash:function(){var a=this.table;this.table=new Array();for(var c=0;c<a.length;c++){var f=a[c];if(f!=null){a[c]=null;do{var d=f.next;var b=this.indexFor(f.hash);f.next=this.table[b];this.table[b]=f;f=d}while(f!=null)}}}.protect()});var Entry=new Class({initialize:function(d,a,c,b){this.value=c;this.next=b;this.key=a;this.hash=d},getKey:function(){return this.key},getValue:function(){return this.value},setValue:function(b){var a=this.value;this.value=b;return a},equals:function(d){var a=d;var g=this.getKey();var c=a.getKey();var f=this.getValue();var b=a.getValue();return(g.equals(c)&&f.equals(b))}});var HashIterator=new Class({initialize:function(c,b,a){this.table=c;this.nextEntry=a;this.index=b;this.current=null},hasNext:function(){return this.nextEntry!=null},next:function(){var c=this.nextEntry;if(c==null){throw"No such Element"}var d=c.next;var b=this.table;var a=this.index;while(d==null&&a>0){d=b[--a]}this.index=a;this.nextEntry=d;this.current=c;return this.current}});var HashSet=new Class({initialize:function(){this.map=new HashMap();this.ZERO=0},add:function(a){this.map.put(a,this.ZERO)==null},addAll:function(c){var a=false;for(var b=c.iterator();b.hasNext();){if(this.add(b.next())){a=true}}return a},clear:function(){this.map.clear()},contains:function(a){return this.map.containsKey(a)},each:function(d,e){var c=this.iterator();var a=0;while(c.hasNext()){var b=c.next();d.call(e,b,a,this);a++}},equals:function(b){if(b.size()!=this.size()){return false}for(var a=this.iterator();a.hasNext();){if(!b.contains(a.next())){return false}}return true},hashCode:function(){var b=0;for(var a=this.iterator();a.hasNext();){b+=a.next().hashCode()}return b},isEmpty:function(){return this.map.isEmpty()},iterator:function(){return new SetIterator(this.map)},remove:function(a){return this.map.remove(a).equals(this.ZERO)},size:function(){return this.map.size()},toArray:function(){var a=new Array();var b=0;for(var c=this.iterator();c.hasNext();){a[b++]=c.next()}return a},hashIterator:function(a){this.it=a}.protect()});var SetIterator=new Class({initialize:function(a){this.mapIterator=a.iterator()},hasNext:function(){return this.mapIterator.hasNext()},next:function(){return this.mapIterator.next().getKey()}});var WebUIException=new Class({Implements:Options,options:{cause:null,description:"Please overwrite this option.",message:"",name:"WebUIException",source:null},initialize:function(a){this.setOptions(a);this.parameters},stackTrace:function(){var a="";if(this.options.cause&&this.options.cause.stackTrace()){a+="\n"+this.options.cause.stackTrace()}return a},getCause:function(){return this.options.cause},getDescription:function(){return this.options.description},getMessage:function(){return this.options.description.substitute(this.parameters)},getName:function(){return this.options.name},getSource:function(){return this.options.source}});var IllegalArgumentException=new Class({Extends:WebUIException,options:{description:"Argument: '{argumentName}' has inappropriate value: '{argumentValue}'.",name:"IllegalArgumentException"},initialize:function(c,b,a){this.parent(a);this.parameters={argumentName:c,argumentValue:b}}});Object.extend({hashCode:function(a){var d=0;var c=a.toString();for(var b=0;b<c.length;b++){d=31*d+c.charCodeAt(b)}return d},isA:function(a,b){var c=typeOf(b);if(c=="string"){var e=b.split("."),d=e.shift();b=window[d];if(!b){return false}while(d=e.shift()){if(!d in b){return false}b=b[d]}c=typeOf(b)}if(["function","class"].contains(c)){return(a instanceof b)}return false},typeMatches:function(a,b){return a.getClass()===b.getClass()},equals:function(a,c){if(!a.typeMatches(c)){return false}if(typeOf(a)=="object"){for(var b in a){if(a[b]!=c[b]){return false}}return true}else{return a.toString()===c.toString()}}});Class.implement({equals:function(a){return this.hashCode()==a.hashCode()},hashCode:function(){var a=Object.hashCode(this.prototype.initialize.$origin);return a}});var JavaObject=new Class({hashCode:function(){return Object.hashCode(this)},typeMatches:function(a){return Object.typeMaches(this,a)},equals:function(a){return Object.equals(this,a)}});Array.implement({equals:function(b){var a=true;this.each(function(d,c){var e=d.equals(b[c]);if(!e){a=false}});return a}});Boolean.implement({parseBoolean:function(booleanString){return eval(booleanString)}});function parseBoolean(a){return new Boolean().parseBoolean(a)}String.implement({compareTo:function(c){if(!this.typeMatches(c)){throw"Type Mismacth!"}var b=this.toString();var a=c.toString();if(b===a){return 0}else{if(b>a){return 1}else{return -1}}},compareToIgnoreCase:function(c){if(!this.typeMatches(c)){throw"Type Mismacth!"}var b=this.toUpperCase();var a=c.toUpperCase();if(b===a){return 0}else{if(b>a){return 1}else{return -1}}},concat:function(a){return new String(this.toString()+a)},endsWith:function(a){return this.substring(this.length-a.length)==a},equals:function(a){return Object.equals(this,a)},equalsIgnoreCase:function(a){if(typeOf(a)!="string"){return false}return this.toUpperCase()===a.toUpperCase()},hashCode:function(){return Object.hashCode(this)},startsWith:function(a){return this.substring(0,a.length)==a},toCharArray:function(){var b=new Array();for(var a=0;a<this.length;a++){b[a]=this.charAt(a)}return b},trim:function(){return this.replace(/(^\s*)|(\s*$)/g,"")},typeMatches:function(a){return typeOf(this)===typeOf(a)}});Number.implement({compareTo:function(a){if(!this.typeMatches(a)){return false}return this-a},equals:function(a){if(!this.typeMatches(a)){return false}return this.toString()==a.toString()},hashCode:function(){return(this)},toBinaryString:function(a){return a.toString(2)},toHexString:function(a){return a.toString(16)}});Date.implement({compareTo:function(d){if(!this.typeMatches(d)){return false}var c=this.getTime();var a=d.getTime();var e=c-a;var b=e&4294967295;return b},equals:function(a){if(!this.typeMatches(a)){return false}return this.getTime()==a.getTime()},hashCode:function(){var b=this.getTime();var c=Number.toHexString(b);var d=0;if(c.length>8){d=parseInt(c.substring(0,c.length-8),16)}var a=b&4294967295;return a^d},typeMatches:function(a){return typeOf(this)===typeOf(a)}});Function.implement({equals:function(a){if(!this.typeMatches(a)){return false}return this===a},typeMatches:function(a){return typeOf(this)===typeOf(a)}});var LinkedHashMap=new Class({Extends:HashMap,initialize:function(){this.parent();this.firstEntry=null;this.lastEntry=null},clear:function(){this.firstEntry=null;this.lastEntry=null;this.parent()},each:function(d,e){var c=this.iterator();var a=0;while(c.hasNext()){var b=c.next();d.call(e,b,a,this);a++}},first:function(){return this.firstEntry.getValue()},firstKey:function(){if(this.length>0){return this.firstEntry.getKey()}else{return null}},iterator:function(){return new LinkedHashIterator(this.firstEntry)},last:function(){return this.lastEntry.getValue()},lastKey:function(){if(this.length>0){return this.lastEntry.getKey()}else{return null}},next:function(a){if(!a){return null}var c=this.getEntry(a);var b=c.getNextEntry();if(b){return b.getValue()}else{return null}},nextKey:function(a){if(!a){return null}var c=this.getEntry(a);var b=c.getNextEntry();if(b){return b.getKey()}else{return null}},previous:function(a){return this.get(this.previousKey(a))},previousKey:function(a){if(!a){return null}var b=this.getEntry(a);return this.findKeyBySerialIndex(b.getSerialIndex()-1)},addEntry:function(e,b,d,a){var c=new LinkedEntry(e,b,d,this.table[a],this.length,this.lastEntry);this.table[a]=c;if(this.firstEntry==null){this.firstEntry=c}if(this.lastEntry){this.lastEntry.setNextEntry(c)}this.lastEntry=c;this.length++}.protect(),findKeyBySerialIndex:function(b){var a=null;this.each(function(d,c){if(d.getSerialIndex()==b){a=d.getKey()}},this);return a}.protect()});var LinkedEntry=new Class({Extends:Entry,initialize:function(f,b,d,c,e,a){this.parent(f,b,d,c);this.nextEntry=null;this.previousEntry=a;this.serialIndex=e},getNextEntry:function(){return this.nextEntry},getSerialIndex:function(){return this.serialIndex},setNextEntry:function(a){this.nextEntry=a}});var LinkedHashIterator=new Class({initialize:function(a){this.currentEntry=a},hasNext:function(){return this.currentEntry!=null},next:function(){var a=this.currentEntry;this.currentEntry=a.getNextEntry();return a}});var OptionsResource=new Class({Implements:[Options],options:{nameSelector:"@name",optionSelector:"option",valueSelector:"@value"},initialize:function(b,a){assertThat(b,not(nil()));this.setOptions(a);this.definitionElement=b;this.optionsAsText="";this.optionsObject},unmarshall:function(){this.unmarshallOptions();this.evaluateOptions()},getOptions:function(){return this.optionsObject},evaluateOptions:function(){this.optionsObject=eval("({"+this.optionsAsText+"})")}.protect(),unmarshallOptions:function(){var a=XmlResource.selectNodes(this.options.optionSelector,this.definitionElement);a.each(function(b,d){if(d>0){this.optionsAsText+=", "}var c=XmlResource.selectNodeText(this.options.nameSelector,b);var e=XmlResource.selectNodeText(this.options.valueSelector,b);this.optionsAsText+=c+" : "+e},this)}.protect()});var RemoteResource=new Class({Extends:Request,options:{async:true,method:"get",nameSpaces:"xmlns:pp='http://www.processpuzzle.com'"},initialize:function(b,a){assertThat(b,not(nil()));this.parent(a);this.options.url=b},isSuccess:function(){try{return(location.protocol==="file:"&&!this.status&&this.status===0&&(this.response.text||this.response.xml))||(this.status>=200&&this.status<300)||(this.status===304)||(this.status===1223)}catch(a){}return false},retrieve:function(){try{this.send(this.options.url)}catch(a){if(a.name=="NS_ERROR_FILE_NOT_FOUND"){this.failure()}else{if(a.name=="Error"){this.failure()}else{throw new a}}}},getUri:function(){return this.options.url},isAsync:function(){return this.options.async}});var ResourceUri=new Class({Implements:Options,options:{applyCacheBuster:false,componentName:"ResourceUri",contentType:"xml",documentType:null,documentTypeKey:"documentType"},initialize:function(c,a,b){assertThat(c,not(nil()));this.setOptions(b);this.locale=a;this.uri=c;this.determineDocumentType();if(this.options.applyCacheBuster){this.uri=this.appendCacheBusterParameterToUri(this.uri)}},appendCacheBusterParameterToUri:function(a){if(a.indexOf("?")==-1){a+="?"}else{a+="&"}a+="cacheBuster=";a+=new Date().getTime();return a},determineLocalizedUri:function(){return this.uri.substring(0,this.uri.lastIndexOf("."+this.options.contentType))+"_"+this.locale.getLanguage()+"."+this.options.contentType},isLocal:function(){var a=new URI(this.uri);var b=new URI(document.location.href);return a.get("host")==""||a.get("host")==b.get("host")},getDocumentType:function(){return this.options.documentType},getUri:function(){return this.uri},determineDocumentType:function(){if(!this.options.documentType){var a=new URI(this.uri);if(a.get("data")&&a.getData(this.options.documentTypeKey)){this.options.documentType=AbstractDocument.Types[a.getData(this.options.documentTypeKey)]}}}.protect()});var StringTokenizer=new Class({Implements:[Options],options:{delimiters:" \t\n\r\f",returnTokens:false},initialize:function(b,a){this.setOptions(a);this.s=b;this.current=0;if(!this.returnTokens){while((this.current<this.s.length)&&(this.options.delimiters.indexOf(this.s.charAt(this.current))>=0)){this.current++}}if(this.current>=this.s.length){this.moreTokens=false}else{this.moreTokens=true}},countTokens:function(){var a=0;while(this.hasMoreTokens()){a++;this.nextToken()}return a},hasMoreTokens:function(){return this.moreTokens},nextToken:function(c){var d,b,a;if(arguments.length>=1){this.delimiters=delimiters}d=this.current;while((this.current<this.s.length)&&(this.options.delimiters.indexOf(this.s.charAt(this.current))<0)){this.current++}if(this.current==d){this.current++}a=this.current-d;b=this.s.substr(d,a);if(!this.returnTokens){while((this.current<this.s.length)&&(this.options.delimiters.indexOf(this.s.charAt(this.current))>=0)){this.current++}}if(this.current>=this.s.length){this.moreTokens=false}return b}});var TimeOutBehaviour=new Class({Implements:[Options],Binds:["checkTimeOut"],options:{delay:200,maxTries:20},initialize:function(a){this.setOptions(a);this.checkedProcessName;this.numberOfTries;this.timer},checkTimeOut:function(){this.numberOfTries++;if(this.numberOfTries>=this.options.maxTries){clearInterval(this.timer);throw new TimeOutException(this.options.componentName,this.checkedProcessName)}},startTimeOutTimer:function(a){this.checkedProcessName=a;this.numberOfTries=0;this.timer=this.checkTimeOut.periodical(this.options.delay)},stopTimeOutTimer:function(){clearInterval(this.timer)}});var TimeOutException=new Class({Extends:WebUIException,options:{description:"Executing the '{componentName}' element's '{processName}' timed out. See the stack trace for the root cause.",name:"TimeoutException"},initialize:function(a,c,b){this.parent(b);this.parameters={componentName:a,processName:c};this.componentName=a;this.processName=c},getComponentName:function(){return this.componentName},getProcessName:function(){return this.processName},});var UndefinedXmlResourceException=new Class({Extends:WebUIException,options:{description:"Given xml resource: '{resourceName}' doesn't exist or can't be accessed.",name:"UndefinedXmlResourceException"},initialize:function(b,a){this.parent(a);this.parameters={resourceName:b}}});var lastUniqueIdentifier=0;var UniqueId=new Class({initialize:function(a){this.prefix=typeOf(a)=="string"?a:""},generate:function(){lastUniqueIdentifier++;return this.prefix+lastUniqueIdentifier.toString(16-this.prefix.length)}});UniqueId.generate=function(a){var b=new UniqueId(a);return b.generate()};var XPathSelectionException=new Class({Extends:WebUIException,options:{description:"XPath selector: '{selector}' didn't resulted any element of XML: '{xmlResourceUri}'.",name:"XPathSelectionException"},initialize:function(a,c,b){this.parent(b);this.parameters={selector:a,xmlResourceUri:c}}});var XmlResource=new Class({Extends:Request,options:{applyCacheBuster:true,nameSpaces:"xmlns:pp='http://www.processpuzzle.com'",onComplete:function(a){if(a){this.xmlAsText=a;if(this.options.parseOnComplete){this.xmlDoc=Sarissa.getDomDocument();var b=new DOMParser();this.xmlDoc=b.parseFromString(a,"text/xml")}}},onException:function(b,a){},onFailure:function(a){},parseOnComplete:true},initialize:function(b,a){assertThat(b,not(nil()));assertThat(Sarissa.XPATH_INITIALIZED,is(true));if(this.options.applyCacheBuster){this.resourceUri=new ResourceUri(b,null,{applyCacheBuster:true});b=this.resourceUri.getUri()}this.parent(a);this.options.url=b;this.options.method="get";this.options.async=false;this.xmlAsText=null;this.xmlDoc=null;this.refreshResource()},createElement:function(c,b){var a=this.xmlDoc.createElement(c);if(b&&b.text){a.appendChild(this.xmlDoc.createTextNode(b.text))}return a},determineAttributeValue:function(b,a){return XmlResource.determineAttributeValue(b,a)},determineNodeText:function(a){return XmlResource.determineNodeText(a)},injectElement:function(c,d,b){assertThat(c,not(nil()));assertThat(d,not(nil()));var a=this.selectNode(d);if(!a){throw new XPathSelectionException(d,this.options.url)}a.appendChild(c)},isSuccess:function(){try{return !this.status&&location.protocol==="file:"||(this.status>=200&&this.status<300)||this.status===304||this.status===1223||this.status===0}catch(a){}return false},release:function(){this.xmlDoc=null},selectNode:function(a,c){var b=this.selectNodes(a,c);if(b){return b[0]}else{return null}},selectNodes:function(a,f){var c=f!=null?f:this.xmlDoc;var b=null;try{b=c.selectNodes(a);if(typeOf(b)=="collection"){b=Array.from(b)}}catch(d){return null}return b},selectNodeText:function(a,d,b){var c=this.selectNodes(a,d);if(c.length>0&&c[0]){return XmlResource.determineNodeText(c[0])}else{if(b){return b}else{return null}}},refreshResource:function(){try{this.send(this.options.url)}catch(a){throw new UndefinedXmlResourceException(this.options.url)}if(this.options.parseOnComplete&&this.xmlDoc==null){throw new UndefinedXmlResourceException(this.options.url)}if(this.xmlDoc){this.xmlDoc.setProperty("SelectionNamespaces","xmlns:xsl='http://www.w3.org/1999/XSL/Transform'  "+this.options.nameSpaces);this.xmlDoc.setProperty("SelectionLanguage","XPath")}},transform:function(a){},getDocument:function(){return this.xmlDoc},getUri:function(){return this.options.url},getXmlAsText:function(){return this.xmlAsText},isAsync:function(){return this.options.async}});XmlResource.determineAttributeValue=function(c,b,a){var d=c.selectNodes("@"+b);if(d&&d.length==1){return d[0].nodeValue}else{if(a){return a}else{return null}}};XmlResource.determineNodeText=function(c,a){var b=null;if(c){b=Sarissa.getText(c);if(!b){b=a}}return b};XmlResource.selectNode=function(a,b){var c=XmlResource.selectNodes(a,b);if(c){return c[0]}else{return null}};XmlResource.selectNodes=function(a,b){var d=null;try{d=b.selectNodes(a);if(typeOf(d)=="collection"){d=Array.from(d)}}catch(c){log4javascript.getDefaultLogger().debug("Selector: '"+a+"' caused excection: "+c.message);return null}return d};XmlResource.selectNodeText=function(a,d,c,b){var e=XmlResource.selectNode(a,d,c);if(!e&&b){return b}else{return XmlResource.determineNodeText(e,b)}};function TransformXML(d,a){var b=new XmlResource(d);var c=new XmlResource(a);var e=XMLDocument();b.transformNodeToObject(c,e);return e}function XMLTransformator(e,a){var d=new XML();d.load(e);var c=new XSLT(a);var f=new XML();this.getSourceXML=function(){return d};this.getResultXML=function(){return f};this.transform=b;function b(){f=new XML(c.transform(d));return f.getDOM()}}function RemoveWhitespaceNodesFromXML(a){var c=/\S/;for(var b=0;b<a.childNodes.length;b++){if(a.childNodes[b].nodeType==3&&!c.test(a.childNodes[b].nodeValue)){a.removeChild(a.childNodes[b]);b--}else{RemoveWhitespaceNodesFromXML(a.childNodes[b])}}}XmlResource.Positions={Before:0,After:1,FirstChild:2,LastChild:3,Undefined:4};(function(){var b={storage:{},destroy:function(c,d){this.storage[c]=null},store:function(c,d){this.storage[c]=d},retrieve:function(c){return this.storage[c]||null}};Class.Singleton=function(){this.$className=String.uniqueID()};Class.Singleton.prototype.check=function(d){if(!d){d=b}var c=d.retrieve("single:"+this.$className);if(!c){d.store("single:"+this.$className,this)}return c};Class.Singleton.prototype.destroyInstance=function(d){if(!d){d=b}var c=d.retrieve("single:"+this.$className);if(c){d.destroy("single:"+this.$className,this)}};var a=function(c){var d=c.prototype.$className;return d?this.retrieve("single:"+d):null};if(("Element" in this)&&Element.implement){Element.implement({getInstanceOf:a})}Class.getInstanceOf=a.bind(b)}).call(this);var WebUILogger=new Class({Implements:[Class.Singleton,Options],options:{defaultLoggerName:"WebUI"},initialize:function(b,a){return this.check()||this.setUp(b,a)},setUp:function(b,a){this.appenders=new HashMap();this.defaultLogger=null;this.layouts=new HashMap();this.loggers=new HashMap();this.loggerIsConfigured=false;if(b){this.configure(b)}else{this.configureDefaultLogger()}},configure:function(g){for(i=0;i<g.getLoggingLayoutElements().length;i++){var e=g.getLoggingLayoutName(i);var f=this.configureLayout(e,g);this.layouts.put(e,f)}for(i=0;i<g.getLoggingAppenderElements().length;i++){var d=g.getLoggingAppenderName(i);var a=this.configureAppender(d,g);this.appenders.put(d,a)}for(i=0;i<g.getLoggerElements().length;i++){var c=g.getLoggerName(i);var b=this.configureLogger(c,g);this.loggers.put(c,b)}this.determineDefaultLogger();this.loggerIsConfigured=true},configureDefaultLogger:function(){this.defaultLogger=log4javascript.getDefaultLogger()},debug:function(a){this.log(WebUILogger.DEBUG,a)},error:function(a){this.log(WebUILogger.ERROR,a)},fatal:function(a){this.log(WebUILogger.FATAL,a)},group:function(b,a){this.defaultLogger.group(b,a)},groupEnd:function(){this.defaultLogger.groupEnd()},info:function(a){this.log(WebUILogger.INFO,a)},log:function(a,b){if(!this.logLevelIsValid(a)){throw new IllegalArgumentException("logLevel",a)}this.defaultLogger.log(a,b)},tearDown:function(){var b=this.loggers.iterator();while(b.hasNext()){var a=b.next().getValue();a.removeAllAppenders()}this.layouts.clear();this.appenders.clear();this.loggers.clear();this.loggerIsConfigured=false},trace:function(a){this.log(WebUILogger.TRACE,a)},warn:function(a){this.log(WebUILogger.WARN,a)},getAppender:function(a){return this.appenders.get(a)},getAppenders:function(){return this.appenders},getDefaultLogger:function(){return this.defaultLogger},getLayout:function(a){return this.layouts.get(a)},getLayouts:function(){return this.layouts},getLevel:function(){return this.defaultLogger.getLevel()},getLogger:function(a){return this.loggers.get(a)},getLoggers:function(){return this.loggers},getName:function(){return this.options.defaultLoggerName},isConfigured:function(){return this.loggerIsConfigured},configureAppender:function(d,a){var k=null;var f=a.getLoggingAppenderLazyInit(d);var l=a.getLoggingAppenderHeight(d);var j=a.getLoggingAppenderInitiallyMinimized(d);var h=a.getLoggingAppenderUseDocumentWrite(d);var c=a.getLoggingAppenderWidth(d);switch(a.getLoggingAppenderType(d).toUpperCase()){case"WUI:ALERTAPPENDER":k=new log4javascript.AlertAppender();break;case"WUI:AJAXAPPENDER":var b=a.getLoggingAppenderURL(d);k=new log4javascript.AjaxAppender(b);break;case"WUI:BROWSERCONSOLEAPPENDER":k=new log4javascript.BrowserConsoleAppender();break;case"WUI:INPAGEAPPENDER":var e=a.getLoggingAppenderContainerElementId(d);k=new log4javascript.InPageAppender(e,f,j,h,c,l);break;case"WUI:POPUPAPPENDER":var f=a.getLoggingAppenderLazyInit(d);var j=a.getLoggingAppenderInitiallyMinimized(d);var h=a.getLoggingAppenderUseDocumentWrite(d);var c=a.getLoggingAppenderWidth(d);var l=a.getLoggingAppenderHeight(d);k=new log4javascript.PopUpAppender(f,j,h,c,l);break;default:k=new log4javascript.PopUpAppender()}if(this.logLevelValueIsValid(a.getLoggingAppenderThreshold(d))){k.setThreshold(this.parseLevel(a.getLoggingAppenderThreshold(d)))}var g=this.layouts.get(a.getLoggingAppenderLayoutReference(d));k.setLayout(g);return k}.protect(),configureLayout:function(a,d){var b=d.getLoggingLayoutPattern(a);var c=new log4javascript.PatternLayout(b);return c}.protect(),configureLogger:function(b,d){var a=log4javascript.getLogger(b);a.setLevel(this.parseLevel(d.getLoggerLevel(b)));var c=this.appenders.get(d.getLoggingLoggerAppenderReference(b));a.addAppender(c);if(d.getLoggingLoggerIsDefault(b)){this.options.defaultLoggerName=b}return a}.protect(),determineDefaultLogger:function(){if(this.defaultLogger==null){this.defaultLogger=this.getLogger(this.options.defaultLoggerName)}}.protect(),logLevelIsValid:function(a){switch(a){case log4javascript.Level.ALL:return true;case log4javascript.Level.TRACE:return true;case log4javascript.Level.DEBUG:return true;case log4javascript.Level.INFO:return true;case log4javascript.Level.WARN:return true;case log4javascript.Level.ERROR:return true;case log4javascript.Level.FATAL:return true;case log4javascript.Level.NONE:return true;default:return false}}.protect(),logLevelValueIsValid:function(a){if(this.parseLevel(a)!=null){return true}else{return false}}.protect(),parseLevel:function(a){if(typeOf(a)!="string"){return null}switch(a.toUpperCase()){case"ALL":return log4javascript.Level.ALL;case"TRACE":return log4javascript.Level.TRACE;case"DEBUG":return log4javascript.Level.DEBUG;case"INFO":return log4javascript.Level.INFO;case"WARN":return log4javascript.Level.WARN;case"ERROR":return log4javascript.Level.ERROR;case"FATAL":return log4javascript.Level.FATAL;case"NONE":return log4javascript.Level.NONE;default:return null}}.protect()});WebUILogger.ALL=log4javascript.Level.ALL;WebUILogger.TRACE=log4javascript.Level.TRACE;WebUILogger.DEBUG=log4javascript.Level.DEBUG;WebUILogger.INFO=log4javascript.Level.INFO;WebUILogger.WARN=log4javascript.Level.WARN;WebUILogger.ERROR=log4javascript.Level.ERROR;WebUILogger.FATAL=log4javascript.Level.FATAL;WebUILogger.NONE=log4javascript.Level.NONE;var WebUIMessageBus=new Class({Implements:[Class.Singleton,Options],options:{message:"hello"},initialize:function(a){return this.check()||this.setUp(a)},setUp:function(a){this.setOptions(a);this.lastMessage=null;this.subscribersToMessages=new HashMap()}.protect(),notifySubscribers:function(c){this.lastMessage=c;var a=c.getClass();var d=this.getSubscribersToMessage(a);if(d&&d.size()>0){var b;d.each(function(f,e){f(c);b=e},this);return b}else{return null}},subscribeToMessage:function(a,b){var c=this.getSubscribersToMessage(a);if(c==null){c=new ArrayList()}c.add(b);this.subscribersToMessages.put(a.prototype.options.name,c)},writeOffFromMessage:function(a,b){var c=this.getSubscribersToMessage(a);if(c==null){return}c.remove(c.indexOf(b))},tearDown:function(){this.subscribersToMessages.clear()},getLastMessage:function(){return this.lastMessage},getMessageListSize:function(){return this.subscribersToMessages.size()},getSubscribersToMessage:function(a){return this.subscribersToMessages.get(a.prototype.options.name)}});var AbstractDocument=new Class({Implements:[Events,Options],Binds:["attachEditor","detachEditor","determineContainerElement","finalizeConstruction","finalizeDestruction","instantiateEditor","loadResources","onConstructionError","onContainerResize","onDocumentError","onDocumentReady","onEditorAttached","onResourceError","onResourcesLoaded","releaseResources","resetProperties","subscribeToWebUIMessages","webUIMessageHandler"],options:{componentName:"AbstractDocument",contentUriSelector:"contentUri",descriptionSelector:"description",documentContainerId:"DocumentContainer",documentContentExtension:".xml",documentContentUri:null,documentContentNameSpace:"xmlns:pp='http://www.processpuzzle.com'",documentDefinitionNameSpace:"xmlns:sd='http://www.processpuzzle.com/SmartDocument'",documentDefinitionUri:null,documentDefinitionUriSelector:"@documentDefinition",documentEditorClass:"DocumentEditor",handleMenuSelectedEventsDefault:false,handleMenuSelectedEventsSelector:"handleMenuSelectedEvents",nameSelector:"name",resourcesSelector:"resources",rootElementName:"/smartDocumentDefinition",versionSelector:"version"},initialize:function(b,a){this.setOptions(a);this.constructionChain=new Chain();this.containerElement;this.contentUri;this.description;this.destructionChain=new Chain();this.documentContent;this.documentDefinition;this.documentDefinitionUri;this.editor;this.error;this.handleMenuSelectedEvents;this.htmlElementFactory;this.i18Resource=b;this.logger=Class.getInstanceOf(WebUILogger);this.messageBus=Class.getInstanceOf(WebUIMessageBus);this.name;this.resources;this.state=AbstractDocument.States.UNINITIALIZED;this.version;this.loadDocumentDefinition();this.loadDocumentContent();this.state=AbstractDocument.States.INITIALIZED},construct:function(){this.compileConstructionChain();this.constructionChain.callChain()},destroy:function(){this.compileDestructionChain();this.destructionChain.callChain()},onConstructionError:function(a){if(a){this.error=a}this.revertConstruction();this.fireEvent("documentError",this.error)},onContainerResize:function(a){},onDocumentError:function(a){this.error=a;this.revertConstruction();this.fireEvent("documentError",a)},onDocumentReady:function(){this.constructionChain.callChain()},onEditorAttached:function(){this.constructionChain.callChain()},onResourceError:function(a){this.error=a},onResourcesLoaded:function(){if(this.resources.isSuccess()){this.constructionChain.callChain()}else{this.onConstructionError()}},showNotification:function(a){if(this.state==AbstractDocument.States.CONSTRUCTED){var b=new MenuSelectedMessage({originator:this.name,activityType:DesktopWindow.Activity.SHOW_NOTIFICATION,notification:a});this.messageBus.notifySubscribers(b)}},showWindow:function(a){if(this.state==AbstractDocument.States.CONSTRUCTED){var b=new MenuSelectedMessage({originator:this.name,activityType:DesktopWindow.Activity.SHOW_WINDOW,windowName:a});this.messageBus.notifySubscribers(b)}},unmarshall:function(){this.unmarshallProperties();this.unmarshallResources();this.state=AbstractDocument.States.UNMARSHALLED},webUIMessageHandler:function(a){if(this.state!=AbstractDocument.States.CONSTRUCTED){return}if(instanceOf(a,MenuSelectedMessage)&&a.getActivityType()==AbstractDocument.Activity.MODIFY_DOCUMENT){switch(a.getActionType()){case AbstractDocument.Action.ADD_IMAGE:this.editor.textAddImage();break;case AbstractDocument.Action.ADD_LINK:this.editor.textAddLink();break;case AbstractDocument.Action.ALIGN_CENTER:this.editor.textAlignCenter();break;case AbstractDocument.Action.ALIGN_LEFT:this.editor.textAlignLeft();break;case AbstractDocument.Action.ALIGN_JUSTIFY:this.editor.textAlignJustify();break;case AbstractDocument.Action.ALIGN_RIGHT:this.editor.textAlignRight();break;case AbstractDocument.Action.BOLD:this.editor.textBold();break;case AbstractDocument.Action.INDENT:this.editor.textIndent();break;case AbstractDocument.Action.ITALIC:this.editor.textItalic();break;case AbstractDocument.Action.ORDERED_LIST:this.editor.textOrderedList();break;case AbstractDocument.Action.OUTDENT:this.editor.textOutdent();break;case AbstractDocument.Action.REDO:this.editor.textRedo();break;case AbstractDocument.Action.REMOVE_LINK:this.editor.textRemoveLink();break;case AbstractDocument.Action.STRIKETHROUGH:this.editor.textStrikethrough();break;case AbstractDocument.Action.TOGGLE_VIEW:this.editor.textToggleView();break;case AbstractDocument.Action.UNDERLINE:this.editor.textUnderline();break;case AbstractDocument.Action.UNDO:this.editor.textUndo();break;case AbstractDocument.Action.UNORDERED_LIST:this.editor.textUnorderedList();break}}this.lastHandledMessage=a},getContainerElement:function(){return this.containerElement},getDescription:function(){return this.description},getDocumentContent:function(){return this.documentContent},getDocumentContentUri:function(){return this.options.documentContentUr},getDocumentDefinition:function(){return this.documentDefinition},getDocumentDefinitionUri:function(){return this.options.documentDefinitionUri},getEditor:function(){return this.editor},getError:function(){return this.error},getHandleMenuSelectedEvents:function(){return this.handleMenuSelectedEvents},getHtmlElementFactory:function(){return this.htmlElementFactory},getLogger:function(){return this.logger},getMessageBus:function(){return this.messageBus},getName:function(){return this.name},getResources:function(){return this.resources},getState:function(){return this.state},getVersion:function(){return this.version},isSuccess:function(){return this.error==null},attachEditor:function(){this.editor.attach(this.containerElement)}.protect(),compileConstructionChain:function(){this.constructionChain.chain(this.determineContainerElement,this.instantiateEditor,this.attachEditor,this.subscribeToWebUIMessages,this.finalizeConstruction)}.protect(),compileDestructionChain:function(){this.destructionChain.chain(this.releseResource,this.detachEditor,this.resetProperties,this.finalizeDestruction)}.protect(),detachEditor:function(){if(this.editor){this.editor.detach()}this.destructionChain.callChain()}.protect(),determineContainerElement:function(){this.containerElement=$(this.options.documentContainerId);this.htmlElementFactory=new WidgetElementFactory(this.containerElement,this.i18Resource);this.constructionChain.callChain()}.protect(),finalizeConstruction:function(){this.state=AbstractDocument.States.CONSTRUCTED;this.fireEvent("documentReady",this)}.protect(),finalizeDestruction:function(){this.constructionChain.clearChain();this.destructionChain.clearChain();this.state=AbstractDocument.States.INITIALIZED;this.fireEvent("documentDestroyed",this)}.protect(),instantiateEditor:function(){var editorClass=eval(this.options.documentEditorClass);this.editor=new editorClass(this.i18Resource,{onEditorAttached:this.onEditorAttached});this.constructionChain.callChain()}.protect(),loadDocumentContent:function(){if(this.options.documentContentUri){try{this.documentContent=new XmlResource(this.options.documentContentUri+"_"+this.i18Resource.getLocale().getLanguage()+this.options.documentContentExtension)}catch(a){try{this.documentContent=new XmlResource(this.options.documentContentUri)}catch(a){throw new IllegalArgumentException("SmartDocument.options.documentContentUri",this.options.documentContentUri)}}}else{this.options.documentContentUri=this.options.documentDefinitionUri.substring(0,this.options.documentDefinitionUri.lastIndexOf(".xml"));try{this.documentContent=new XmlResource(this.options.documentContentUri+"_"+this.i18Resource.getLocale().getLanguage()+this.options.documentContentExtension)}catch(a){this.logger.trace("Content of "+this.name+" document couldn't be loaded.")}}}.protect(),loadDocumentDefinition:function(){if(this.options.documentDefinitionUri){this.documentDefinition=new XmlResource(this.options.documentDefinitionUri)}else{throw new IllegalArgumentException("SmartDocument.options.documentDefinitionUri",this.options.documentDefinitionUri)}}.protect(),loadResources:function(){if(this.resources){this.resources.load()}else{this.constructionChain.callChain()}}.protect(),releaseResources:function(){if(this.resources){this.resources.release()}this.destructionChain.callChain()}.protect(),resetProperties:function(){this.description=null;this.options.documentContentUri=null;this.options.documentDefinitionUri=null;this.editor=null;this.name=null;this.version=null;this.destructionChain.callChain()}.protect(),revertConstruction:function(){if(this.editor){this.editor.destroy()}this.resetProperties();this.state=AbstractDocument.States.INITIALIZED}.protect(),subscribeToWebUIMessages:function(){if(this.handleMenuSelectedEvents){this.logger.debug(this.options.componentName+".subscribeToWebUIMessages() started.");this.messageBus.subscribeToMessage(MenuSelectedMessage,this.webUIMessageHandler)}this.constructionChain.callChain()}.protect(),unmarshallProperties:function(){this.description=this.documentDefinition.selectNodeText(this.options.rootElementName+"/"+this.options.descriptionSelector);this.handleMenuSelectedEvents=parseBoolean(this.documentDefinition.selectNodeText(this.options.rootElementName+"/"+this.options.handleMenuSelectedEventsSelector,null,this.options.handleMenuSelectedEventsDefault));this.name=this.documentDefinition.selectNodeText(this.options.rootElementName+"/"+this.options.nameSelector);this.version=this.documentDefinition.selectNodeText(this.options.rootElementName+"/"+this.options.versionSelector)}.protect(),unmarshallResources:function(){var a=this.documentDefinition.selectNode(this.options.rootElementName+"/"+this.options.resourcesSelector);if(a){this.resources=new ResourceManager(a,{onResourcesLoaded:this.onResourcesLoaded,onResourceError:this.onResourceError});this.resources.unmarshall()}}.protect()});AbstractDocument.States={UNINITIALIZED:0,INITIALIZED:1,UNMARSHALLED:2,CONSTRUCTED:3};AbstractDocument.Types={HTML:"StaticHtml",SMART:"SmartDocument",REMOTE_RESOURCE:"RemoteResource"};AbstractDocument.Activity={LOAD_DOCUMENT:"loadDocument",MODIFY_DOCUMENT:"modifyDocument"};AbstractDocument.Action={BOLD:"bold",ITALIC:"italic",UNDERLINE:"underline",STRIKETHROUGH:"strikethrough",UNORDERED_LIST:"unorderedList",ORDERED_LIST:"orderedList",INDENT:"indent",OUTDENT:"outdent",ALIGN_LEFT:"alignLeft",ALIGN_CENTER:"alighCenter",ALIGN_RIGHT:"alignRight",ALIGN_JUSTIFY:"alignJustify",UNDO:"undo",REDO:"redo",ADD_LINK:"addLink",REMOVE_LINK:"removeLink",ADD_IMAGE:"addImage",TOGGLE_VIEW:"toggleView"};var WebUIMessage=new Class({Implements:Options,options:{description:"Generic Browser Interface message. Normally this message should be overwritten by subclasses.",messageClass:null,name:"WebUIMessage",originator:null},initialize:function(a){this.setOptions(a)},getClass:function(){return this.options.messageClass},getDescription:function(){return this.options.description},getName:function(){return this.options.name},getOriginator:function(){return this.options.originator}});var DocumentSelectedMessage=new Class({Extends:WebUIMessage,options:{actionType:null,activityType:null,description:"A message about the event that a SmartDocument of RemoteResource was selected.",documentContentURI:null,documentType:AbstractDocument.Types.SMART,documentURI:null,name:"DocumentSelectedMessage",notification:null,windowName:null},initialize:function(a){this.setOptions(a);this.options.messageClass=DocumentSelectedMessage},getActionType:function(){return this.options.actionType},getActivityType:function(){return this.options.activityType},getContextItemId:function(){return this.options.contextItemId},getDocumentContentURI:function(){return this.options.documentContentURI},getDocumentType:function(){return this.options.documentType},getDocumentURI:function(){return this.options.documentURI},getNotification:function(){return this.options.notification},getWindowName:function(){return this.options.windowName}});var BrowserWidget=new Class({Implements:[Events,Options],Binds:["broadcastConstructedMessage","destroyChildHtmlElements","finalizeConstruction","finalizeDestruction","webUIMessageHandler"],options:{componentName:"BrowserWidget",dataXmlNameSpace:"xmlns:pp='http://www.processpuzzle.com'",definitionXmlNameSpace:"xmlns:pp='http://www.processpuzzle.com'",descriptionSelector:"//pp:widgetDefinition/description",domDocument:this.document,eventDeliveryDelay:5,nameSelector:"//pp:widgetDefinition/name",optionsSelector:"//pp:widgetDefinition/options",subscribeToWebUIMessages:false,useLocalizedData:false,widgetContainerId:"widgetContainer",widgetDataURI:null,widgetDefinitionURI:null,widgetVersionSelector:"//pp:widgetDefinition/version"},initialize:function(a,c,b){this.setOptions(a);this.componentStateManager;this.constructionChain=new Chain();this.containerElement;this.dataXml;this.definitionXml;this.description;this.destructionChain=new Chain();this.elementFactory=null;this.givenOptions=a;this.i18Resource=null;this.lastHandledMessage=null;this.locale;this.logger;this.messageBus;this.name;this.state;this.stateSpecification;this.widgetVersion;this.webUIController=null;this.deduceInitializationArguments(a,c);this.containerElement=document.id($(this.options.widgetContainerId));this.configureComponentStateManager();this.configureLogger();this.configureMessageBus();this.loadWidgetDefinition();this.loadWidgetData();assertThat(this.i18Resource,not(nil()));if(this.containerElement==null){throw new IllegalArgumentException("Parameter 'widgetContainerId' in invalid.")}if(!this.i18Resource.isLoaded){throw new IllegalArgumentException("ResourceBundle should be already loaded.")}this.elementFactory=new WidgetElementFactory(this.containerElement,this.i18Resource,b);this.restoreComponentState();this.state=BrowserWidget.States.INITIALIZED},construct:function(){if(this.state<BrowserWidget.States.CONSTRUCTED){this.compileConstructionChain();this.constructionChain.callChain()}return this},destroy:function(){if(this.state==BrowserWidget.States.CONSTRUCTED){this.compileDestructionChain();this.destructionChain.callChain()}},getText:function(a){var c=null;try{c=this.i18Resource.getText(a)}catch(b){c=a}return c},removeChild:function(c,b){var a=b==undefined?this.containerElement:b;if(a!=null&&c!=null){a.removeChild(c)}},restoreComponentState:function(){this.stateSpecification=this.componentStateManager.retrieveComponentState(this.options.componentName);this.parseStateSpecification()},storeComponentState:function(){this.compileStateSpecification();this.componentStateManager.storeComponentState(this.options.componentName,this.stateSpecification)}.protect(),unmarshall:function(){this.unmarshallProperties();this.unmarshallOptions();this.state=BrowserWidget.States.UNMARSHALLED;return this},updateText:function(c,d,b){var a=c.findElementById(c,d);a.set("text",this.getText(b))},webUIMessageHandler:function(a){if(a.getOriginator()==this.options.componentName){return}if(this.state!=BrowserWidget.States.CONSTRUCTED){throw new UnconfiguredWidgetException({source:"BrowserWidget.webUIMessageHandler()"})}this.lastHandledMessage=a},getContainerElement:function(){return this.containerElement},getDataXml:function(){return this.dataXml},getDefinitionXml:function(){return this.definitionXml},getDescription:function(){return this.description},getElementFactory:function(){return this.elementFactory},getHtmlDOMDocument:function(){return this.options.domDocument},getLastMessage:function(){return this.lastHandledMessage},getLocale:function(){return this.locale},getLogger:function(){return this.logger},getMessageBus:function(){return this.messageBus},getName:function(){return this.name},getResourceBundle:function(){return this.i18Resource},getState:function(){return this.state},broadcastConstructedMessage:function(){var a=new WidgetConstuctedMessage({originator:this.options.componentName});this.messageBus.notifySubscribers(a)}.protect(),compileConstructionChain:function(){this.constructionChain.chain(this.finalizeConstruction)}.protect(),compileDestructionChain:function(){this.destructionChain.chain(this.destroyChildHtmlElements,this.finalizeDestruction)}.protect(),compileStateSpecification:function(){}.protect(),configureComponentStateManager:function(){if(this.webUIController==null){this.componentStateManager=Class.getInstanceOf(ComponentStateManager)}else{this.componentStateManager=this.webUIController.getStateManager()}}.protect(),configureLogger:function(){if(this.webUIController==null){this.logger=Class.getInstanceOf(WebUILogger);if(this.logger==null){this.logger=new WebUILogger()}}else{this.logger=this.webUIController.getLogger()}}.protect(),configureMessageBus:function(){if(this.webUIController==null){this.messageBus=Class.getInstanceOf(WebUIMessageBus)}else{this.messageBus=this.webUIController.getMessageBus()}this.subscribeToWebUIMessages()}.protect(),deduceInitializationArguments:function(a,b){if(b){this.i18Resource=b;this.locale=b.getLocale()}else{this.webUIController=Class.getInstanceOf(WebUIController);this.i18Resource=this.webUIController.getResourceBundle();this.locale=this.webUIController.getCurrentLocale()}}.protect(),destroyChildHtmlElements:function(){this.containerElement=document.id(this.containerElement);this.containerElement.getElements("*").each(function(b,a){if(b.removeEvents){b.removeEvents()}if(b.destroy){b.destroy()}});this.destructionChain.callChain()}.protect(),finalizeConstruction:function(){this.logger.trace(this.options.componentName+".onConstructed() of '"+this.name+"'.");this.storeComponentState();this.state=BrowserWidget.States.CONSTRUCTED;this.constructionChain.clearChain();this.broadcastConstructedMessage();this.fireEvent("constructed",this,this.options.eventDeliveryDelay)}.protect(),finalizeDestruction:function(){this.logger.trace(this.options.componentName+".onDestroyed() of '"+this.name+"'.");this.state=BrowserWidget.States.INITIALIZED;this.destructionChain.clearChain();this.fireEvent("destroyed",this,this.options.eventDeliveryDelay)}.protect(),loadWebUIConfiguration:function(){try{this.webUIConfiguration=new WebUIConfiguration(this.options.configurationUri)}catch(a){alert("Couldn't load Browser Front-End configuration: "+this.options.configurationUri)}}.protect(),loadWidgetData:function(){if(this.options.widgetDataURI){try{var a=this.options.useLocalizedData?new ResourceUri(this.options.widgetDataURI,this.locale).determineLocalizedUri():this.options.widgetDataURI;this.dataXml=new XmlResource(a,{nameSpaces:this.options.dataXmlNameSpace})}catch(b){this.logger.debug("Widget data: '"+this.options.widgetDataURI+"' not found.")}}}.protect(),loadWidgetDefinition:function(){if(this.options.widgetDefinitionURI){try{this.definitionXml=new XmlResource(this.options.widgetDefinitionURI,{nameSpaces:this.options.definitionXmlNameSpace})}catch(a){this.logger.debug("Widget definition: '"+this.options.widgetDefinitionURI+"' not found.")}}}.protect(),parseStateSpecification:function(){}.protect(),subscribeToWebUIMessages:function(){if(this.options.subscribeToWebUIMessages){this.options.subscribeToWebUIMessages.each(function(a,b){this.messageBus.subscribeToMessage(a,this.webUIMessageHandler)},this)}}.protect(),unmarshallOptions:function(){if(this.definitionXml){var a=this.definitionXml.selectNode(this.options.optionsSelector);if(a){var b=new OptionsResource(a);b.unmarshall();this.setOptions(b.getOptions())}this.setOptions(this.givenOptions)}}.protect(),unmarshallProperties:function(){if(this.definitionXml){this.description=this.definitionXml.selectNodeText(this.options.descriptionSelector);this.name=this.definitionXml.selectNodeText(this.options.nameSelector)}}.protect(),writeOffFromWebUIMessages:function(){if(this.options.subscribeToWebUIMessages){this.options.subscribeToWebUIMessages.each(function(a,b){this.messageBus.writeOffFromMessage(a,this.webUIMessageHandler)},this)}}});BrowserWidget.States={UNINITIALIZED:0,INITIALIZED:1,UNMARSHALLED:2,CONSTRUCTED:3};var UnconfiguredWidgetException=new Class({Extends:WebUIException,options:{description:"Browser Widget is unconfigured therefore the requested operation can't be carried out.",name:"UnconfiguredWidgetException"},initialize:function(a){this.setOptions(a);this.parent(a)}});var WidgetConstuctedMessage=new Class({Extends:WebUIMessage,options:{actionType:null,activityType:null,description:"New widget was constructed.",name:"WidgetConstructedMessage",notification:null,windowName:null},initialize:function(a){this.setOptions(a);this.options.messageClass=WidgetConstuctedMessage},getActionType:function(){return this.options.actionType},getActivityType:function(){return this.options.activityType},getContextItemId:function(){return this.options.contextItemId},getNotification:function(){return this.options.notification},getWindowName:function(){return this.options.windowName}});var WidgetElementFactory=new Class({Implements:Options,options:{appendByDefault:true,buttonClassName:"buttonSmall",defaultPosition:3,formFieldsContainerClassName:"editableContainer",fieldSetImageAlt:"Show/Hide",fieldSetImageSource:"Images/expver.png",fieldSetImageStyle:{cursor:"pointer"},fieldSetImageTitle:"Show/Hide",fieldSetStyle:{"border-color":"#336699",width:"100%"},labelClassName:"label",readOnlyContainerClassName:"readOnlyContainer",rowClassName:"row",valueClassName:"formw"},initialize:function(c,b,a){assertThat(c,not(nil()));assertThat(b,not(nil()));this.setOptions(a);this.containerElement=c;this.i18Resource=b},create:function(d,e,b,a,c){var f=new Element(d,c);if(e){f.appendText(this.i18Resource.getText(e))}if(b||this.options.appendByDefault){this.appendElement(f,b,a)}return f},createAnchor:function(f,a,h,k,b,c){var j;var e=a?new ResourceUri(a):null;if(h){j={href:"#",events:{click:h}}}else{if(e&&e.isLocal()){if(e.getDocumentType()==AbstractDocument.Types.SMART){j={href:"#",onclick:"top.webUIController.loadSmartDocument( '"+a+"' );"}}else{j={href:"#",onclick:"top.webUIController.loadHtmlDocument( '"+a+"' );"}}}else{j={href:a}}}var g=this.mergeProperties(j,c);var d=this.create("A",f,k,b,g);return d},createButton:function(h,e,j,b,c){var g={"class":this.BUTTON_CLASS,type:"button",value:h,events:{click:e}};var d=this.mergeProperties(g,c);var a=this.create("INPUT",null,j,b,d);if(h){var f=this.i18Resource.getText(h);a.set("value",f)}return a},createCollapsibleArea:function(b,a,c){return this.create("div",null,b,a,this.mergeProperties({"class":this.options.readOnlyContainerClassName},c))},createDivision:function(b,a,c){return this.create("div",null,b,a,this.mergeProperties({"class":this.options.readOnlyContainerClassName},c))},createFieldSet:function(b,j,c,d){var g={styles:this.options.fieldSetStyle};var e=this.mergeProperties(g,d);var h=this.create("FIELDSET",null,j,c,e);var f=this.create("LEGEND",null,h,WidgetElementFactory.Positions.LastChild);var a={id:b,src:this.options.fieldSetImageSource,alt:this.options.fieldSetImageAlt,title:this.options.fieldSetImageTitle,styles:this.options.fieldSetImageStyle};this.create("IMG",null,f,WidgetElementFactory.Positions.LastChild,a);return h},createForm:function(e,d,b,a,f){assertThat(e,not(nil()));assertThat(d.toUpperCase()=="POST"||d.toUpperCase()=="GET",is(true));var c=this.create("FORM",null,b,a,this.mergeProperties({id:e,name:"form",method:d},f));this.create("DIV",null,c,WidgetElementFactory.Positions.LastChild,{"class":this.options.formFieldsContainerClassName});this.create("DIV",null,c,WidgetElementFactory.Positions.LastChild,{"class":this.options.readOnlyContainerClassName});return c},createHiddenDivision:function(c,b,a,f){var d={id:c,styles:{display:"none"},"class":this.options.readOnlyContainerClassName};var e=this.create("DIV",null,b,a,this.mergeProperties(d,f));return e},createOption:function(d,e,b,a,f){var c={value:d};return this.create("OPTION",e,b,a,this.mergeProperties(c,f))},createRowLabel:function(c,b,a,d){return this.create("span",c,b,a,{"class":this.options.labelClassName})},createRowValue:function(c,e,b,a,d){return this.create("span",c,b,a,{id:e,"class":this.options.valueClassName})},createStaticRow:function(e,d,f,b,a){var c=this.create("div",null,b,a,{"class":this.options.rowClassName});this.create("label",e,c,WidgetElementFactory.Positions.LastChild,{"class":this.options.labelClassName});this.create("span",d,c,WidgetElementFactory.Positions.LastChild,{id:f,"class":this.options.valueClassName});return c},createTable:function(l,n,j){var b=this.create("TABLE",null,n,j);var d=this.create("THEAD",null,b,WidgetElementFactory.Positions.LastChild);var g=this.create("TBODY",null,b,WidgetElementFactory.Positions.LastChild);var m=this.create("TR",null,d,WidgetElementFactory.Positions.LastChild);for(var h=1;h<=l.getColumns().size();h++){var a=l.getColumns().getColumnByIndex(h-1);this.create("TH",a.getCaption(),m,WidgetElementFactory.Positions.LastChild)}for(var h=0;h<l.getRows().size();h++){var e=l.getRow(h);var f=this.create("TR",null,g,WidgetElementFactory.Positions.LastChild);for(var k=0;k<e.length;k++){this.create("TD",e[k],f,WidgetElementFactory.Positions.LastChild)}}return b},appendElement:function(d,b,a){b=$(b);var c=b==undefined?this.containerElement:b;switch(a){case WidgetElementFactory.Positions.Before:c.grab(d,"before");break;case WidgetElementFactory.Positions.After:c.grab(d,"after");break;case WidgetElementFactory.Positions.FirstChild:c.grab(d,"top");break;case WidgetElementFactory.Positions.LastChild:c.grab(d,"bottom");break;default:c.appendChild(d,"Last");break}}.protect(),mergeProperties:function(c,a){var b=Object.merge(c,a);return b}.protect()});var TableColumnDefinition=new Class({initialize:function(a,c){this.caption=null;this.i18Resource=c;try{this.caption=this.i18Resource.getText(a)}catch(b){this.caption=a}},getCaption:function(){return this.caption}});var TableColumnList=new Class({initialize:function(){this.tableColumns=new ArrayList()},add:function(a){this.tableColumns.add(a)},getColumnByIndex:function(b){var a=null;this.tableColumns.each(function(d,c){if(c==b){a=d}},this);return a},size:function(){return this.tableColumns.size()}});var TableHeaderDefinition=new Class({initialize:function(a){this.tableColumns=new TableColumnList();this.i18Resource=a},addColumn:function(b){var a=new TableColumnDefinition(b,this.i18Resource);this.tableColumns.add(a)},getColumns:function(){return this.tableColumns}});var TableDefinition=new Class({initialize:function(a){this.tableHeaderDefinition=new TableHeaderDefinition(a);this.tableRows=new TableRowList()},addColumn:function(a){this.tableHeaderDefinition.addColumn(a)},addRow:function(a){this.tableRows.add(a)},getColumns:function(){return this.tableHeaderDefinition.getColumns()},getRow:function(a){return this.tableRows.getRowByIndex(a)},getRows:function(){return this.tableRows}});var TableRowList=new Class({initialize:function(){this.tableRows=new ArrayList()},add:function(a){this.tableRows.add(a)},getRowByIndex:function(b){var a=null;this.tableRows.each(function(c,d){if(d==b){a=c}},this);return a},size:function(){return this.tableRows.size()}});WidgetElementFactory.Positions={Before:0,After:1,FirstChild:2,LastChild:3,Undefined:4};var StateTransformer=new Class({Implements:[Events,Options],options:{},initialize:function(a,b){assertThat(a,not(nil()));this.setOptions(b);this.stateMachine=a},parse:function(){},toString:function(){},transformComponentStateToString:function(a){var b="";var d=a.getValue();if(typeOf(d)=="string"){b="'"+d+"'"}else{if(typeOf(d)=="object"){b="{";for(var c in d){if(b!="{"){b+=","}b+=c+":'"+d[c]+"'"}b+="}"}else{b="'"+d.toString()+"'"}}return b}.protect()});var DefaultStateTransformer=new Class({Extends:StateTransformer,options:{},initialize:function(a,b){this.parent(a,b)},parse:function(stateString){var tokenizer=new StringTokenizer(stateString,{delimiters:";"});while(tokenizer.hasMoreTokens()){var token=tokenizer.nextToken();var componentName=token.substring(0,token.indexOf(":"));var componentStateString=token.substring(token.indexOf(":")+1);var componentState=eval("("+componentStateString.trim()+")");this.fireEvent("componentStateParse",[[componentName,componentState]])}},toString:function(){var a="";this.stateMachine.each(function(b,c){if(a!=""){a+=";"}a+=b.getKey()+":";a+=this.transformComponentStateToString(b)},this);return a}});var ComponentStateManager=new Class({Implements:[Events,Options,Class.Singleton],Binds:["onComponentStateParse"],options:{componentName:"ComponentStateManager",stateUriTransformer:DefaultStateTransformer},initialize:function(a){return this.check()||this.setUp(a)},setUp:function(a){this.setOptions(a);this.stateMachine=new LinkedHashMap();this.stateTransformer=new this.options.stateUriTransformer(this.stateMachine,{onComponentStateParse:this.onComponentStateParse})}.protect(),onComponentStateParse:function(a){this.storeComponentState(a[0].trim(),a[1])},parse:function(a){this.stateTransformer.parse(a)},persist:function(){$.jStorage.set(this.options.componentName,this.toString())},reset:function(){this.stateMachine.clear()},restore:function(){var a=$.jStorage.get(this.options.componentName);this.parse(a)},retrieveComponentState:function(a){return this.stateMachine.get(a)},storeComponentState:function(a,b){if(a&&b){this.stateMachine.put(a,b)}},toString:function(){return this.stateTransformer.toString()},getStateUriTransformer:function(){return this.stateTransformer},});var FixedComponentOrderedTransformer=new Class({Extends:StateTransformer,options:{},initialize:function(a,c,b){assertThat(c,not(nil()));this.parent(a,b);this.componentList=c},parse:function(stateString){var tokenizer=new StringTokenizer(stateString,{delimiters:";"});var componentIndex=0;while(tokenizer.hasMoreTokens()){var componentName=this.componentList[componentIndex++];var componentStateString=tokenizer.nextToken();var componentState=eval("("+componentStateString.trim()+")");this.fireEvent("componentStateParse",[[componentName,componentState]])}},toString:function(){var a="";this.stateMachine.each(function(b,c){if(this.componentList.contains(b.getKey())){if(a!=""){a+=";"}a+=this.transformComponentStateToString(b)}},this);return a},transformComponentStateToString:function(a){var b="";var d=a.getValue();if(typeOf(d)=="string"){b="'"+d+"'"}else{if(typeOf(d)=="object"){b="{";for(var c in d){if(b!="{"){b+=","}b+=c+":'"+d[c]+"'"}b+="}"}else{b="'"+d.toString()+"'"}}return b}.protect()});var ComplexContentBehaviour=new Class({Implements:[Events,Options],options:{contentUrlSelector:"contentURL",disableScrollBars:true,documentContentUriSelector:"document/documentContentUri",documentDefinitionUriSelector:"document/documentDefinitionUri",documentNameSeparator:"_",documentTypeDefault:AbstractDocument.Types.SMART,documentTypeSelector:"document/@type",documentWrapperId:"_documentWrapper_"+(new Date().getTime()),documentWrapperIdSelector:"document/@id",documentWrapperStyle:"documentWrapper",documentWrapperStyleSelector:"document/@elementStyle",documentWrapperTag:"div",documentWrapperTagSelector:"document/@tag",eventSourcesSelector:"eventOriginators",handleMenuSelectedEvents:false,handleMenuSelectedEventsSelector:"handleMenuSelectedEvents",handleTabSelectedEvents:false,handleTabSelectedEventsSelector:"handleTabSelectedEvents",headerSelector:"panelHeader",heightDefault:125,heightSelector:"height",nameSelector:"name",nameSpaces:"xmlns:pp='http://www.processpuzzle.com'",pluginSelector:"plugin",scrollBarStyle:"scroll",showHeaderSelector:"showHeader",storeStateSelector:"storeState",titleSelector:"title",widthDefault:300,widthSelector:"width"},initialize:function(c,a,b){this.setOptions(b);this.componentRootElement;this.contentContainerElement;this.contentUrl;this.document;this.documentContentUri;this.documentContentType=AbstractDocument.Types.HTML;this.documentDefinitionUri;this.documentWrapper;this.documentWrapperId;this.documentWrapperStyle;this.documentWrapperTag;this.error;this.eventSources=null;this.handleMenuSelectedEvents;this.handleTabSelectedEvents;this.header;this.height;this.lastHandledMessage;this.name;this.plugin;this.showHeader;this.stateSpecification;this.storeState=false;this.title;this.verticalScrollBar;this.width},onContainerResize:function(){if(this.document&&this.document.getState()==AbstractDocument.States.CONSTRUCTED){this.document.onContainerResize(this.contentContainerElement.getSize());if(this.verticalScrollBar){this.verticalScrollBar.refresh()}}},onDocumentError:function(a){this.error=a;this.revertConstruction();this.fireEvent("panelError",a);this.fireEvent("panelConstructed",this)},onDocumentReady:function(){this.logger.trace(this.options.componentName+".construct() of '"+this.name+"' finished.");this.storeComponentState();if(!this.options.disableScrollBars){this.verticalScrollBar=new ScrollBar(this.getContentContainerId(),{})}this.fireEvent("documentLoaded",this.documentDefinitionUri);this.constructionChain.callChain()},onHeaderConstructed:function(){this.logger.trace(this.options.componentName+".construct() of '"+this.name+"'s header finished.");this.constructionChain.callChain()},onHeaderConstructionError:function(a){this.error=a;this.revertConstruction();this.fireEvent("panelError",this.error);this.fireEvent("panelConstructed",this)},onPluginConstructed:function(){this.logger.trace(this.options.componentName+".construct() of '"+this.name+"'s plugin finished.");if(this.verticalScrollBar){this.verticalScrollBar.refresh()}this.constructionChain.callChain()},onPluginError:function(a){this.error=a;this.revertConstruction();this.fireEvent("panelError",this.error);this.fireEvent("panelConstructed",this)},webUIMessageHandler:function(a){if(this.state!=DesktopElement.States.CONSTRUCTED){return}if((instanceOf(a,MenuSelectedMessage)||instanceOf(a,TabSelectedMessage))&&(a.getActivityType()==AbstractDocument.Activity.LOAD_DOCUMENT)&&(this.eventSources==null||this.eventSources.contains(a.getOriginator()))){this.destroyDocument();this.destroyDocumentWrapper();this.cleanUpContentElement();this.processMessageProperties(a);this.loadDocument(a.getDocumentType())}this.lastHandledMessage=a},getColumnReference:function(){return this.columnReference},getComponentStateManager:function(){return this.componentStateManager},getContentContainerId:function(){return this.name+this.options.componentContentIdPostfix},getContentUrl:function(){return this.contentUrl},getDocument:function(){return this.document},getDocumentContentUri:function(){return this.documentContentUri},getDocumentDefinitionUri:function(){return this.documentDefinitionUri},getDocumentWrapperId:function(){return this.documentWrapperId},getDocumentWrapperStyle:function(){return this.documentWrapperStyle},getDocumentWrapperTag:function(){return this.documentWrapperTag},getEventSources:function(){return this.eventSources},getHeader:function(){return this.header},getHeight:function(){return this.height},getLogger:function(){return this.logger},getMessageBus:function(){return this.messageBus},getName:function(){return this.name},getPlugin:function(){return this.plugin},getShowHeader:function(){return this.showHeader},getState:function(){return this.state},getStoreState:function(){return this.storeState},getTitle:function(){return this.title},getToolBox:function(){return this.header},getVerticalScrollBar:function(){return this.verticalScrollBar},getWidth:function(){return this.width},isSuccess:function(){return this.error==null},addScrollBars:function(){if(!this.options.disableScrollBars){this.verticalScrollBar=new ScrollBar(this.getContentContainerId(),{})}this.constructionChain.callChain()}.protect(),cleanUpContentElement:function(){if(this.verticalScrollBar){this.verticalScrollBar.destroy()}this.verticalScrollBar=null;if(this.contentContainerElement){var a=this.contentContainerElement.getElements?this.contentContainerElement.getElements("*"):Array.from(this.contentContainerElement.getElementsByTagName("*"));a.each(function(c,b){if(c.destroy){c.destroy()}},this)}}.protect(),constructDocument:function(){if(this.document){this.createDocumentWrapper();this.document.construct()}else{this.constructionChain.callChain()}}.protect(),constructPlugin:function(){if(this.plugin){this.plugin.construct()}else{this.constructionChain.callChain()}}.protect(),constructHeader:function(){if(this.header){this.header.construct($(this.name+"_header"))}else{this.constructionChain.callChain()}}.protect(),createDocumentWrapper:function(){this.documentWrapper=new Element(this.documentWrapperTag,{id:this.documentWrapperId,"class":this.documentWrapperStyle});this.contentContainerElement.grab(this.documentWrapper)}.protect(),destroyComponents:function(){this.destroyDocument();this.destroyDocumentWrapper();this.cleanUpContentElement();if(this.header){this.header.destroy()}if(this.plugin){this.plugin.destroy()}if(this.componentRootElement){if(this.componentRootElement.destroy){this.componentRootElement.destroy()}else{this.componentRootElement.removeNode()}}}.protect(),destroyDocument:function(){if(this.document){this.document.destroy()}this.document=null}.protect(),destroyDocumentWrapper:function(){if(this.documentWrapper&&this.documentWrapper.destroy){this.documentWrapper.destroy()}this.documentWrapper=null}.protect(),determineComponentElements:function(){this.componentRootElement=$(this.name+this.options.componentRootElementIdPostfix);this.componentRootElement=$(this.componentRootElement);this.contentContainerElement=$(this.getContentContainerId());this.contentContainerElement=document.id(this.contentContainerElement);this.constructionChain.callChain()}.protect(),instantiateDocument:function(a,c){var b=null;switch(a){case AbstractDocument.Types.HTML:b=new HtmlDocument(this.internationalization,c);break;case AbstractDocument.Types.SMART:b=new SmartDocument(this.internationalization,c);break}return b}.protect(),internationalizeContentUri:function(){this.contentUrl=this.contentUrl.substring(0,this.contentUrl.lastIndexOf(".html"))+"_"+this.internationalization.getLocale().getLanguage()+".html"}.protect(),loadDocument:function(a){this.document=this.instantiateDocument(a,{documentContainerId:this.documentWrapperId,documentDefinitionUri:this.documentDefinitionUri,documentContentUri:this.documentContentUri,onDocumentReady:this.onDocumentReady,onDocumentError:this.onDocumentError});this.document.unmarshall();this.constructDocument()}.protect(),parseStateSpecification:function(){this.documentDefinitionUri=this.stateSpecification.documentDefinitionURI!="null"?this.stateSpecification.documentDefinitionURI:null;this.documentContentUri=this.stateSpecification.documentContentURI!="null"?this.stateSpecification.documentContentURI:null;this.documentContentType=this.stateSpecification.documentType!="null"?this.stateSpecification.documentType:this.options.documentTypeDefault}.protect(),processMessageProperties:function(a){this.documentDefinitionUri=a.getDocumentURI();this.documentContentUri=a.getDocumentContentURI();this.documentContentType=a.getDocumentType()}.protect(),resetProperties:function(){this.contentUrl=null;this.documentContentUri=null;this.documentDefinitionUri=null;this.documentWrapperId=null;this.documentWrapperStyle=null;this.documentWrapperTag=null;this.height=null;this.name=null;this.showHeader=null;this.title=null}.protect(),restoreComponentState:function(){if(this.storeState){this.stateSpecification=this.componentStateManager.retrieveComponentState(this.options.componentName);if(this.stateSpecification){this.parseStateSpecification();if(this.documentDefinitionUri){this.document=this.instantiateDocument(this.documentContentType,{documentContainerId:this.documentWrapperId,documentDefinitionUri:this.documentDefinitionUri,documentContentUri:this.documentContentUri,onDocumentReady:this.onDocumentReady,onDocumentError:this.onDocumentError});this.document.unmarshall()}}}this.constructionChain.callChain()}.protect(),revertConstruction:function(){this.destroyComponents();this.resetProperties()}.protect(),storeComponentState:function(){if(this.storeState){this.stateSpecification={documentDefinitionURI:this.documentDefinitionUri,documentContentURI:this.documentContentUri,documentType:this.documentContentType};this.componentStateManager.storeComponentState(this.options.componentName,this.stateSpecification)}}.protect(),subscribeToWebUIMessages:function(){if(this.handleMenuSelectedEvents){this.logger.debug(this.options.componentName+".subscribeToWebUIMessages() started.");this.messageBus.subscribeToMessage(MenuSelectedMessage,this.webUIMessageHandler)}if(this.handleTabSelectedEvents){this.logger.debug(this.options.componentName+".subscribedToWebUIMessages() started.");this.messageBus.subscribeToMessage(TabSelectedMessage,this.webUIMessageHandler)}this.constructionChain.callChain()}.protect(),unmarshallDocument:function(){this.documentContentUri=XmlResource.selectNodeText(this.options.documentContentUriSelector,this.definitionElement);this.documentDefinitionUri=XmlResource.selectNodeText(this.options.documentDefinitionUriSelector,this.definitionElement);this.documentContentType=XmlResource.selectNodeText(this.options.documentTypeSelector,this.definitionElement,this.options.nameSpaces,this.options.documentTypeDefault);this.documentWrapperId=XmlResource.selectNodeText(this.options.documentWrapperIdSelector,this.definitionElement,this.options.nameSpaces,this.name+this.options.documentWrapperId);this.documentWrapperStyle=XmlResource.selectNodeText(this.options.documentWrapperStyleSelector,this.definitionElement,this.options.nameSpaces,this.options.documentWrapperStyle);this.documentWrapperTag=XmlResource.selectNodeText(this.options.documentWrapperTagSelector,this.definitionElement,this.options.nameSpaces,this.options.documentWrapperTag);if(this.documentDefinitionUri){this.document=this.instantiateDocument(this.documentContentType,{documentContainerId:this.documentWrapperId,documentDefinitionUri:this.documentDefinitionUri,documentContentUri:this.documentContentUri,onDocumentReady:this.onDocumentReady,onDocumentError:this.onDocumentError});this.document.unmarshall()}}.protect(),unmarshallHeader:function(){var a=XmlResource.selectNode(this.options.headerSelector,this.definitionElement);if(a){this.header=new DesktopPanelHeader(a,this.internationalization,{onHeaderConstructed:this.onHeaderConstructed,onHeaderConstructionError:this.onHeaderConstructionError});this.header.unmarshall()}}.protect(),unmarshallPlugin:function(){var a=XmlResource.selectNode(this.options.pluginSelector,this.definitionElement);if(a){this.plugin=new DocumentPlugin(a,this.internationalization,{onConstructed:this.onPluginConstructed,onConstructionError:this.onPluginError});this.plugin.unmarshall()}}.protect(),unmarshallProperties:function(){this.contentUrl=XmlResource.selectNodeText(this.options.contentUrlSelector,this.definitionElement);this.height=parseInt(XmlResource.determineAttributeValue(this.definitionElement,this.options.heightSelector,this.options.heightDefault));this.eventSources=eval(XmlResource.determineAttributeValue(this.definitionElement,this.options.eventSourcesSelector,null,this.eventSources));this.name=XmlResource.determineAttributeValue(this.definitionElement,this.options.nameSelector);this.showHeader=parseBoolean(XmlResource.determineAttributeValue(this.definitionElement,this.options.showHeaderSelector));this.handleMenuSelectedEvents=parseBoolean(XmlResource.determineAttributeValue(this.definitionElement,this.options.handleMenuSelectedEventsSelector,this.options.handleMenuSelectedEvents));this.handleTabSelectedEvents=parseBoolean(XmlResource.determineAttributeValue(this.definitionElement,this.options.handleTabSelectedEventsSelector,this.options.handleTabSelectedEvents));this.storeState=parseBoolean(XmlResource.determineAttributeValue(this.definitionElement,this.options.storeStateSelector,false));this.title=XmlResource.selectNodeText(this.options.titleSelector,this.definitionElement);if(this.internationalization){this.title=this.internationalization.getText(this.title)}this.width=parseInt(XmlResource.determineAttributeValue(this.definitionElement,this.options.widthSelector,this.options.widthDefault));this.options.componentName=this.name}.protect()});var ConfigurationTimeoutException=new Class({Extends:WebUIException,options:{description:"Configuring '{configurationPath}' exceeded the '{resourceLoadTimeout}'ms timeout period.",name:"ConfigurationTimeoutException"},initialize:function(b,c,a){this.setOptions(a);this.parent(a);this.parameters={configurationPath:b,resourceLoadTimeout:c}}});var Desktop=new Class({Implements:[Events,Options],Binds:["constructColumns","constructContentArea","constructFooter","constructHeader","constructPanels","constructWindowDocker","constructWindows","finalizeConstruction","hideDesktop","initializeMUI","loadResources","onError","onContentAreaConstructed","onFooterConstructed","onHeaderConstructed","onPanelConstructed","onResourceError","onResourcesLoaded","onWindowDockerConstructed","showDesktop","showNotification","subscribeToWebUIMessages","webUIMessageHandler"],options:{callChainDelay:2000,componentName:"Desktop",columnSelector:"/desktopConfiguration/columns/column",configurationXmlNameSpace:"xmlns:dc='http://www.processpuzzle.com/DesktopConfiguration'",configurationURI:"DesktopConfiguration.xml",containerIdSelector:"/desktopConfiguration/containerId",contentAreaSelector:"/desktopConfiguration/contentArea",defaultContainerId:"desktop",descriptionSelector:"/desktopConfiguration/description",footerSelector:"/desktopConfiguration/footer",headerSelector:"/desktopConfiguration/header",nameSelector:"/desktopConfiguration/name",panelSelector:"/desktopConfiguration/panels/panel",pluginOnloadDelay:1000,resourceLoadTimeout:5000,resourcesSelector:"/desktopConfiguration/resources",skin:"ProcessPuzzle",versionSelector:"/desktopConfiguration/version",windowDockerSelector:"/desktopConfiguration/windowDocker",windowSelector:"/desktopConfiguration/windows/window",},initialize:function(c,b,a){this.presetOptionsBasedOnWebUIConfiguration(c);this.setOptions(a);this.columns=new LinkedHashMap();this.configurationXml=new XmlResource(this.options.configurationURI,{nameSpaces:this.options.configurationXmlNameSpace});this.configurationChain=new Chain();this.containerElement;this.containerId;this.contentArea;this.currentLocale=null;this.description;this.dock=null;this.error;this.footer;this.header;this.lastHandledMessage;this.logger=Class.getInstanceOf(WebUILogger);this.messageBus=Class.getInstanceOf(WebUIMessageBus);this.MUIDesktop=null;this.name;this.numberOfConstructedPanels=0;this.panels=new LinkedHashMap();this.resourceBundle=b;this.resources=null;this.state=DesktopElement.States.UNINITIALIZED;this.version;this.webUIConfiguration=c;this.windowDocker;this.windows=new HashMap();this.determineCurrentLocale();this.loadI18Resources();this.configureLogger();this.state=DesktopElement.States.UNINITIALIZED},construct:function(){this.configurationChain.chain(this.hideDesktop,this.loadResources,this.constructHeader,this.constructWindowDocker,this.constructContentArea,this.constructFooter,this.initializeMUI,this.constructColumns,this.constructPanels,this.constructWindows,this.subscribeToWebUIMessages,this.showDesktop,this.finalizeConstruction).callChain()},destroy:function(){if(this.state>DesktopElement.States.UNMARSHALLED){if(this.resources){this.resources.release()}if(this.header){this.header.destroy()}if(this.contentArea){this.contentArea.destroy()}if(this.footer){this.footer.destroy()}if(this.windowDocker){this.windowDocker.destroy()}this.destroyWindows();this.destroyPanels();this.destroyColumns();this.removeDesktopEvents();this.state=DesktopElement.States.INITIALIZED}},onContentAreaConstructed:function(){this.logger.debug(this.options.componentName+", constructing desktop content area is finished.");this.callNextConfigurationStep()},onError:function(a){this.error=a},onFooterConstructed:function(){this.logger.debug(this.options.componentName+", loading desktop footer is finished.");this.callNextConfigurationStep()},onHeaderConstructed:function(){this.logger.debug(this.options.componentName+", loading desktop header is finished.");this.callNextConfigurationStep()},onPanelConstructed:function(a){this.numberOfConstructedPanels++;if(this.numberOfConstructedPanels==this.panels.size()){this.logger.debug(this.options.componentName+", loading desktop panels is finished.");this.callNextConfigurationStep()}},onResourceError:function(a){this.error=a},onResourcesLoaded:function(){this.logger.debug(this.options.componentName+", loading desktop resources is finished.");this.callNextConfigurationStep()},onWindowDockerConstructed:function(){this.logger.debug(this.options.componentName+", constructing desktop window docker is finished.");this.callNextConfigurationStep()},onWindowConstructed:function(a){this.logger.debug(this.options.componentName+", constructing desktop window "+a.getName()+" is finished.");if(a.getOnReadyCallback()&&typeOf(a.getOnReadyCallback())=="function"){a.getOnReadyCallback()()}},showNotification:function(a){if(this.state==DesktopElement.States.CONSTRUCTED){MUI.notification(this.resourceBundle.getText("DesktopNotification."+a))}},showWindow:function(b,a){var c=this.windows.get(b);if(c){if(c.getState()==DesktopElement.States.INITIALIZED){c.unmarshall()}c.construct(a)}return c},unmarshall:function(){this.unmarshallDesktopProperties();this.unmarshallResources();this.unmarshallHeader();this.unmarshallDesktopContentArea();this.unmarshallFooter();this.unmarshallWindowDocker();this.unmarshallColumns();this.unmarshallPanels();this.unmarshallWindows();this.state=DesktopElement.States.UNMARSHALLED},webUIMessageHandler:function(a){if(this.state!=DesktopElement.States.CONSTRUCTED){return}if(instanceOf(a,MenuSelectedMessage)){switch(a.getActivityType()){case DesktopWindow.Activity.SHOW_NOTIFICATION:this.showNotification(a.getNotification());break;case DesktopWindow.Activity.SHOW_WINDOW:this.showWindow(a.getWindowName());break}}this.lastHandledMessage=a},getColumns:function(){return this.columns},getConfigurationXml:function(){return this.configurationXml},getContainerId:function(){return this.containerId},getCurrentLocale:function(){return this.currentLocale},getDescription:function(){return this.description},getMUIDesktop:function(){return this.MUIDesktop},getFooter:function(){return this.footer},getHeader:function(){return this.header},getName:function(){return this.name},getPanels:function(){return this.panels},getResources:function(){return this.resources},getState:function(){return this.state},getVersion:function(){return this.version},getWindowDocker:function(){return this.windowDocker},getWindows:function(){return this.windows},isSuccess:function(){return this.error==null},callNextConfigurationStep:function(){if(this.isSuccess()){this.configurationChain.callChain()}else{this.revertConstruction();this.fireEvent("error",this.error)}}.protect(),configureLogger:function(){if(!this.logger.isConfigured()){this.logger.configure(this.webUIConfiguration)}}.protect(),constructColumns:function(){this.logger.debug(this.options.componentName+".constructColumns() started.");this.columns.each(function(d,a){var b=d.getValue();try{b.construct()}catch(c){this.onError(c)}},this);this.callNextConfigurationStep()}.protect(),constructContentArea:function(){this.logger.debug(this.options.componentName+".constructContentArea() started.");if(this.contentArea){this.contentArea.construct()}else{this.callNextConfigurationStep()}}.protect(),constructHeader:function(){this.logger.debug(this.options.componentName+".constructHeader() started.");if(this.header){this.header.construct()}else{this.callNextConfigurationStep()}}.protect(),constructFooter:function(){this.logger.debug(this.options.componentName+".constructFooter() started.");if(this.footer){this.footer.construct()}else{this.callNextConfigurationStep()}}.protect(),constructPanels:function(){this.logger.debug(this.options.componentName+".constructPanels() started.");if(this.panels.size()>0){this.panels.each(function(d,b){var a=d.getValue();try{a.construct()}catch(c){this.onError(c)}},this)}else{this.callNextConfigurationStep()}}.protect(),constructWindowDocker:function(){this.logger.debug(this.options.componentName+".constructWindowDocker() started.");if(this.windowDocker){this.windowDocker.construct()}else{this.callNextConfigurationStep()}}.protect(),constructWindows:function(){this.logger.debug(this.options.componentName+".constructWindows() started.");this.callNextConfigurationStep()}.protect(),destroyColumns:function(){this.logger.debug(this.options.componentName+".destroyColumns() started.");this.columns.each(function(c,a){var b=c.getValue();b.destroy()},this);this.columns.clear()}.protect(),destroyPanels:function(){this.logger.debug(this.options.componentName+".destroyPanels() started.");this.panels.each(function(c,b){var a=c.getValue();a.destroy()},this);this.panels.clear();this.numberOfConstructedPanels=0}.protect(),destroyWindows:function(){this.logger.debug(this.options.componentName+".destroyWindows() started.");this.windows.clear()}.protect(),determineCurrentLocale:function(){if(this.resourceBundle.isLoaded){this.currentLocale=this.resourceBundle.getLocale()}else{this.currentLocale=new Locale();this.currentLocale.parse(this.webUIConfiguration.getI18DefaultLocale())}}.protect(),finalizeConstruction:function(){this.state=DesktopElement.States.CONSTRUCTED;this.fireEvent("constructed",this)}.protect(),hideDesktop:function(){this.containerElement.setStyle("visibility","hidden");this.callNextConfigurationStep()}.protect(),initializeMUI:function(){this.logger.debug(this.options.componentName+".initializeMUI() started.");MUI.myChain=new Chain();MUI.myChain.chain(function(){MUI.Desktop.initialize({desktop:this.containerId,desktopHeader:this.header.getId(),desktopFooter:this.footer.getFooterId(),desktopFooterWrapper:this.footer.getId(),desktopNavBar:this.header.getNavigationBarId(),pageWrapper:this.contentArea.getId()})}.bind(this),function(){MUI.Dock.initialize()});MUI.myChain.callChain();this.MUIDesktop=MUI.Desktop;this.dock=MUI.Dock;this.callNextConfigurationStep()}.protect(),loadResources:function(){this.logger.debug(this.options.componentName+".loadResources() started.");if(this.resources){this.resources.load()}else{this.onResourcesLoaded()}}.protect(),loadI18Resources:function(){if(!this.resourceBundle.isLoaded){this.resourceBundle.load(this.currentLocale)}}.protect(),presetOptionsBasedOnWebUIConfiguration:function(a){if(a!="undefined"&&a!=null){this.options.skin=a.getDefaultSkin();this.options.configurationURI=a.getSkinConfiguration(this.options.skin)}}.protect(),proceedWithConfigurationChainWhenResourcesLoaded:function(){if(this.pendingResourcesCounter>0){return false}else{this.callNextConfigurationStep()}}.protect(),removeDesktopEvents:function(){this.containerElement.removeEvents();window.removeEvents();document.removeEvents()}.protect(),revertConstruction:function(){if(this.resources){this.resources.release()}if(this.header){this.header.destroy()}if(this.contentArea){this.contentArea.destroy()}if(this.footer){this.footer.destroy()}if(this.windowDocker){this.windowDocker.destroy()}this.destroyWindows();this.destroyPanels();this.destroyColumns();this.removeDesktopEvents();this.state=DesktopElement.States.INITIALIZED}.protect(),showDesktop:function(){this.containerElement.setStyle("visibility","visible");this.callNextConfigurationStep()}.protect(),subscribeToWebUIMessages:function(){this.logger.debug(this.options.componentName+".subscribeToWebUIMessages() started.");this.messageBus.subscribeToMessage(MenuSelectedMessage,this.webUIMessageHandler);this.callNextConfigurationStep()}.protect(),unmarshallColumns:function(){var a=this.configurationXml.selectNodes(this.options.columnSelector);a.each(function(c,b){var d=new DesktopColumn(c,{componentContainerId:this.containerId});d.unmarshall();this.columns.put(d.getName(),d)},this)}.protect(),unmarshallDesktopContentArea:function(){var a=this.configurationXml.selectNode(this.options.contentAreaSelector);if(a){this.contentArea=new DesktopContentArea(a,this.resourceBundle,{componentContainerId:this.containerId,onConstructed:this.onContentAreaConstructed,onConstructionError:this.onError});this.contentArea.unmarshall()}}.protect(),unmarshallDesktopProperties:function(){this.name=this.configurationXml.selectNodeText(this.options.nameSelector);this.description=this.configurationXml.selectNodeText(this.options.descriptionSelector);this.version=this.configurationXml.selectNodeText(this.options.versionSelector);this.containerId=this.configurationXml.selectNodeText(this.options.containerIdSelector);if(!this.containerId){this.containerId=this.options.defaultContainerId}this.containerElement=$(this.containerId);if(!this.containerElement){throw new NoneExistingDesktopContainerElementException(this.containerId)}}.protect(),unmarshallFooter:function(){var a=this.configurationXml.selectNode(this.options.footerSelector);if(a){this.footer=new DesktopFooter(a,this.resourceBundle,{componentContainerId:this.containerId,onConstructed:this.onFooterConstructed,onError:this.onError});this.footer.unmarshall()}}.protect(),unmarshallHeader:function(){var a=this.configurationXml.selectNode(this.options.headerSelector);if(a){this.header=new DesktopHeader(a,this.resourceBundle,{componentContainerId:this.containerId,onConstructed:this.onHeaderConstructed,onError:this.onError});this.header.unmarshall()}}.protect(),unmarshallPanels:function(){var a=this.configurationXml.selectNodes(this.options.panelSelector);a.each(function(d,c){var b=new DesktopPanel(d,this.resourceBundle,{componentContainerId:this.containerId,onConstructed:this.onPanelConstructed});b.unmarshall();this.panels.put(b.getName(),b)},this)}.protect(),unmarshallResources:function(){var a=this.configurationXml.selectNode(this.options.resourcesSelector);if(a){this.resources=new ResourceManager(a,{onResourcesLoaded:this.onResourcesLoaded,onResourceError:this.onResourceError});this.resources.unmarshall()}}.protect(),unmarshallWindowDocker:function(){var a=this.configurationXml.selectNode(this.options.windowDockerSelector);if(a){this.windowDocker=new WindowDocker(a,this.resourceBundle,{componentContainerId:this.containerId,onConstructed:this.onWindowDockerConstructed});this.windowDocker.unmarshall()}}.protect(),unmarshallWindows:function(){var a=this.configurationXml.selectNodes(this.options.windowSelector);a.each(function(c,b){var d=new DesktopWindow(c,this.resourceBundle,{componentContainerId:this.containerId,onConstructed:this.onWindowConstructed});d.unmarshall();this.windows.put(d.getName(),d)},this)}.protect(),});var DesktopElement=new Class({Implements:[Events,Options,TimeOutBehaviour],Binds:["constructed","finalizeConstruction","onConstructionError"],options:{componentContainerId:"desktop",componentName:"DesktopElement",defaultTag:"div",definitionXmlNameSpace:"xmlns:pp='http://www.processpuzzle.com'",eventFireDelay:5,idSelector:"@id",tagSelector:"@tag",},initialize:function(b,c,a){this.setOptions(a);this.componentStateManager;this.constructionChain=new Chain();this.containerElement;this.definitionElement=b;this.error;this.htmlElement;this.id;this.internationalization=c;this.logger;this.messageBus;this.state=DesktopElement.States.UNINITIALIZED;this.tag;this.setUp()},construct:function(){if(this.state!=DesktopElement.States.UNMARSHALLED){throw new UnconfiguredDocumentElementException("destroy","initialized")}this.logger.trace(this.options.componentName+".construct() of '"+this.id+"'started.");this.startTimeOutTimer("construct");this.compileConstructionChain();this.constructionChain.callChain()},destroy:function(){this.logger.trace(this.options.componentName+".destroy() of '"+this.name+"' started.");if(this.state==DesktopElement.States.CONSTRUCTED){this.destroyComponents()}this.resetProperties();if(this.htmlElement){this.htmlElement.destroy()}this.state=DesktopElement.States.INITIALIZED},onConstructionError:function(a){this.error=a;this.revertConstruction();this.fireEvent("error",this.error)},unmarshall:function(){this.state=DesktopElement.States.UNMARSHALLED},getContainerElement:function(){return this.containerElement},getContainerElementId:function(){return this.options.componentContainerId},getDefinitionElement:function(){return this.definitionElement},getId:function(){return this.id},getState:function(){return this.state},isSuccess:function(){return this.error==null},compileConstructionChain:function(){this.constructionChain.chain(this.finalizeConstruction)}.protect(),configureLogger:function(){if(this.webUIController==null){this.logger=Class.getInstanceOf(WebUILogger);if(this.logger==null){this.logger=new WebUILogger()}}else{this.logger=this.webUIController.getLogger()}}.protect(),createHtmlElement:function(){if(this.tag){this.htmlElement=new Element(this.tag);if(this.id){this.htmlElement.set("id",this.id)}this.htmlElement.inject(this.containerElement)}}.protect(),definitionElementAttribute:function(a){var b=XmlResource.selectNode(a,this.definitionElement);if(b){return b.value}else{return null}}.protect(),destroyComponents:function(){}.protect(),finalizeConstruction:function(){this.stopTimeOutTimer();this.state=DesktopElement.States.CONSTRUCTED;this.constructionChain.clearChain();this.fireEvent("constructed",this,this.options.eventFireDelay)}.protect(),resetProperties:function(){}.protect(),revertConstruction:function(){this.state=DesktopElement.States.INITIALIZED}.protect(),setUp:function(){this.componentStateManager=Class.getInstanceOf(ComponentStateManager);this.configureLogger();this.containerElement=$(this.options.componentContainerId);if(this.containerElement==null){throw new IllegalArgumentException("Parameter 'componetContainerId' in invalid.")}this.messageBus=Class.getInstanceOf(WebUIMessageBus);this.state=DesktopElement.States.INITIALIZED}.protect(),unmarshallElementProperties:function(){this.id=this.definitionElementAttribute(this.options.idSelector);if(!this.id){this.id=this.options.idPrefix+(new Date().getTime())}if(this.dataElementsIndex>0){this.id+="#"+this.dataElementsIndex}this.tag=this.definitionElementAttribute(this.options.tagSelector);if(!this.tag){this.tag=this.options.defaultTag}}.protect()});DesktopElement.States={UNINITIALIZED:0,INITIALIZED:1,UNMARSHALLED:2,CONSTRUCTED:3};var DesktopColumn=new Class({Extends:DesktopElement,options:{componentName:"DesktopColumn",maximumWidthSelector:"maximumWidth",minimumWidthSelector:"minimumWidth",nameSelector:"name",placementSelector:"placement",widthSelector:"width"},initialize:function(b,a){this.parent(b,null,a);this.maximumWidth;this.minimumWidth;this.MUIColumn;this.name;this.placement;this.width},construct:function(){this.MUIColumn=new MUI.Column({id:this.name,placement:this.placement,width:this.width,resizeLimit:[this.minimumWidth,this.maximumWidth]});this.parent()},destroy:function(){this.parent()},unmarshall:function(){this.maximumWidth=parseInt(XmlResource.determineAttributeValue(this.definitionElement,this.options.maximumWidthSelector));this.minimumWidth=parseInt(XmlResource.determineAttributeValue(this.definitionElement,this.options.minimumWidthSelector));this.name=XmlResource.determineAttributeValue(this.definitionElement,this.options.nameSelector);this.placement=XmlResource.determineAttributeValue(this.definitionElement,this.options.placementSelector);this.width=parseInt(XmlResource.determineAttributeValue(this.definitionElement,this.options.widthSelector));this.parent()},getMaximumWidth:function(){return this.maximumWidth},getMinimumWidth:function(){return this.minimumWidth},getMUIColumn:function(){return this.MUIColumn},getName:function(){return this.name},getPlacement:function(){return this.placement},getWidth:function(){return this.width}});var DesktopContentArea=new Class({Extends:DesktopElement,options:{componentName:"DesktopContentArea",},initialize:function(c,a,b){this.options.type="DesktopContentArea";this.parent(c,a,b)},construct:function(){this.createHtmlElement();this.parent()},unmarshall:function(){this.unmarshallElementProperties();this.parent()}});var DesktopDocument=new Class({Extends:DesktopElement,Binds:["constructDocument","instantiateDocument","onDocumentError","onDocumentReady"],options:{componentName:"DesktopDocument",documentDataNameSpace:"",documentDataUriSelector:"@documentData",documentDefinitionNameSpace:"xmlns:sd='http://www.processpuzzle.com/SmartDocument'",documentDefinitionUriSelector:"@documentDefinition"},initialize:function(b,a,c){this.parent(b,a,c);this.document;this.documentDataUri;this.documentDefinitionUri},destroy:function(){if(this.document){this.document.destroy()}this.document=null;this.documentDataUri=null;this.documentDefinitionUri=null;this.parent()},onDocumentError:function(a){this.onConstructionError(a)},onDocumentReady:function(){this.constructionChain.callChain()},unmarshall:function(){this.unmarshallProperties();this.instantiateDocument();this.parent()},getDocument:function(){return this.document},getDocumentDefinitionUri:function(){return this.documentDefinitionUri},compileConstructionChain:function(){this.constructionChain.chain(this.constructDocument,this.finalizeConstruction)}.protect(),constructDocument:function(){this.document.construct()}.protect(),instantiateDocument:function(){this.document=new SmartDocument(this.internationalization,{documentContainerId:this.options.componentContainerId,documentDefinitionUri:this.documentDefinitionUri,documentContentUri:this.documentDataUri,onDocumentReady:this.onDocumentReady,onDocumentError:this.onDocumentError});this.document.unmarshall()}.protect(),revertConstruction:function(){if(this.document&&this.document.getState()>AbstractDocument.States.INITIALIZED){this.document.destroy()}this.document=null;this.parent()},unmarshallProperties:function(){this.documentDefinitionUri=XmlResource.selectNodeText(this.options.documentDefinitionUriSelector,this.definitionElement,[this.options.definitionXmlNameSpace,this.options.documentDefinitionNameSpace])}.protect()});var DesktopElementFactory=new Class({Implements:Options,options:{},initialize:function(){},create:function(d,a,b){var c;switch(d.tagName.toUpperCase()){case"COMPOSITEELEMENT":c=new CompositeDesktopElement(d,a,b);break;case"DOCUMENTBODY":c=new DesktopBody(d,a,b);break;case"FOOTER":c=new DesktopFooter(d,a,b);break;case"FOOTERBAR":c=new DesktopFooterBar(d,a,b);break;case"HEADER":c=new DesktopHeader(d,a,b);break;case"NAVIGATIONBAR":c=new DesktopNavigationBar(d,a,b);break;case"TITLEBAR":c=new DesktopTitleBar(d,a,b);break;case"ELEMENT":default:c=new DesktopElement(d,a,b);break}return c}});DesktopElementFactory.create=function(e,a,c){var b=new DesktopElementFactory();var d=b.create(e,a,c);return d};var DesktopFooter=new Class({Extends:DesktopDocument,options:{componentName:"DesktopFooter",subElementsSelector:"footerBar | compositeElement | element",},initialize:function(c,a,b){this.parent(c,a,b);this.footerId},construct:function(){this.parent()},unmarshall:function(){this.parent();this.footerId=this.document.getBody().elements.first().getId()},getId:function(){return this.document.getBody().getId()},getFooterId:function(){return this.footerId}});var DesktopHeader=new Class({Extends:DesktopDocument,options:{componentName:"DesktopHeader",navigationBarId:"desktopNavigationBar"},initialize:function(c,a,b){this.parent(c,a,b)},construct:function(){this.parent()},unmarshall:function(){this.parent()},getId:function(){return this.document.getBody().getId()},getNavigationBarId:function(){return this.options.navigationBarId}});var DesktopPanel=new Class({Extends:DesktopElement,Implements:[ComplexContentBehaviour],Binds:["addScrollBars","constructDocument","constructPlugin","constructHeader","determineComponentElements","finalizeConstruction","instantiateMUIPanel","loadHtmlDocument","loadSmartDocument","onContainerResize","onDocumentError","onDocumentReady","onHeaderConstructed","onHeaderConstructionError","onMUIPanelLoaded","onPluginConstructed","onPluginError","restoreComponentState","subscribeToWebUIMessages","webUIMessageHandler"],options:{columnReferenceSelector:"columnReference",componentContentIdPostfix:"",componentName:"DesktopPanel",componentRootElementIdPostfix:"_wrapper",panelContentElementSuffix:"_pad"},initialize:function(c,a,b){this.parent(c,a,b);this.columnReference;this.MUIPanel;this.MUIPanelLoaded=false},construct:function(){this.parent()},destroy:function(){this.parent();this.columnReference=null},onMUIPanelLoaded:function(){this.logger.trace(this.options.componentName+".construct() of '"+this.name+"'s MUIPanel finished.");this.MUIPanelLoaded=true;this.constructionChain.callChain()},unmarshall:function(){this.unmarshallProperties();this.unmarshallPanelProperties();this.unmarshallHeader();this.unmarshallPlugin();this.unmarshallDocument();this.parent()},getColumnReference:function(){return this.columnReference},getComponentStateManager:function(){return this.componentStateManager},getContentUrl:function(){return this.contentUrl},getDocument:function(){return this.document},getDocumentContentUri:function(){return this.documentContentUri},getDocumentDefinitionUri:function(){return this.documentDefinitionUri},getDocumentWrapperId:function(){return this.documentWrapperId},getDocumentWrapperStyle:function(){return this.documentWrapperStyle},getDocumentWrapperTag:function(){return this.documentWrapperTag},getHeader:function(){return this.header},getMUIPanel:function(){return this.MUIPanel},getName:function(){return this.name},getPlugin:function(){return this.plugin},getShowHeader:function(){return this.showHeader},getState:function(){return this.state},getTitle:function(){return this.title},getToolBox:function(){return this.header},isSuccess:function(){return this.error==null},compileConstructionChain:function(){this.constructionChain.chain(this.restoreComponentState,this.instantiateMUIPanel,this.determineComponentElements,this.constructHeader,this.constructPlugin,this.constructDocument,this.addScrollBars,this.subscribeToWebUIMessages,this.finalizeConstruction)}.protect(),determinePanelElement:function(){this.componentRootElement=$(this.name+this.options.panelIdPostfix);this.componentRootElement=$(this.componentRootElement);this.panelContentElement=$(this.name);this.constructionChain.callChain()}.protect(),instantiateMUIPanel:function(){var a=this.header&&this.header.getPlugin()?"":this.title;try{this.MUIPanel=new MUI.Panel({column:this.columnReference,content:"",onContentLoaded:this.header?null:this.onMUIPanelLoaded,contentURL:this.contentUrl,id:this.name,header:this.showHeader,headerToolbox:this.header?true:false,headerToolboxOnload:this.header?this.onMUIPanelLoaded:null,headerToolboxURL:this.header?this.header.getToolBoxUrl():null,height:this.height,onResize:this.onContainerResize,scrollbars:true,title:a})}catch(b){var c=b.name+": "+b.message;c+=b.stack?"\n"+b.stack:"";this.logger.error(c);this.fireEvent("constructed",this,this.options.eventFireDelay);this.onConstructionError(b)}}.protect(),loadHtmlDocument:function(b){this.documentContentUri=b.getDocumentURI();this.documentContentType=b.getDocumentType();var a=this.documentContentUri+this.options.documentNameSeparator+this.resourceBundle.getLocale().getLanguage()+".html";MUI.updateContent({element:$(this.name),onContentLoaded:this.onDocumentReady,padding:{top:0,right:5,bottom:0,left:5},title:this.title,url:a})}.protect(),unmarshallPanelProperties:function(){this.columnReference=XmlResource.determineAttributeValue(this.definitionElement,this.options.columnReferenceSelector)}.protect(),});var DesktopPanelHeader=new Class({Implements:[Events,Options],Binds:["construct","onPluginConstructed","onPluginConstructionError"],options:{componentName:"DesktopPanelHeader",contentStyleSelector:"@contentStyle",contextRootPrefix:"",headerSelector:"panelHeader",pluginSelector:"plugin",toolboxContent:"JavaScript/Source/Desktop/EmptyToolboxContent.html",toolboxSelector:"toolBox",toolBoxUrlSelector:"@toolBoxUrl",type:"DesktopPanel"},initialize:function(b,c,a){this.setOptions(a);this.contentStyle;this.contextElement;this.definitionElement=b;this.error=false;this.internationalization=c;this.logger=Class.getInstanceOf(WebUILogger);this.plugin;this.state=DesktopPanelHeader.States.INITIALIZED;this.toolBox=null;this.toolBoxOnLoad=null;this.toolBoxUrl=this.options.toolboxContent},construct:function(a,b){this.contextElement=a;this.constructPlugin();this.addContentStyle()},destroy:function(){if(this.plugin){this.plugin.destroy()}},onPluginConstructed:function(){this.state=DesktopPanelHeader.States.CONSTRUCTED;this.fireEvent("headerConstructed",this)},onPluginConstructionError:function(){this.error=true;this.revertConstruction();this.state=DesktopPanelHeader.States.INITIALIZED;this.fireEvent("headerConstructionError",this)},unmarshall:function(){this.contentStyle=XmlResource.selectNodeText(this.options.contentStyleSelector,this.definitionElement);this.toolBoxUrl=XmlResource.selectNodeText(this.options.toolBoxUrlSelector,this.definitionElement);if(!this.toolBoxUrl){this.toolBoxUrl=this.options.contextRootPrefix+this.options.toolboxContent}var a=XmlResource.selectNode(this.options.pluginSelector,this.definitionElement);if(a){this.plugin=new DocumentPlugin(a,this.internationalization,{onConstructed:this.onPluginConstructed,onConstructionError:this.onPluginConstructionError});this.plugin.unmarshall()}this.state=DesktopPanelHeader.States.UNMARSHALLED},getContentStyle:function(){return this.contentStyle},getDefinitionElement:function(){return this.definitionElement},getHeaderToolBox:function(){return this.plugin!=null},getPlugin:function(){return this.plugin},getState:function(){return this.state},getToolBoxUrl:function(){return this.toolBoxUrl},addContentStyle:function(){if(this.contentStyle){this.contextElement.getElementById(this.contextElement.get("id")+"Content").addClass(this.contentStyle)}}.protect(),constructPlugin:function(){if(this.plugin){this.plugin.construct()}else{this.onPluginConstructed()}}.protect(),revertConstruction:function(){if(this.plugin){this.plugin.destroy()}}});DesktopPanelHeader.States={UNINITIALIZED:0,INITIALIZED:1,UNMARSHALLED:2,CONSTRUCTED:3};var DesktopStructure=new Class({Implements:[Options],options:{desktopColumnIdSelector:"name",desktopColumnMaximumWidthSelector:"maximumWidth",desktopColumnMinimumWidthSelector:"minimumWidth",desktopColumnPlacementSelector:"placement",desktopColumnWidthSelector:"width",desktopColumnsSelector:"/pp:desktopConfiguration/columns/column",desktopElementId:"desktop",desktopPanelColumnSelector:"columnReference",desktopPanelContentUrlSelector:"contentURL",desktopPanelHeightSelector:"height",desktopPanelIdSelector:"name",desktopPanelRequireSelector:"require",desktopPanelsSelector:"/pp:desktopConfiguration/panels/panel",desktopPanelTitleSelector:"title",dockerAutoHideId:"dockAutoHide",dockerClearId:"dockClear",dockerClearClass:"clear",dockerControlsId:"dock",dockerPlacementId:"dockPlacement",dockerSelector:"/pp:desktopConfiguration/windowDocker",dockerSortId:"dockSort",dockerWrapperId:"dockWrapper",documentContainerId:"pageWrapper",elementsSelector:"elements/element",footerBarSelector:"/pp:desktopConfiguration/footer/footerBar",footerBarElementId:"desktopFooter",footerElementId:"desktopFooterWrapper",footerSelector:"/pp:desktopConfiguration/footer",headerElementId:"desktopHeader",headerSelector:"/pp:desktopConfiguration/header",navigationBarSelector:"/pp:desktopConfiguration/header/navigationBar",navigationBarElementId:"desktopNavbar",idAttributeSelector:"@name",styleSheetElementsSelector:"pp:desktopConfiguration/resources/styleSheets/styleSheet",tagAttributeSelector:"@tag",titleBarSelector:"/pp:desktopConfiguration/header/titleBar",titleBarWrapperId:"desktopTitlebarWrapper"},initialize:function(a,b){this.setOptions(a);this.configurationXml=b;this.desktopColumns=new ArrayList();this.desktopElement=$(this.options.desktopElementId);this.desktopPanels=new ArrayList();this.desktopWindows=new ArrayList();this.documentContainerElement=null;this.footerBarElement=null;this.footerElement=null;this.headerElement=null;this.navigationBarElement=null;this.titleBarElement=null;this.titleBarWrapperElement=null},addDesktopColumn:function(a){this.desktopColumns.add(a)},determineDesktopElementId:function(){return this.desktopElement!=null?this.desktopElement.get("id"):this.options.desktopElementId},determineHeaderElementId:function(){return this.headerElement!=null?this.headerElement.get("id"):this.options.headerElementId},determineFooterElementId:function(){return this.footerElement!=null?this.footerElement.get("id"):this.options.footerElementId},determineNavigationBarElementId:function(){return this.navigationBarElement!=null?this.navigationBarElement.get("id"):this.options.navigationBarElementId},determineDocumentContainerElementId:function(){return this.documentContainerElement!=null?this.documentContainerElement.get("id"):this.options.documentContainerElementId},determineFooterBarElementId:function(){return this.footerBarElement!=null?this.footerBarElement.get("id"):this.options.footerBarElementId},getDesktopColumnIdSelector:function(){return this.options.desktopColumnIdSelector},getDesktopColumnMaximumWidthSelector:function(){return this.options.desktopColumnMaximumWidthSelector},getDesktopColumnMinimumWidthSelector:function(){return this.options.desktopColumnMinimumWidthSelector},getDesktopColumnPlacementSelector:function(){return this.options.desktopColumnPlacementSelector},getDesktopColumnWidthSelector:function(){return this.options.desktopColumnWidthSelector},getDesktopColumns:function(){return this.desktopColumns},getDesktopColumnsSelector:function(){return this.options.desktopColumnsSelector},getDesktopElement:function(){return this.desktopElement},getDesktopPanelContentUrlSelector:function(){return this.options.desktopPanelContentUrlSelector},getDesktopPanelColumnSelector:function(){return this.options.desktopPanelColumnSelector},getDesktopPanelHeightSelector:function(){return this.options.desktopPanelHeightSelector},getDesktopPanelIdSelector:function(){return this.options.desktopPanelIdSelector},getDesktopPanelRequireSelector:function(){return this.options.desktopPanelRequireSelector},getDesktopPanels:function(){return this.desktopPanels},getDesktopPanelsSelector:function(){return this.options.desktopPanelsSelector},getDesktopPanelTitleSelector:function(){return this.options.desktopPanelTitleSelector},getDesktopWindows:function(){return this.desktopWindows},getDocumentContainerElement:function(){return this.documentContainerElement},getDocumentContainerId:function(){return this.options.documentContainerId},getElementsSelector:function(){return this.options.elementsSelector},getFooterBarElement:function(){return this.footerBarElement},getFooterBarSelector:function(){return this.options.footerBarSelector},getFooterElement:function(){return this.footerElement},getFooterSelector:function(){return this.options.footerSelector},getHeaderElement:function(){return this.headerElement},getHeaderSelector:function(){return this.options.headerSelector},getIdAttributeSelector:function(){return this.options.idAttributeSelector},getNavigationBarElement:function(){return this.navigationBarElement},getNavigationBarSelector:function(){return this.options.navigationBarSelector},getStyleSheetByIndex:function(a){var b=this.getStyleSheetElementByIndex(a);return this.configurationXml.selectNode("text()",b).nodeValue},getStyleSheetElementByIndex:function(a){return this.getStyleSheetElements()[a]},getStyleSheetElements:function(){return this.configurationXml.selectNodes(this.options.styleSheetElementsSelector)},getTagAttributeSelector:function(){return this.options.tagAttributeSelector},getTitleBarElement:function(){return this.titleBarElement},getTitleBarSelector:function(){return this.options.titleBarSelector},getTitleBarWrapperElement:function(){return this.titleBarWrapperElement},getTitleBarWrapperId:function(){return this.options.titleBarWrapperId},getWindowDockerAutoHideId:function(){return this.options.dockerAutoHideId},getWindowDockerClearId:function(){return this.options.dockerClearId},getWindowDockerClearClass:function(){return this.options.dockerClearClass},getWindowDockerControlsId:function(){return this.options.dockerControlsId},getWindowDockerId:function(){return this.options.dockerWrapperId},getWindowDockerPlacementId:function(){return this.options.dockerPlacementId},getWindowDockerSelector:function(){return this.options.dockerSelector},getWindowDockerSortId:function(){return this.options.dockerSortId},setDesktopElement:function(a){this.desktopElement=a},setDocumentContainerElement:function(a){this.documentContainerElement=a},setFooterBarElement:function(a){this.footerBarElement=a},setFooterElement:function(a){this.footerElement=a},setHeaderElement:function(a){this.headerElement=a},setNavigationBarElement:function(a){this.navigationBarElement=a},setTitleBarElement:function(a){this.titleBarElement=a},setTitleBarWrapperElement:function(a){this.titleBarWrapperElement=a}});var DesktopWindow=new Class({Extends:DesktopElement,Implements:[ComplexContentBehaviour],Binds:["constructDocument","constructHeader","constructPlugin","destroy","determineComponentElements","instantiateMUIWindow","onContainerResize","onDocumentError","onDocumentReady","onHeaderConstructed","onHeaderConstructionError","onMUIWindowLoaded","onPluginConstructed","onPluginError","restoreComponentState","subscribeToWebUIMessages","webUIMessageHandler"],options:{componentContainerId:"desktop",componentContentIdPostfix:"_content",componentName:"DesktopWindow",componentRootElementIdPostfix:"",},initialize:function(b,c,a){this.parent(b,c,a);this.MUIWindow;this.onReadyCallBack},construct:function(a){this.onReadyCallBack=a;this.parent()},destroy:function(){this.parent()},onMUIWindowLoaded:function(){this.constructionChain.callChain()},unmarshall:function(){this.unmarshallProperties();this.unmarshallWindowProperties();this.unmarshallHeader();this.unmarshallPlugin();this.unmarshallDocument();this.parent()},getMUIWindow:function(){return this.MUIWindow},getOnReadyCallback:function(){return this.onReadyCallBack},getWindowContentElement:function(){return this.contentContainerElement},getWindowElement:function(){return this.componentRootElement},compileConstructionChain:function(){this.constructionChain.chain(this.instantiateMUIWindow,this.determineComponentElements,this.constructHeader,this.constructPlugin,this.constructDocument,this.subscribeToWebUIMessages,this.finalizeConstruction)}.protect(),instantiateMUIWindow:function(){if(this.contentUrl){this.internationalizeContentUri()}this.MUIWindow=new MUI.Window({container:this.containerElement,contentURL:this.contentUrl?this.contentUrl:null,height:this.height,id:this.name,onClose:this.destroy,onContentLoaded:this.contentUrl?this.onMUIWindowLoaded:null,onResize:this.onContainerResize,title:this.internationalization.getText(this.title),width:this.width});if(!this.contentUrl){this.constructionChain.callChain()}}.protect(),unmarshallWindowProperties:function(){}.protect(),});DesktopWindow.Activity={SHOW_WINDOW:"showWindow",SHOW_NOTIFICATION:"showNotification"};var NoneExistingDesktopContainerElementException=new Class({Extends:WebUIException,options:{description:"The specifified desktop container element: '{desktopContainerId}' doesn't exist.",name:"NoneExistingDesktopContainerElementException"},initialize:function(b,a){this.setOptions(a);this.parent(a);this.parameters={desktopContainerId:b}}});var PanelInterpreter=new Class({Implements:[Options],options:{headerSelector:"panelHeader",pluginSelector:"plugin",toolboxContent:"../Desktop/EmptyToolboxContent.html"},initialize:function(b,a){this.setOptions(a);this.headerToolBox=false;this.headerToolBoxOnLoad=null;this.headerToolBoxURL=this.options.toolboxContent;this.panelConfiguration=b;this.headerPlugin=null},interpret:function(){this.interpretPanelHeader()},getHeaderPlugin:function(){return this.headerPlugin},getHeaderToolBox:function(){return this.headerToolBox},getHeaderToolBoxOnLoad:function(){return this.headerToolBoxOnLoad},getHeaderToolBoxURL:function(){return this.headerToolBoxURL},interpretPanelHeader:function(){var a=XmlResource.selectNode(this.options.headerSelector,this.panelConfiguration);if(a){this.headerToolBox=true;this.interpretPlugin(a);this.headerToolBoxOnLoad=this.headerPlugin.onload}}.protect(),interpretPlugin:function(parentConfigurationElement){this.headerPlugin={css:[],images:[],js:[],onload:null};var pluginText=XmlResource.selectNodeText(this.options.pluginSelector,parentConfigurationElement);this.headerPlugin=pluginText!=null?eval("("+pluginText+")"):this.headerPlugin}});var ResourceLoadTimeoutException=new Class({Extends:WebUIException,options:{description:"Loading one or more resources exceeded the '{resourceLoadTimeout}' ms timeout period.",name:"ResourceLoadTimeoutException"},initialize:function(b,a){this.setOptions(a);this.parent(a);this.parameters={resourceLoadTimeout:b}}});var ResourceNotFoundException=new Class({Extends:WebUIException,options:{description:"Resource '{resourceName}' not found.",name:"ResourceNotFoundException"},initialize:function(b,a){this.setOptions(a);this.parent(a);this.parameters={resourceName:b}}});var UnconfiguredDesktopElementException=new Class({Extends:WebUIException,options:{description:"When calling method: '{methodName}' of a DocumentElement it should be in: '{statusName}' .",name:"UnconfiguredDesktopElementException"},initialize:function(b,a,c){this.setOptions(c);this.parent(c);this.parameters={methodName:b,statusName:a}}});var WindowDocker=new Class({Extends:DesktopElement,options:{componentName:"WindowDocker",dockerAutoHideId:"dockAutoHide",dockerClearId:"dockClear",dockerClearClass:"clear",dockerControlsId:"dock",dockerPlacementId:"dockPlacement",dockerSelector:"/desktopConfiguration/windowDocker",dockerSortId:"dockSort",dockerWrapperId:"dockWrapper"},initialize:function(c,a,b){this.parent(c,a,b);this.dockerAutoHideElement;this.dockerClearElement;this.dockerControlsElement;this.dockerPlacementElement;this.dockerSortElement},construct:function(){this.dockerControlsElement=new Element("div",{id:this.options.dockerControlsId});this.dockerPlacementElement=new Element("div",{id:this.options.dockerPlacementId});this.dockerAutoHideElement=new Element("div",{id:this.options.dockerAutoHideId});this.dockerSortElement=new Element("div",{id:this.options.dockerSortId});this.dockerClearElement=new Element("div",{id:this.options.dockerClearId,"class":this.options.dockerClearClass});this.createHtmlElement();this.htmlElement.grab(this.dockerControlsElement,"bottom");this.dockerControlsElement.grab(this.dockerPlacementElement,"bottom");this.dockerControlsElement.grab(this.dockerAutoHideElement,"bottom");this.dockerControlsElement.grab(this.dockerSortElement,"bottom");this.dockerSortElement.grab(this.dockerClearElement,"bottom");this.parent()},destroy:function(){this.dockerClearElement.destroy();this.dockerSortElement.destroy();this.dockerAutoHideElement.destroy();this.dockerPlacementElement.destroy();this.parent()},unmarshall:function(){this.unmarshallElementProperties();this.parent()}});var DiagramWidget=new Class({Extends:BrowserWidget,Binds:["destroyCanvas","destroyFigures","drawCanvas","drawFigures"],options:{authorSelector:"//pp:widgetDefinition/author",canvasHeightDefault:200,canvasHeightSelector:"//pp:widgetDefinition/canvas/@height",canvasWidthDefault:300,canvasWidthSelector:"//pp:widgetDefinition/canvas/@width",componentName:"DiagramWidget",descriptionSelector:"//pp:widgetDefinition/description",figuresSelector:"//pp:widgetDefinition/figures/annotation | //pp:widgetDefinition/figures/class | //pp:widgetDefinition/figures/inheritanceConnection",nameSelector:"//pp:widgetDefinition/name",paintAreaId:"paintarea",titleSelector:"//pp:widgetDefinition/title",widgetContainerId:"DiagramWidget",widgetDefinitionURI:"MenuDefinition.xml"},initialize:function(a,b){this.parent(a,b);this.author;this.canvas;this.canvasHeight;this.canvasWidth;this.description;this.figures=new ArrayList();this.name;this.title;this.paintArea},construct:function(a){this.parent()},destroy:function(){this.parent()},unmarshall:function(){this.unmarshallProperties();this.unmarshallFigures();return this.parent()},getAuthor:function(){return this.author},getCanvas:function(){return this.canvas},getCanvasHeight:function(){return this.canvasHeight},getCanvasWidth:function(){return this.canvasWidth},getDescription:function(){return this.i18Resource.getText(this.description)},getFigures:function(){return this.figures},getName:function(){return this.name},getTitle:function(){return this.i18Resource.getText(this.title)},getPaintArea:function(){return this.paintArea},compileConstructionChain:function(){this.constructionChain.chain(this.drawCanvas,this.drawFigures,this.finalizeConstruction)}.protect(),compileDestructionChain:function(){this.destructionChain.chain(this.destroyFigures,this.destroyCanvas,this.destroyChildHtmlElements,this.finalizeDestruction)}.protect(),destroyCanvas:function(){this.paintArea.destroy();this.destructionChain.callChain()}.protect(),destroyFigures:function(){this.figures.each(function(a,b){a.destroy()}.bind(this));this.figures.clear();this.destructionChain.callChain()}.protect(),drawCanvas:function(){this.paintArea=this.elementFactory.create("div",null,this.containerElement,WidgetElementFactory.Positions.LastChild,{id:this.options.paintAreaId,styles:{height:this.canvasHeight,width:this.canvasWidth}});this.canvas=new draw2d.Workflow(this.options.paintAreaId);this.constructionChain.callChain()}.protect(),drawFigures:function(){this.figures.each(function(a,b){a.draw(this)}.bind(this));this.constructionChain.callChain()}.protect(),unmarshallFigures:function(){var a=this.definitionXml.selectNodes(this.options.figuresSelector);if(a){a.each(function(c,d){var b=DiagramFigureFactory.create(c,this.i18Resource);b.unmarshall();this.figures.add(b)},this)}}.protect(),unmarshallProperties:function(){this.name=this.unmarshallWidgetProperty(null,this.options.nameSelector);this.description=this.unmarshallWidgetProperty("",this.options.descriptionSelector);this.title=this.unmarshallWidgetProperty("",this.options.titleSelector);this.author=this.unmarshallWidgetProperty("",this.options.authorSelector);this.canvasHeight=parseInt(this.unmarshallWidgetProperty(this.options.canvasHeightDefault,this.options.canvasHeightSelector));this.canvasWidth=parseInt(this.unmarshallWidgetProperty(this.options.canvasWidthDefault,this.options.canvasWidthSelector))}.protect(),unmarshallWidgetProperty:function(c,a){var b=this.definitionXml.selectNodeText(a);if(b){return b}else{return c}}.protect()});var DiagramFigure=new Class({Implements:[Events,Options],Binds:["addFigureToCanvas","finalizeDraw"],options:{componentName:"DiagramFigure",nameSelector:"@name",positionXSelector:"@positionX",positionYSelector:"@positionY"},initialize:function(b,c,a){this.setOptions(a);this.canvas;this.definitionXml=b;this.diagram;this.draw2dObject;this.drawChain=new Chain();this.internationalization=c;this.name;this.positionX;this.positionY;this.state=DiagramFigure.States.INITIALIZED},destroy:function(){if(this.state==DiagramFigure.States.CONSTRUCTED){this.removeFigureFromCanvas();this.state=DiagramFigure.States.INITIALIZED}},draw:function(a){assertThat(a,not(nil()));this.diagram=a;this.canvas=a.getCanvas();this.compileDrawChain();this.drawChain.callChain()},unmarshall:function(){this.unmarshallProperties();this.state=DiagramFigure.States.UNMARSHALLED},getDraw2dObject:function(){return this.draw2dObject},getId:function(){return this.draw2dObject.id},getName:function(){return this.name},getPositionX:function(){return this.positionX},getPositionY:function(){return this.positionY},getState:function(){return this.state},compileDrawChain:function(){this.drawChain.chain(this.instantiateDraw2dObject,this.addFigureToCanvas,this.finalizeDraw)}.protect(),addFigureToCanvas:function(){this.canvas.addFigure(this.draw2dObject,this.positionX,this.positionY);this.drawChain.callChain()}.protect(),finalizeDraw:function(){this.drawChain.clearChain();this.state=DiagramFigure.States.CONSTRUCTED;this.fireEvent("drawReady",this)}.protect(),lookUpDiagramFigure:function(a){var b=null;this.diagram.getFigures().each(function(c,d){if(c.getName()==a){b=c}}.bind(this));return b}.protect(),removeFigureFromCanvas:function(){this.canvas.removeFigure(this.draw2dObject)}.protect(),unmarshallProperties:function(){this.name=XmlResource.selectNodeText(this.options.nameSelector,this.definitionXml);this.positionX=XmlResource.selectNodeText(this.options.positionXSelector,this.definitionXml);this.positionY=XmlResource.selectNodeText(this.options.positionYSelector,this.definitionXml)}.protect()});DiagramFigure.States={UNINITIALIZED:0,INITIALIZED:1,UNMARSHALLED:2,CONSTRUCTED:3};var AnnotationFigure=new Class({Extends:DiagramFigure,Implements:[Events,Options],Binds:["instantiateDraw2dObject","drawAttributes","setDimension"],options:{componentName:"AnnotationFigure",textSelector:"text",heightSelector:"@height",widthSelector:"@width"},initialize:function(b,c,a){this.parent(b,c,a);this.height;this.text;this.width},destroy:function(){this.parent()},draw:function(a){this.parent(a)},unmarshall:function(){this.parent()},getHeight:function(){return this.height},getText:function(){return this.text},getWidth:function(){return this.width},compileDrawChain:function(){this.drawChain.chain(this.instantiateDraw2dObject,this.setDimension,this.addFigureToCanvas,this.finalizeDraw)}.protect(),instantiateDraw2dObject:function(){this.draw2dObject=new draw2d.Annotation(this.text);this.drawChain.callChain()}.protect(),setDimension:function(){this.draw2dObject.setDimension(this.width,this.height);this.drawChain.callChain()}.protect(),unmarshallProperties:function(){this.text=XmlResource.selectNodeText(this.options.textSelector,this.definitionXml);if(this.text){this.text=this.internationalization.getText(this.text)}this.height=parseInt(XmlResource.selectNodeText(this.options.heightSelector,this.definitionXml));this.width=parseInt(XmlResource.selectNodeText(this.options.widthSelector,this.definitionXml));this.parent()}.protect()});var AttributeFigure=new Class({Implements:[Events,Options],Binds:[],options:{componentName:"AttributeFigure",defaultValueSelector:"@defaultValue",nameSelector:"@name",typeSelector:"@type"},initialize:function(b,c,a){this.setOptions(a);this.defaultValue;this.definitionXml=b;this.internationalization=c;this.name;this.type},construct:function(a){this.parent(a)},destroy:function(){this.parent()},unmarshall:function(){this.unmarshallProperties()},getDefaultValue:function(){return this.defaultValue},getName:function(){return this.name},getType:function(){return this.type},unmarshallProperties:function(){this.name=XmlResource.selectNodeText(this.options.nameSelector,this.definitionXml);this.type=XmlResource.selectNodeText(this.options.typeSelector,this.definitionXml);this.defaultValue=XmlResource.selectNodeText(this.options.defaultValueSelector,this.definitionXml)}.protect()});var ClassFigure=new Class({Extends:DiagramFigure,Implements:[Events,Options],Binds:["instantiateDraw2dObject","drawAttributes"],options:{attributesSelector:"attributes/attribute",componentName:"ClassFigure"},initialize:function(b,c,a){this.parent(b,c,a);this.attributes=new ArrayList()},destroy:function(){this.parent()},draw:function(a){this.parent(a)},unmarshall:function(){this.unmarshallAttributes();this.parent()},getAttributes:function(){return this.attributes},compileDrawChain:function(){this.drawChain.chain(this.instantiateDraw2dObject,this.drawAttributes,this.addFigureToCanvas,this.finalizeDraw)}.protect(),drawAttributes:function(){this.attributes.each(function(b,a){this.draw2dObject.addAttribute(b.getName(),b.getType(),b.getDefaultValue())}.bind(this));this.drawChain.callChain()}.protect(),instantiateDraw2dObject:function(){this.draw2dObject=new draw2d.shape.uml.Class(this.name);this.drawChain.callChain()}.protect(),unmarshallAttributes:function(){var a=this.definitionXml.selectNodes(this.options.attributesSelector);if(a){if(!a.each){a=Array.from(a)}a.each(function(d,b){var c=new AttributeFigure(d,this.internationalization);c.unmarshall();this.attributes.add(c)},this)}}.protect()});var ConnectionFigure=new Class({Extends:DiagramFigure,Implements:[Events,Options],Binds:["instantiateDraw2dObject","linkSourceAndTarget"],options:{componentName:"ConnectionFigure",sourceSelector:"@source",targetSelector:"@target"},initialize:function(b,c,a){this.parent(b,c,a);this.sourceFigureName;this.targetFigureName},destroy:function(){this.parent()},draw:function(a){this.parent(a)},unmarshall:function(){this.parent()},getSourceFigureName:function(){return this.sourceFigureName},getTargetFigureName:function(){return this.targetFigureName},compileDrawChain:function(){this.drawChain.chain(this.instantiateDraw2dObject,this.linkSourceAndTarget,this.addFigureToCanvas,this.finalizeDraw)}.protect(),instantiateDraw2dObject:function(){this.draw2dObject=new draw2d.Connection(this.name);this.drawChain.callChain()}.protect(),linkSourceAndTarget:function(){var b=this.lookUpDiagramFigure(this.sourceFigureName);var a=this.lookUpDiagramFigure(this.targetFigureName);this.draw2dObject.setSource(b.getDraw2dObject().portTop);this.draw2dObject.setTarget(a.getDraw2dObject().portTop);this.drawChain.callChain()}.protect(),unmarshallProperties:function(){this.sourceFigureName=XmlResource.selectNodeText(this.options.sourceSelector,this.definitionXml);this.targetFigureName=XmlResource.selectNodeText(this.options.targetSelector,this.definitionXml);this.parent()}.protect()});var DiagramFigureFactory=new Class({Implements:Options,options:{},initialize:function(){},create:function(c,d,b){var a;switch(c.tagName.toUpperCase()){case"ANNOTATION":a=new AnnotationFigure(c,d,b);break;case"CLASS":a=new ClassFigure(c,d,b);break;case"INHERITANCECONNECTION":default:a=new InheritanceConnectionFigure(c,d,b);break}return a}});DiagramFigureFactory.create=function(d,e,c){var b=new DiagramFigureFactory();var a=b.create(d,e,c);return a};var InheritanceConnectionFigure=new Class({Extends:ConnectionFigure,Implements:[Events,Options],Binds:["instantiateDraw2dObject"],options:{componentName:"InheritanceConnectionFigure"},initialize:function(b,c,a){this.parent(b,c,a)},destroy:function(){this.parent()},draw:function(a){this.parent(a)},unmarshall:function(){this.parent()},instantiateDraw2dObject:function(){this.draw2dObject=new draw2d.shape.uml.InheritanceConnection(this.name);this.drawChain.callChain()}.protect()});var DocumentEditor=new Class({Implements:[Events,Options],Binds:["determineStyleSheets","finalizeAttach","instantiateTools","subscribeToWebUIMessages","webUIMessageHandler"],options:{componentName:"DocumentEditor",subscribeToWebUIMessages:[],},initialize:function(b,a){this.setOptions(a);this.internationalization=b;this.attachChain=new Chain();this.lastWebUIMessage;this.logger=Class.getInstanceOf(WebUILogger);this.messageBus=Class.getInstanceOf(WebUIMessageBus);this.styleSheets=new ArrayList();this.subjectElement},attach:function(a){this.subjectElement=a;this.attachChain.chain(this.determineStyleSheets,this.instantiateTools,this.subscribeToWebUIMessages,this.finalizeAttach);this.attachChain.callChain()},detach:function(){this.destroyTools();this.writeOffFromWebUIMessages();this.finalizeDetach()},showNotification:function(a){var b=new MenuSelectedMessage({originator:this.name,activityType:DesktopWindow.Activity.SHOW_NOTIFICATION,notification:this.options.componentName+"."+a});this.messageBus.notifySubscribers(b)},showWindow:function(a){var b=new MenuSelectedMessage({originator:this.name,activityType:DesktopWindow.Activity.SHOW_WINDOW,windowName:a});this.messageBus.notifySubscribers(b)},webUIMessageHandler:function(webUIMessage){var messageHandlerName="this.on"+webUIMessage.getName();try{var messageHandler=eval(messageHandlerName);messageHandler(webUIMessage)}catch(e){this.logger.debug("'"+messageHandleName+"' should be implemented.")}this.lastWebUIMessage=webUIMessage},getSubjectElement:function(){return this.subjectElement},destroyTools:function(){}.protect(),determineStyleSheets:function(){var a=this.subjectElement.getDocument().getElements("link");a.each(function(b,c){this.styleSheets.add(b.get("href"))},this);this.attachChain.callChain()}.protect(),finalizeAttach:function(){this.attachChain.clearChain();this.fireEvent("editorAttached",this)}.protect(),finalizeDetach:function(){this.fireEvent("editorDetached",this)}.protect(),instantiateTools:function(){this.attachChain.callChain()}.protect(),subscribeToWebUIMessages:function(){if(this.options.subscribeToWebUIMessages){this.options.subscribeToWebUIMessages.each(function(a,b){this.messageBus.subscribeToMessage(a,this.webUIMessageHandler)},this)}this.attachChain.callChain()}.protect(),writeOffFromWebUIMessages:function(){if(this.options.subscribeToWebUIMessages){this.options.subscribeToWebUIMessages.each(function(a,b){this.messageBus.writeOffFromMessage(a,this.webUIMessageHandler)},this)}}.protect(),});var EventWidget=new Class({Extends:BrowserWidget,Binds:["constructEvents","destroyEvents"],options:{componentName:"EventWidget",eventOptions:{},eventsSelector:"//pp:eventList/events/event",useLocalizedData:true,widgetContainerId:"EventWidget"},initialize:function(a,c,b){this.parent(a,c,b);this.events=new ArrayList()},construct:function(){this.parent()},destroy:function(){this.parent()},unmarshall:function(){this.unmarshallEvents();this.parent()},getEvents:function(){return this.events},compileConstructionChain:function(){this.constructionChain.chain(this.constructEvents,this.finalizeConstruction)}.protect(),compileDestructionChain:function(){this.destructionChain.chain(this.destroyEvents,this.destroyChildHtmlElements,this.finalizeDestruction)}.protect(),constructEvents:function(){this.events.each(function(b,a){b.construct(this.containerElement)}.bind(this));this.constructionChain.callChain()}.protect(),destroyEvents:function(){this.events.each(function(b,a){b.destroy()}.bind(this));this.destructionChain.callChain()}.protect(),unmarshallEvents:function(){var a=this.dataXml.selectNodes(this.options.eventsSelector);if(a){a.each(function(c,b){var d=new Event(c,this.elementFactory,this.options.eventOptions);d.unmarshall();this.events.add(d)}.bind(this))}}.protect()});var Event=new Class({Implements:Options,options:{descriptionSelector:"description",descriptionStyle:"eventDescription",endDateSelector:"schedule/endDate",isFullDaySelector:"@isFullDay",linkSelector:"link",locationAddressSelector:"location/address",locationLinkSelector:"location/link",locationStyle:"eventLocation",programDescriptionSelector:"program/description",programLinkSelector:"program/link",publicationDateSelector:"pubDate",scheduleStyle:"eventSchedule",showDescription:true,showLocation:true,showSchedule:true,showTitle:true,startDateSelector:"schedule/startDate",titleSelector:"title",titleStyle:"eventTitle",trancatedDescriptionEnding:"...",truncatedDescriptionLength:120,truncateDescription:false},initialize:function(b,a,c){assertThat(b,not(nil()));this.setOptions(c);this.containerElement;this.description;this.elementFactory=a;this.endDate;this.globalUniqueId;this.eventResource=b;this.isFullDay;this.link;this.locationAddress;this.locationElement;this.locationLink;this.programDescription;this.programLink;this.publicationDate;this.scheduleElement;this.startDate;this.state=BrowserWidget.States.INITIALIZED;this.title},construct:function(a){if(this.state==BrowserWidget.States.UNMARSHALLED){this.containerElement=a;this.createTitleElement();this.createDescriptionElement();this.createScheduleElement();this.createLocationElement();this.state=BrowserWidget.States.CONSTRUCTED}},destroy:function(){if(this.state==BrowserWidget.States.CONSTRUCTED){this.destroyPropertyElements();this.destroyScheduleElements();this.destroyLocationElements()}this.state=BrowserWidget.States.INITIALIZED},unmarshall:function(){this.unmarshallProperties();this.unmarshallSchedule();this.unmarshallLocation();this.state=BrowserWidget.States.UNMARSHALLED},getDescription:function(){return this.description},getElementFactory:function(){return this.elementFactory},getEndDate:function(){return this.endDate},getGlobalUniqueId:function(){return this.globalUniqueId},getLink:function(){return this.link},getLocationAddress:function(){return this.locationAddress},getLocationLink:function(){return this.locationLink},getProgramDescription:function(){return this.programDescription},getProgramLink:function(){return this.programLink},getPublicationDate:function(){return this.publicationDate},getStartDate:function(){return this.startDate},getState:function(){return this.state},getTitle:function(){return this.title},createDescriptionElement:function(){if(this.options.showDescription){var a={"class":this.options.descriptionStyle};var b;if(this.options.truncateDescription){b=this.description.substr(0,this.options.truncatedDescriptionLength)+this.options.trancatedDescriptionEnding}else{b=this.description}this.descriptionElement=this.elementFactory.create("div",b,this.containerElement,WidgetElementFactory.Positions.LastChild,a)}}.protect(),createLocationElement:function(){if(this.options.showLocation){var a={"class":this.options.locationStyle};this.locationElement=this.elementFactory.create("div",this.locationAddress,this.containerElement,WidgetElementFactory.Positions.LastChild,a)}}.protect(),createScheduleElement:function(){if(this.options.showSchedule){var b={"class":this.options.scheduleStyle};var a=this.startDate+" - "+this.endDate;this.scheduleElement=this.elementFactory.create("div",a,this.containerElement,WidgetElementFactory.Positions.LastChild,b)}}.protect(),createTitleElement:function(){var a={"class":this.options.titleStyle};var b=this.link?null:this.title;this.titleElement=this.elementFactory.create("div",b,this.containerElement,WidgetElementFactory.Positions.LastChild,a);if(this.link){this.elementFactory.createAnchor(this.title,this.link,null,this.titleElement)}}.protect(),destroyLocationElements:function(){this.destroyPropertyElement(this.locationElement)}.protect(),destroyPropertyElement:function(a){if(a.removeEvents){a.removeEvents()}if(a.destroy){a.destroy()}}.protect(),destroyPropertyElements:function(){this.destroyPropertyElement(this.titleElement);this.destroyPropertyElement(this.descriptionElement)}.protect(),destroyScheduleElements:function(){this.destroyPropertyElement(this.scheduleElement)}.protect(),unmarshallLocation:function(){this.locationAddress=XmlResource.selectNodeText(this.options.locationAddressSelector,this.eventResource);this.locationLink=XmlResource.selectNodeText(this.options.locationLinkSelector,this.eventResource)}.protect(),unmarshallProperties:function(){this.description=XmlResource.selectNodeText(this.options.descriptionSelector,this.eventResource);this.link=XmlResource.selectNodeText(this.options.linkSelector,this.eventResource);this.programDescription=XmlResource.selectNodeText(this.options.programDescriptionSelector,this.eventResource);this.programLink=XmlResource.selectNodeText(this.options.programLinkSelector,this.eventResource);this.publicationDate=XmlResource.selectNodeText(this.options.publicationDateSelector,this.eventResource);this.title=XmlResource.selectNodeText(this.options.titleSelector,this.eventResource)}.protect(),unmarshallSchedule:function(){this.isFullDay=XmlResource.selectNodeText(this.options.isFullDaySelector,this.eventResource);this.startDate=XmlResource.selectNodeText(this.options.startDateSelector,this.eventResource);this.endDate=XmlResource.selectNodeText(this.options.endDateSelector,this.eventResource)}.protect()});var MenuItem=new Class({Implements:[Events,Options],Binds:["onClick"],options:{captionSelector:"@caption",componentName:"MenuItem",contextItemId:"",href:"#",idPathSeparator:"/",isDefaultSelector:"@isDefault",menuItemIdSelector:"@menuItemId",messagePropertiesSelector:"messageProperties",parentItemId:"",selectedItemStyle:"selectedMenuItem",showSubItems:false,target:"_self"},initialize:function(c,a,b){this.setOptions(b);this.anchorElement;this.definitionXml=c;this.caption;this.elementFactory=a;this.isDefault;this.listItemElement;this.menuItemId;this.messageProperties;this.parentHtmlElement;this.state=BrowserWidget.States.INITIALIZED},addClassToListItem:function(){if(this.listItemElement){this.listItemElement.addClass(this.options.selectedItemStyle)}},construct:function(a){assertThat(a,not(nil()));this.parentHtmlElement=a;if(this.needsToBeDisplayed()){this.instantiateHtmlElements();this.state=BrowserWidget.States.CONSTRUCTED;if(this.isDefault){this.fireEvent("onDefaultItem",this)}}},destroy:function(){if(this.anchorElement&&this.anchorElement.destroy){this.anchorElement.destroy()}if(this.listItemElement&&this.listItemElement.destroy){this.listItemElement.destroy()}this.state=BrowserWidget.States.INITIALIZED},findItemById:function(a){if(this.getFullId()==a){return this}else{return null}},needsToBeDisplayed:function(){return this.isContextItemUndefined()&&this.isTheRootItem()||this.isContextItemUndefined()&&this.isDirectChildOfRootItem()||this.isContextItemUndefined()&&this.options.showSubItems||this.isTheContextItem()||this.isDirectChildOfContextItem()||this.isChildOfContextItem()&&this.options.showSubItems},onClick:function(){this.addClassToListItem();this.fireEvent("onSelection",this)},removeClassFromListItem:function(){if(this.listItemElement&&this.listItemElement.removeClass){this.listItemElement.removeClass(this.options.selectedItemStyle)}},unmarshall:function(){this.unmarshallProperties();this.unmarshallMessage();this.state=BrowserWidget.States.UNMARSHALLED},getAnchorElement:function(){return this.anchorElement},getCaption:function(){return this.caption},getFullId:function(){return this.options.parentItemId+this.options.idPathSeparator+this.menuItemId},getId:function(){return this.menuItemId},getMessageProperties:function(){return this.messageProperties},getListItemElement:function(){return this.listItemElement},getParentElement:function(){return this.parentHtmlElement},getSelectedItemClass:function(){return this.options.selectedItemStyle},getState:function(){return this.state},instantiateHtmlElements:function(){this.listItemElement=this.elementFactory.create("li",null,this.parentHtmlElement,WidgetElementFactory.Positions.lastChild,{id:this.menuItemId});this.anchorElement=this.elementFactory.createAnchor(this.caption,null,this.onClick,this.listItemElement,WidgetElementFactory.Positions.lastChild)}.protect(),isChildOfContextItem:function(){return this.options.parentItemId!=""&&this.getFullId().contains(this.options.contextItemId+this.options.idPathSeparator)}.protect(),isContextItemUndefined:function(){return this.options.contextItemId==""}.protect(),isDirectChildOfContextItem:function(){return !this.isContextItemUndefined()&&((this.options.contextItemId+this.options.idPathSeparator+this.menuItemId)==this.getFullId())}.protect(),isDirectChildOfRootItem:function(){return(this.options.parentItemId.lastIndexOf(this.options.idPathSeparator)==0)}.protect(),isTheContextItem:function(){return !this.isContextItemUndefined()&&this.options.contextItemId==this.getFullId()}.protect(),isTheRootItem:function(){return this.options.parentItemId==""}.protect(),unmarshallMessage:function(){var messageText=XmlResource.selectNodeText(this.options.messagePropertiesSelector,this.definitionXml);this.messageProperties=messageText?eval("("+messageText+")"):{};this.messageProperties.contextItemId=this.getFullId()}.protect(),unmarshallProperties:function(){this.caption=XmlResource.selectNodeText(this.options.captionSelector,this.definitionXml);this.isDefault=parseBoolean(XmlResource.selectNodeText(this.options.isDefaultSelector,this.definitionXml,null,false));this.menuItemId=XmlResource.selectNodeText(this.options.menuItemIdSelector,this.definitionXml)}.protect()});var CompositeMenu=new Class({Extends:MenuItem,Binds:["onDefaultItem","onSelection"],options:{componentName:"CompositeMenu",menuStyle:"menuWidget",subItemsSelector:"menuItem"},initialize:function(c,a,b){this.parent(c,a,b);this.listElement;this.subItems=new ArrayList()},construct:function(a){this.parent(a);this.constructSubItems()},destroy:function(){if(this.options.showSubItems){this.destroySubItems()}if(this.listElement&&this.listElement.destroy){this.listElement.destroy()}this.parent()},findItemById:function(b){var a=this.parent(b);if(a){return a}else{this.subItems.each(function(e,c){var d=e.findItemById(b);if(d){a=d}}.bind(this))}return a},onDefaultItem:function(a){this.fireEvent("onDefaultItem",a)},onSelection:function(a){this.fireEvent("onSelection",a)},unmarshall:function(){this.parent();this.unmarshallSubItems()},getMenuStyle:function(){return this.options.menuStyle},getSelectedElementClass:function(){return this.options.selectedElementClass},getState:function(){return this.state},getSubItems:function(){return this.subItems},anyChildNeedsToBeDisplayed:function(){var a=false;this.subItems.each(function(c,b){if(c.needsToBeDisplayed()){a=true}}.bind(this));return a}.protect(),constructSubItems:function(){this.subItems.each(function(b,a){b.construct(this.parentHtmlElement)}.bind(this))}.protect(),destroySubItems:function(){this.subItems.each(function(b,a){b.destroy()}.bind(this));this.subItems.clear()}.protect(),instantiateHtmlElements:function(){if(!this.isTheContextItem()){this.parent()}if(this.anyChildNeedsToBeDisplayed()){this.listElement=this.elementFactory.create("ul",null,this.listItemElement,WidgetElementFactory.Positions.lastChild,{id:this.menuItemId});this.parentHtmlElement=this.listElement;if(this.isTheRootItem()||this.isTheContextItem()){this.listElement.addClass(this.options.menuStyle)}}}.protect(),unmarshallProperties:function(){this.parent()}.protect(),unmarshallSubItems:function(){var a=XmlResource.selectNodes(this.options.subItemsSelector,this.definitionXml);if(a){a.each(function(b,c){var d=MenuItemFactory.create(b,this.elementFactory,{contextItemId:this.options.contextItemId,idPathSeparator:this.options.idPathSeparator,menuStyle:this.options.menuStyle,onDefaultItem:this.onDefaultItem,onSelection:this.onSelection,parentItemId:this.getFullId(),selectedItemStyle:this.options.selectedItemStyle,showSubItems:this.options.showSubItems});d.unmarshall();this.subItems.add(d)}.bind(this))}}.protect()});var HierarchicalMenuWidget=new Class({Extends:BrowserWidget,Binds:["constructMenuItems","destroyMenuItems","determineCurrentItemId","fireCurrentSelection","onDefaultItem","onSelection"],options:{componentName:"HierarchicalMenuWidget",contextItemId:"",idPathSeparator:"/",fireDefaultItem:true,menuItemOptions:{},menuStyle:"menuWidget",rootMenuSelector:"//pp:menuWidgetDefinition/menuItem[1]",selectedItemStyle:"selectedMenuItem",showSubItems:false,widgetContainerId:"HierarchicalMenuWidget"},initialize:function(a,b){this.parent(a,b);this.currentItemId;this.defaultItem;this.rootMenu;this.selectedItem;this.ulElement;this.instantiateMenuItemFactory()},construct:function(){this.parent()},destroy:function(){this.parent()},findItemById:function(a){if((a==null)||(this.state!=BrowserWidget.States.UNMARSHALLED&&this.state!=BrowserWidget.States.CONSTRUCTED)){return null}return this.rootMenu.findItemById(a)},onDefaultItem:function(a){if(this.isDirectChildOfContextItem(a)||this.isDirectChildOfPreviousDefault(this.defaultItem,a)){this.defaultItem=a}},onSelection:function(a){if(this.selectedItem!=a){this.deselectCurrentItem();this.selectedItem=a}this.storeComponentState();this.messageBus.notifySubscribers(this.createMessage(a))},unmarshall:function(){this.parent();this.unmarshallMenu()},webUIMessageHandler:function(a){this.parent(a);if(instanceOf(a,MenuSelectedMessage)){if(a.getActionType()=="loadMenu"){this.destroy();this.givenOptions.contextItemId=a.getContextItemId();this.unmarshall();this.construct()}}},getContextItemId:function(){return this.options.contextItemId},getCurrentItemId:function(){return this.currentItemId},getRootMenu:function(){return this.rootMenu},getSelectedItemClass:function(){return this.options.selectedItemStyle},compileConstructionChain:function(){this.constructionChain.chain(this.constructMenuItems,this.fireCurrentSelection,this.finalizeConstruction)}.protect(),compileDestructionChain:function(){this.destructionChain.chain(this.destroyMenuItems,this.destroyChildHtmlElements,this.finalizeDestruction)}.protect(),compileStateSpecification:function(){this.stateSpecification={currentItemId:this.selectedItem.getFullId(),contextItemId:this.options.contextItemId}}.protect(),constructMenuItems:function(){this.rootMenu.construct(this.containerElement);this.constructionChain.callChain()}.protect(),createMessage:function(b){var a=b.getMessageProperties();a.originator=this.options.componentName;return new MenuSelectedMessage(a)}.protect(),deselectCurrentItem:function(){if(this.selectedItem){this.selectedItem.removeClassFromListItem()}}.protect(),destroyMenuItems:function(){this.rootMenu.destroy();this.rootMenu=null;this.currentItemId=null;this.defaultItemId=null;this.destructionChain.callChain()}.protect(),determineCurrentItemId:function(){if(!this.currentItemId){this.currentItemId=this.defaultItemId}this.constructionChain.callChain()}.protect(),determineParentDefinitionElement:function(){var a=this.options.parentItemSelector.substitute({menuItemId:this.options.contextItemId});return this.definitionXml.selectNode(a)}.protect(),fireCurrentSelection:function(){var a=this.findItemById(this.currentItemId);if(a==null||(a!=null&&a.getState()!=BrowserWidget.States.CONSTRUCTED)){this.currentItemId=this.defaultItem.getFullId()}var b=this.findItemById(this.currentItemId);b.addClassToListItem();if(this.options.fireDefaultItem){this.onSelection(b)}else{this.selectedItem=b}this.constructionChain.callChain()}.protect(),instantiateMenuItemFactory:function(){MenuItemFactory.singleInstance=new MenuItemFactory({})}.protect(),isDirectChildOfContextItem:function(a){return this.options.contextItemId!=""&&(this.options.contextItemId+this.options.idPathSeparator+a.getId())==a.getFullId()}.protect(),isDirectChildOfPreviousDefault:function(b,a){return b==null||(b.getFullId()+this.options.idPathSeparator+a.getId())==a.getFullId()}.protect(),parseStateSpecification:function(){if(this.stateSpecification){this.currentItemId=this.stateSpecification.currentItemId;this.options.contextItemId=this.stateSpecification.contextItemId;this.givenOptions.contextItemId=this.stateSpecification.contextItemId}}.protect(),standardizeContextItemId:function(){if(this.options.contextItemId!=""&&this.options.contextItemId.charAt(0)!=this.options.idPathSeparator){this.options.contextItemId=this.options.idPathSeparator+this.options.contextItemId}}.protect(),unmarshallMenu:function(){var a=this.dataXml.selectNode(this.options.rootMenuSelector);this.standardizeContextItemId();if(a){this.rootMenu=new RootMenu(a,this.elementFactory,{contextItemId:this.options.contextItemId,idPathSeparator:this.options.idPathSeparator,menuStyle:this.options.menuStyle,onDefaultItem:this.onDefaultItem,onSelection:this.onSelection,selectedItemStyle:this.options.selectedItemStyle,showSubItems:this.options.showSubItems});this.rootMenu.unmarshall()}}.protect(),unmarshallProperties:function(){this.parent()}.protect()});var LeafMenuItem=new Class({Extends:MenuItem,options:{componentName:"LeafMenuItem"},initialize:function(a,c,e,b,d){this.parent(a,c,e,b,d)}});var MenuItemFactory=new Class({Implements:Options,options:{},initialize:function(a){this.setOptions(a)},create:function(d,b,c){var a=XmlResource.selectNodes("menuItem",d).length>0?true:false;var e;if(a){e=new CompositeMenu(d,b,c)}else{e=new LeafMenuItem(d,b,c)}return e}});MenuItemFactory.create=function(c,b,a){if(!MenuItemFactory.singleInstance){MenuItemFactory.singleInstance=new MenuItemFactory()}return MenuItemFactory.singleInstance.create(c,b,a)};MenuItemFactory.singleInstance;var MenuSelectedMessage=new Class({Extends:WebUIMessage,options:{actionType:null,activityType:null,description:"A message about the event that a menu or tool bar item was selected.",documentContentURI:null,documentType:AbstractDocument.Types.SMART,documentURI:null,contextItemId:null,name:"MenuSelectedMessage",notification:null,windowName:null},initialize:function(a){this.setOptions(a);this.options.messageClass=MenuSelectedMessage},getActionType:function(){return this.options.actionType},getActivityType:function(){return this.options.activityType},getContextItemId:function(){return this.options.contextItemId},getDocumentContentURI:function(){return this.options.documentContentURI},getDocumentType:function(){return this.options.documentType},getDocumentURI:function(){return this.options.documentURI},getNotification:function(){return this.options.notification},getWindowName:function(){return this.options.windowName}});var RootMenu=new Class({Extends:CompositeMenu,Binds:[],options:{componentName:"RootMenu"},initialize:function(c,a,b){this.parent(c,a,b)},construct:function(a){this.parent(a)},destroy:function(){this.parent()},unmarshall:function(){this.parent()},destroySubItems:function(){this.subItems.each(function(b,a){b.destroy()}.bind(this))}.protect(),instantiateHtmlElements:function(){this.listElement=this.elementFactory.create("ul",null,this.parentHtmlElement,WidgetElementFactory.Positions.lastChild,{id:this.menuItemId});this.listElement.addClass(this.options.menuStyle);this.parentHtmlElement=this.listElement}.protect()});var HtmlDocument=new Class({Extends:AbstractDocument,Binds:["attachEditor","createTextArea","destroyTextArea","onContainerResize","resizeTextArea"],options:{componentName:"HtmlDocument",documentContentExtension:".html",documentDefinitionNameSpace:"xmlns:sd='http://www.processpuzzle.com/HtmlDocument'",documentEditorClass:"TextAreaEditor",rootElementName:"/htmlDocumentDefinition",},initialize:function(b,a){this.parent(b,a);this.textArea},attachEditor:function(){this.editor.attach(this.textArea,this.documentContent.xmlAsText)}.protect(),construct:function(){this.parent()},destroy:function(){this.parent()},onContainerResize:function(a){this.editor.onContainerResize(this.containerElement.getSize())},resizeTextArea:function(){var a=this.textArea.getScroll().y;this.textArea.scrollTo(null,1);while(this.textArea.getScroll().y>0){var b=this.textArea.clientHeight;this.textArea.rows++;if(this.textArea.clientHeight==b){if(this.textArea.getStyle("overflowY")){this.textArea.setStyle("overflowY","")}this.textArea.scrollTo(null,a);return}this.textArea.scrollTop=1}if(!this.textArea.getStyle("overflowY")){this.textArea.setStyle("overflowY","hidden")}},unmarshall:function(){this.parent()},getTextArea:function(){return this.textArea},compileConstructionChain:function(){this.constructionChain.chain(this.determineContainerElement,this.instantiateEditor,this.createTextArea,this.attachEditor,this.subscribeToWebUIMessages,this.finalizeConstruction)}.protect(),compileDestructionChain:function(){this.destructionChain.chain(this.releseResource,this.detachEditor,this.destroyTextArea,this.resetProperties,this.finalizeDestruction)}.protect(),createTextArea:function(){this.textArea=this.htmlElementFactory.create("textArea",null,this.containerElement,WidgetElementFactory.Positions.LastChild,{id:this.name,styles:{border:0,margin:0,padding:0,visibility:"hidden",overflowY:"hidden"}});this.textArea.set("html",this.documentContent.xmlAsText);this.textArea.setStyle("width",this.containerElement.getSize().x);this.textArea.setStyle("height",this.textArea.getScrollSize().y);this.resizeTextArea();this.constructionChain.callChain()},destroyTextArea:function(){if(this.textArea.removeEvents){this.textArea.removeEvents()}if(this.textArea.destroy){this.textArea.destroy()}this.destructionChain.callChain()}.protect()});var Locale=new Class({Implements:Options,options:{delimiter:",-",language:"en",country:null,variant:null},initialize:function(a){this.setOptions(a)},equals:function(a){return this.options.language==a.options.language&&this.options.country==a.options.country&&this.options.variant==a.options.variant},parse:function(b){var a=new StringTokenizer(b,{delimiters:this.options.delimiter});i=0;while(a.hasMoreTokens()){var c=a.nextToken().trim();if(i==0){this.options.language=c}else{if(i==1){this.options.country=c}else{if(i==2){this.options.variant=c}}}i++}},toString:function(){var a=this.options.language;if(this.options.country!=null&&this.options.country!=""){a+=this.options.delimiter+this.options.country}if(this.options.variant!=null&&this.options.variant!=""){a+=this.options.delimiter+this.options.variant}return a},getLanguage:function(){return this.options.language},getCountry:function(){return this.options.country},getVariant:function(){return this.options.variant}});var LocaleUtil=new Class({initialize:function(){this.DELIMITER="_"},getFileName:function(a,d,e,g){var b=new String(d);if(g>0){var h=a.getLanguage();if(h!=null&&h!=""){b+=this.DELIMITER;b+=h}}if(g>1){var f=a.getCountry();if(f!=null&&f!=""){b+=this.DELIMITER;b+=f}}if(g>2){var c=a.getVariant();if(c!=null&&c!=""){b+=this.DELIMITER;b+=c}}return b.toString()+e},getFileNameList:function(a,e,f){assertThat(f,not(nil()));assertThat(f,containsString("."));var d=new ArrayList();for(var c=0;c<3;c++){var b=this.getFileName(a,e,f,c);if(!d.contains(b)){d.add(b)}}var g=new Array(d.size());for(var c=0;c<g.length;c++){g[c]=d.get(c)}return g},splitName:function(a){var b=new StringTokenizer(a,{delimiters:this.DELIMITER});var c=new Array();i=0;while(b.hasMoreTokens()){c[i]=b.nextToken();i++}return c}});var ResourceCache=new Class({initialize:function(){this.resources=new HashMap();this.self=this},clear:function(){this.resources.clear()},get:function(a,c){var b=new ResourceKey(a,c);if(!this.resources.containsKey(b)){throw new IllegalArgumentException("no such key: "+b)}return this.resources.get(b)},put:function(b,a){this.resources.put(b,a)}});var ResourceKey=new Class({initialize:function(b,a){assertThat(b,not(nil()));assertThat(a,not(nil()));this.key=b;this.type=a},toString:function(){return this.key+"/"+this.type},hashCode:function(){var b=this.key.hashCode();var a=this.toString().hashCode();return b},equals:function(a){return this.compareTo(a)},compareTo:function(a){if(a instanceof ResourceKey){response=(this.key==a.key);if(response){response=(this.type==a.type)}return response}return false}});var XMLBundleParser=new Class({initialize:function(){this.buffer=new String();this.cache=new ResourceCache();this.key;this.parserLanguage,this.parserCountry,this.parserVariant;this.targetLanguage,this.targetCountry,this.targetVariant;this.saxEventHandler=new SAXEventHandler();this.xmlResource=null;this.xmlAsText=""},characters:function(b,c,a){this.buffer+=b.substring(c,c+a)},endElement:function(b){var a=this.buffer.trim();this.buffer=new String();if(b.equals("Language")){this.parserLanguage=null}if(b.equals("Country")){this.parserCountry=null}if(b.equals("Variant")){this.parserVariant=null}if(b.equals("Resource")&&this.inContext()){this.cache.put(this.key,a)}},parse:function(b,d,a){this.cache=b;this.targetLanguage=a.getLanguage();this.targetCountry=a.getCountry();this.targetVariant=a.getVariant();var c=new SAXDriver();c.setDocumentHandler(this);c.setLexicalHandler(this);c.setErrorHandler(this);this.xmlResource=new XmlResource(d,{parseOnComplete:false});c.parse(this.xmlResource.getXmlAsText())},startElement:function(b,a){if(b.equals("Language")){this.parserLanguage=a.getValueByName("name")}if(b.equals("Country")){this.parserCountry=a.getValueByName("name")}if(b.equals("Variant")){this.parserVariant=a.getValueByName("name")}if(b.equals("Resource")){this.key=new ResourceKey(a.getValueByName("key"),a.getValueByName("type"))}},setXML:function(a){this.xmlAsText=a},inContext:function(){if(this.parserLanguage==null||this.parserLanguage.equals(this.targetLanguage)){if(this.parserCountry==null||this.parserCountry.equals(this.targetCountry)){if(this.parserVariant==null||this.parserVariant.equals(this.targetVariant)){return true}}}return false}.protect()});var XMLResourceBundle=new Class({Implements:Options,options:{componentName:"XMLResourceBundle",defaultLocale:null,nameSpaces:"xmlns:pp='http://www.processpuzzle.com/'"},initialize:function(b,a){assertThat(b,not(nil()));this.setOptions(a);this.cache;this.currentLocale=null;this.isLoaded=false;this.logger=Class.getInstanceOf(WebUILogger);this.localeUtil=new LocaleUtil();this.parser=new XMLBundleParser();this.resourceBundleNames=new Array();this.webUIConfiguration=b;this.determineDefaultLocale();this.determineNameSpace();this.determineResourceBundleNames()},getDefaultLocale:function(){return this.options.defaultLocale},getFile:function(b){var a=this.cache.get(b,"File");return new File(a)},getLocale:function(){return this.currentLocale},getNameSpace:function(){return this.options.nameSpaces},getResourceBundleNames:function(){return this.resourceBundleNames},getText:function(b){if(!b){return null}var a;try{a=this.cache.get(b,"String")}catch(c){a=b}return a},load:function(a){this.logger.debug(this.options.componentName+".load() started.");this.currentLocale=a;this.cache=new ResourceCache();var b=this.determineFileNames(a);var e=0;for(var d=0;d<b.size();d++){if(this.parseFile(b.get(d),a)){e++}}if(e==0){var c=new UndefinedXmlResourceException(b.get(0));throw c}this.isLoaded=true},release:function(){this.currentLocale=null;this.cache.clear();this.cache=null;this.resourceBundleNames.empty();this.isLoaded=false},determineDefaultLocale:function(){var a=this.webUIConfiguration.getI18DefaultLocale();if(a!=null){this.options.defaultLocale=a}}.protect(),determineFileNames:function(a){var b=new ArrayList();this.resourceBundleNames.each(function(e,d){var c=this.localeUtil.getFileNameList(a,e,".xml");b.addAll(c)},this);return b}.protect(),determineNameSpace:function(){var a=this.webUIConfiguration.getI18ResourceBundleNameSpace();if(a!=null){this.options.nameSpaces=a}}.protect(),determineResourceBundleNames:function(){var a=this.webUIConfiguration.getI18ResourceBundleElements();for(i=0;i<this.webUIConfiguration.getI18ResourceBundleElements().length;i++){var b=this.webUIConfiguration.getI18ResourceBundleName(i);this.resourceBundleNames[i]=b}}.protect(),parseFile:function(d,a){try{var c=new XmlResource(d,{nameSpaces:this.options.nameSpaces})}catch(b){return false}this.parser.parse(this.cache,d,a);return true}.protect()});var LanguageChangedMessage=new Class({Extends:WebUIMessage,options:{actionType:null,description:"A message about the event that WebUI's language was changed.",name:"Language Changed Message",newLocale:null,previousLocale:null},initialize:function(a){this.setOptions(a);this.options.messageClass=LanguageChangedMessage},getNewLocale:function(){return this.options.newLocale},getPreviousLocale:function(){return this.options.previousLocale}});var LanguageSelectorWidget=new Class({Extends:BrowserWidget,Binds:["onSelection"],options:{componentName:"LanguageSelectorWidget",componentPrefix:"LanguageSelectorWidget",selectElementId:"LanguageSelector",selectTextKey:"LanguageSelectorWidget.select",widgetContainerId:"LanguageSelectorWidget",wrapperElementStyle:"LanguageSelectorWrapper"},initialize:function(a,b,c){this.setOptions(a);this.parent(a,b);this.availableLocales=new ArrayList();this.isConfigured=false;this.selectElement=null;this.selectElementContainer=null;this.webUIConfiguration=c;this.determineInitializationArguments();this.determineAvailableLocales()},construct:function(){this.createSpanElements();this.createSelectElement();this.createSelectElementOptions();return this.parent()},destroy:function(){this.availableLocales.clear();this.parent()},onSelection:function(){var c=this.locale;var a=new Locale();a.parse(this.selectElement.options[this.selectElement.selectedIndex].value);var b=new LanguageChangedMessage({previousLocale:c,newLocale:a,originator:this.options.widgetContainerId});this.messageBus.notifySubscribers(b)},getAvailableLocales:function(){return this.availableLocales},getWebUIConfiguration:function(){return this.webUIConfiguration},createSelectElement:function(){this.selectElement=this.elementFactory.create("select",null,this.selectElementContainer,WidgetElementFactory.Positions.LastChild,{id:this.options.selectElementId});this.selectElement.addEvent("change",this.onSelection)}.protect(),createSelectElementOptions:function(){var a=this.elementFactory.createOption("",this.options.selectTextKey,this.selectElement,WidgetElementFactory.Positions.LastChild);a.set("selected");this.availableLocales.each(function(b,c){this.elementFactory.createOption(b.getLanguage(),this.options.componentPrefix+"."+b.getLanguage(),this.selectElement,WidgetElementFactory.Positions.LastChild)},this)}.protect(),createSpanElements:function(){var a=this.elementFactory.create("span",null,null,null,{"class":this.options.wrapperElementStyle});this.selectElementContainer=this.elementFactory.create("span",null,a)}.protect(),determineAvailableLocales:function(){for(var b=0;b<this.webUIConfiguration.getI18LocaleElements().length;b++){var c=this.webUIConfiguration.getI18Locale(b);var a=new Locale();a.parse(c);this.availableLocales.add(a)}}.protect(),determineInitializationArguments:function(){if(!this.webUIConfiguration){var a=Class.getInstanceOf(WebUIController);if(a){this.webUIConfiguration=a.getWebUIConfiguration()}else{this.webUIConfiguration=Class.getInstanceOf(WebUIConfiguration)}}}.protect()});var NewsReaderWidget=new Class({Extends:BrowserWidget,Binds:["constructChannel","destroyChannel"],options:{channelOptions:{},channelSelector:"//rss/channel",componentName:"NewsReaderWidget",useLocalizedData:true,widgetContainerId:"NewsReaderWidget"},initialize:function(a,c,b){this.parent(a,c,b);this.channel},construct:function(){this.parent()},destroy:function(){this.parent()},unmarshall:function(){this.unmarshallChannel();this.parent()},getChannel:function(){return this.channel},compileConstructionChain:function(){this.constructionChain.chain(this.constructChannel,this.finalizeConstruction)}.protect(),compileDestructionChain:function(){this.destructionChain.chain(this.destroyChannel,this.destroyChildHtmlElements,this.finalizeDestruction)}.protect(),constructChannel:function(){this.channel.construct(this.containerElement);this.constructionChain.callChain()}.protect(),destroyChannel:function(){this.channel.destroy()}.protect(),unmarshallChannel:function(){var a=this.dataXml.selectNode(this.options.channelSelector);if(a){this.channel=new RssChannel(this.dataXml,this.i18Resource,this.elementFactory,this.options.channelOptions);this.channel.unmarshall()}}.protect()});var RssChannel=new Class({Implements:Options,options:{buildDateSelector:"//rss/channel/lastBuildDate",descriptionSelector:"//rss/channel/description",descriptionStyle:"rssChannelDescription",documentsSelector:"//rss/channel/docs",generatorSelector:"//rss/channel/generator",itemOptions:{},itemsSelector:"//rss/channel/item",itemsWrapperStyle:"rssItemsWrapper",languageSelector:"//rss/channel/language",linkSelector:"//rss/channel/link",managingEditorSelector:"//rss/channel/managingEditor",publicationDateSelector:"//rss/channel/pubDate",showDescription:true,showTitle:true,titleSelector:"//rss/channel/title",titleStyle:"rssChannelTitle",webMasterSelector:"//rss/channel/webMaster",wrapperElementId:"rssChannelWrapper",wrapperElementTag:"div"},initialize:function(c,d,a,b){assertThat(c,not(nil()));this.setOptions(b);this.buildDate;this.containerElement;this.description;this.documents;this.elementFactory=a;this.generator;this.internationalization;this.items=new ArrayList();this.language;this.link;this.managingEditor;this.publicationDate;this.rssResource=c;this.state=BrowserWidget.States.INITIALIZED;this.title;this.webMaster;this.wrapperElement},construct:function(a){if(this.state==BrowserWidget.States.UNMARSHALLED){this.containerElement=a;this.createWrapperElement();this.createTitleElement();this.createItemsWrapper();this.constructItems();this.state=BrowserWidget.States.CONSTRUCTED}},destroy:function(){if(this.state==BrowserWidget.States.CONSTRUCTED){this.destroyItems();this.destroyPropertyElements()}this.state=BrowserWidget.States.INITIALIZED},unmarshall:function(){this.unmarshallChannelProperties();this.unmarshallItems();this.state=BrowserWidget.States.UNMARSHALLED},getBuildDate:function(){return this.buildDate},getDescription:function(){return this.description},getDocuments:function(){return this.documents},getElementFactory:function(){return this.elementFactory},getGenerator:function(){return this.generator},getItems:function(){return this.items},getLanguage:function(){return this.language},getLink:function(){return this.link},getManagingEditor:function(){return this.managingEditor},getPublicationDate:function(){return this.publicationDate},getState:function(){return this.state},getTitle:function(){return this.title},getWebMaster:function(){return this.webMaster},getWrapperElement:function(){return this.wrapperElement},constructItems:function(){this.items.each(function(b,a){b.construct(this.itemsWrapperElement)}.bind(this))}.protect(),createItemsWrapper:function(){this.itemsWrapperElement=this.elementFactory.create(this.options.wrapperElementTag,null,this.wrapperElement,WidgetElementFactory.Positions.LastChild,{"class":this.options.itemsWrapperStyle})}.protect(),createTitleElement:function(){if(this.options.showTitle){var a={"class":this.options.titleStyle};var b=this.link?null:this.title;this.titleElement=this.elementFactory.create("div",b,this.wrapperElement,WidgetElementFactory.Positions.LastChild,a);if(this.link){this.elementFactory.createAnchor(this.title,this.link,null,this.titleElement)}}}.protect(),createWrapperElement:function(){this.wrapperElement=this.elementFactory.create(this.options.wrapperElementTag,null,this.containerElement,WidgetElementFactory.Positions.LastChild,{id:this.options.wrapperElementId})}.protect(),destroyItems:function(){this.items.each(function(b,a){b.destroy()}.bind(this))}.protect(),destroyPropertyElements:function(){if(this.wrapperElement.removeEvents){this.wrapperElement.removeEvents()}if(this.wrapperElement.destroy){this.wrapperElement.destroy()}if(this.titleElement&&this.titleElement.removeEvents){this.titleElement.removeEvents()}if(this.titleElement&&this.titleElement.destroy){this.titleElement.destroy()}}.protect(),unmarshallChannelProperties:function(){this.buildDate=this.rssResource.selectNodeText(this.options.buildDateSelector);this.description=this.rssResource.selectNodeText(this.options.descriptionSelector);this.documents=this.rssResource.selectNodeText(this.options.documentsSelector);this.generator=this.rssResource.selectNodeText(this.options.generatorSelector);this.language=this.rssResource.selectNodeText(this.options.languageSelector);this.link=this.rssResource.selectNodeText(this.options.linkSelector);this.managingEditor=this.rssResource.selectNodeText(this.options.managingEditorSelector);this.publicationDate=this.rssResource.selectNodeText(this.options.publicationDateSelector);this.title=this.rssResource.selectNodeText(this.options.titleSelector);this.webMaster=this.rssResource.selectNodeText(this.options.webMasterSelector)}.protect(),unmarshallItem:function(b){var a=new RssItem(b,this.elementFactory,this.options.itemOptions);a.unmarshall();this.items.add(a)}.protect(),unmarshallItems:function(){var a=this.rssResource.selectNodes(this.options.itemsSelector);a.each(function(b,c){this.unmarshallItem(b)},this)}.protect()});var RssItem=new Class({Implements:Options,options:{descriptionSelector:"description",descriptionStyle:"rssItemDescription",globalUniqueIdSelector:"guid",linkSelector:"link",publicationDateSelector:"pubDate",showDescription:true,showTitle:true,titleSelector:"title",titleStyle:"rssItemTitle",trancatedDescriptionEnding:"...",truncatedDescriptionLength:120,truncateDescription:false},initialize:function(a,b,c){assertThat(a,not(nil()));this.setOptions(c);this.containerElement;this.description;this.elementFactory=b;this.globalUniqueId;this.itemResource=a;this.link;this.publicationDate;this.state=BrowserWidget.States.INITIALIZED;this.title},construct:function(a){if(this.state==BrowserWidget.States.UNMARSHALLED){this.containerElement=a;this.createTitleElement();this.createDescriptionElement();this.state=BrowserWidget.States.CONSTRUCTED}},destroy:function(){if(this.state==BrowserWidget.States.CONSTRUCTED){this.destroyPropertyElements()}this.state=BrowserWidget.States.INITIALIZED},unmarshall:function(){this.description=XmlResource.selectNodeText(this.options.descriptionSelector,this.itemResource);this.globalUniqueId=XmlResource.selectNodeText(this.options.globalUniqueIdSelector,this.itemResource);this.link=XmlResource.selectNodeText(this.options.linkSelector,this.itemResource);this.publicationDate=XmlResource.selectNodeText(this.options.publicationDateSelector,this.itemResource);this.title=XmlResource.selectNodeText(this.options.titleSelector,this.itemResource);this.state=BrowserWidget.States.UNMARSHALLED},getDescription:function(){return this.description},getGlobalUniqueId:function(){return this.globalUniqueId},getLink:function(){return this.link},getPublicationDate:function(){return this.publicationDate},getState:function(){return this.state},getTitle:function(){return this.title},createDescriptionElement:function(){if(this.options.showDescription){var a={"class":this.options.descriptionStyle};var b;if(this.options.truncateDescription){b=this.description.substr(0,this.options.truncatedDescriptionLength)+this.options.trancatedDescriptionEnding}else{b=this.description}this.descriptionElement=this.elementFactory.create("div",b,this.containerElement,WidgetElementFactory.Positions.LastChild,a)}}.protect(),createTitleElement:function(){var a={"class":this.options.titleStyle};var b=this.link?null:this.title;this.titleElement=this.elementFactory.create("div",b,this.containerElement,WidgetElementFactory.Positions.LastChild,a);if(this.link){this.elementFactory.createAnchor(this.title,this.link,null,this.titleElement)}}.protect(),destroyPropertyElement:function(a){if(a.removeEvents){a.removeEvents()}if(a.destroy){a.destroy()}}.protect(),destroyPropertyElements:function(){this.destroyPropertyElement(this.titleElement);this.destroyPropertyElement(this.descriptionElement)}});var RssResource=new Class({Extends:XmlResource,options:{},initialize:function(b,a){assertThat(b,not(nil()));this.parent(b,a);this.channel=null},release:function(){},unmarshall:function(){this.unmarshallChannel()},getChannel:function(){return this.channel},getItems:function(){return this.channel.getItems()},unmarshallChannel:function(){this.channel=new RssChannel(this);this.channel.unmarshall()}.protect(),});var PhotoGaleryImage=new Class({Implements:Options,options:{captionSelector:"caption",linkSelector:"link",thumbnailSelector:"thumbnailUri",uriSelector:"uri"},initialize:function(a,c,b){this.setOptions(b);this.anchorElement;this.caption;this.data;this.dataAsText;this.definitionXml=a;this.internationalization=c;this.link;this.thumbnailUri;this.uri;this.state=PhotoGaleryImage.States.INITIALIZED},construct:function(){this.compileDataFromProperties();this.state=PhotoGaleryImage.States.CONSTRUCTED},destroy:function(){this.data=null;this.dataAsText=null;this.link=null;this.thumbnailUri=null;this.uri=null;this.state=PhotoGaleryImage.States.INITIALIZED},unmarshall:function(){this.unmarshallProperties();this.state=PhotoGaleryImage.States.UNMARSHALLED},getCaption:function(){return this.caption},getData:function(){return this.data},getDataAsText:function(){return this.dataAsText},getLink:function(){return this.link},getState:function(){return this.state},getThumbnailUri:function(){return this.thumbnailUri},getUri:function(){return this.uri},compileDataFromProperties:function(){var caption=this.caption?"caption:'"+this.caption+"'":null;var href=this.link?"href:'"+this.link+"'":null;var thumbnail=this.thumbnailUri?"thumbnail:'"+this.thumbnailUri+"'":null;var dataFragment=caption?caption:"";if(dataFragment!=""&&href){dataFragment+=", "}dataFragment+=href?href:"";if(dataFragment!=""&&thumbnail){dataFragment+=", "}dataFragment+=thumbnail?thumbnail:"";this.dataAsText="'"+this.uri+"': {"+dataFragment+"}";this.data=eval("({"+this.dataAsText+"})")}.protect(),unmarshallProperties:function(){this.caption=XmlResource.selectNodeText(this.options.captionSelector,this.definitionXml);this.caption=this.internationalization.getText(this.caption);this.link=XmlResource.selectNodeText(this.options.linkSelector,this.definitionXml);this.thumbnailUri=XmlResource.selectNodeText(this.options.thumbnailSelector,this.definitionXml);this.uri=XmlResource.selectNodeText(this.options.uriSelector,this.definitionXml)}.protect(),});PhotoGaleryImage.States={UNINITIALIZED:0,INITIALIZED:1,UNMARSHALLED:2,CONSTRUCTED:3};var PhotoGaleryWidget=new Class({Extends:BrowserWidget,Binds:["compileDataObject","instantiateSlideShow","onComplete","onEnd","onShow","onStart"],options:{accessKeysDefault:null,accessKeysSelector:"pp:widgetDefinition/properties/accessKeys",automaticallyLinkSlideDefault:false,automaticallyLinkSlideSelector:"pp:widgetDefinition/properties/automaticallyLinkSlideToFullSizedImage",centerImagesDefault:true,centerImagesSelector:"pp:widgetDefinition/properties/centerImages",componentName:"PhotoGaleryWidget",descriptionSelector:"/pp:widgetDefinition/description",effectDurationDefault:750,effectDurationSelector:"pp:widgetDefinition/properties/effectDuration",eventDeliveryDelay:50,firstSlideDefault:0,firstSlideSelector:"pp:widgetDefinition/properties/firstSlide",galeryLinkDefault:null,galeryLinkSelector:"pp:widgetDefinition/properties/galeryLink",heightDefault:300,heightSelector:"pp:widgetDefinition/properties/height",imageFolderUriDefault:"",imageFolderUriSelector:"pp:widgetDefinition/properties/imageFolderUri",imagesSelector:"/pp:widgetData/images/image",loopShowDefault:true,loopShowSelector:"pp:widgetDefinition/properties/loopShow",nameSelector:"/pp:widgetDefinition/name",overlapImagesDefault:true,overlapImagesSelector:"pp:widgetDefinition/properties/overlapImages",resizeImagesDefault:true,resizeImagesSelector:"pp:widgetDefinition/properties/resizeImages",showControllerDefault:true,showControllerSelector:"pp:widgetDefinition/properties/showController",showImageCaptionsDefault:true,showImageCaptionsSelector:"pp:widgetDefinition/properties/showImageCaptions",showSlidesRandomDefault:false,showSlidesRandomSelector:"pp:widgetDefinition/properties/showSlidesRandom",showThumbnailsDefault:true,showThumbnailsSelector:"pp:widgetDefinition/properties/showThumbnails",skipTransitionDefault:null,skipTransitionSelector:"pp:widgetDefinition/properties/skipTransition",slideChangeDelayDefault:2000,slideChangeDelaySelector:"pp:widgetDefinition/properties/slideChangeDelay",slideTransitionDefault:"Sine",slideTransitionSelector:"pp:widgetDefinition/properties/slideTransition",startPausedDefault:true,startPausedSelector:"pp:widgetDefinition/properties/startPaused",thumbnailFileNameRuleDefault:null,thumbnailFileNameRuleSelector:"pp:widgetDefinition/properties/thumbnailFileNameRule",widthDefault:450,widthSelector:"pp:widgetDefinition/properties/width"},initialize:function(a,b){this.setOptions(a);this.parent(a,b);this.accessKeys;this.automaticallyLinkSlide;this.centerImages;this.constructionChain=new Chain();this.data;this.dataAsText="";this.effectDuration;this.firstSlide;this.galeryLink;this.height;this.images=new LinkedHashMap();this.imageFolderUri;this.loopShow;this.overlapImages;this.resizeImages;this.showController;this.showImageCaptions;this.showSlidesRandom;this.showThumbnails;this.skipTransition;this.slideChangeDelay;this.slideShow;this.slideTransition;this.startPaused;this.thumbnailFileNameRule;this.width},construct:function(){this.parent()},destroy:function(){this.destroyComponents();this.destroyChildElements(this.containerElement);this.resetFields();this.parent()},onComplete:function(){if(this.state<BrowserWidget.States.CONSTRUCTED){this.logger.trace(this.options.componentName+".onComplete() completed to load Slideshow 2.");this.constructionChain.callChain()}},onEnd:function(){this.logger.trace(this.options.componentName+".onEnd() ended Slideshow 2.")},onShow:function(){if(this.state<BrowserWidget.States.CONSTRUCTED){this.logger.trace(this.options.componentName+".onShow() started to load Slideshow 2.");this.constructionChain.callChain()}},onStart:function(){if(this.state<BrowserWidget.States.CONSTRUCTED){this.logger.trace(this.options.componentName+".onStart() started to load Slideshow 2.");this.constructionChain.callChain()}},unmarshall:function(){this.unmarshallProperties();this.unmarshallImages();return this.parent()},getAccessKeys:function(){return this.accessKeys},getAutomaticallyLinkSlide:function(){return this.automaticallyLinkSlide},getCenterImages:function(){return this.centerImages},getData:function(){return this.data},getEffectDuration:function(){return this.effectDuration},getFirstSlide:function(){return this.firstSlide},getGaleryLink:function(){return this.galeryLink},getHeight:function(){return this.height},getImages:function(){return this.images},getImageFolderUri:function(){return this.imageFolderUri},getLoopShow:function(){return this.loopShow},getOverlapImages:function(){return this.overlapImages},getResizeImages:function(){return this.resizeImages},getShowController:function(){return this.showController},getShowImageCaptions:function(){return this.showImageCaptions},getShowSlidesRandom:function(){return this.showSlidesRandom},getShowThumbnails:function(){return this.showThumbnails},getSkipTransition:function(){return this.skipTransition},getSlideChangeDelay:function(){return this.slideChangeDelay},getSlideShow:function(){return this.slideShow},getSlideTransition:function(){return this.slideTransition},getStartPaused:function(){return this.startPaused},getThumbnailFileNameRule:function(){return this.thumbnailFileNameRule},getWidth:function(){return this.width},compileDataObject:function(){this.images.each(function(imageEntry,index){var image=imageEntry.getValue();image.construct();if(this.dataAsText){this.dataAsText+=", "}this.dataAsText+=image.getDataAsText()},this);this.data=eval("({"+this.dataAsText+"})");this.constructionChain.callChain()}.protect(),compileConstructionChain:function(){this.constructionChain.chain(this.compileDataObject,this.instantiateSlideShow,this.finalizeConstruction)}.protect(),destroyChildElements:function(a){var b=a.getChildren("*");b.each(function(d,c){if(d.getChildren("*").length>0){this.destroyChildElements(d)}if(d.removeEvents){d.removeEvents()}if(d.destroy){d.destroy()}}.bind(this))}.protect(),destroyComponents:function(){if(this.slideShow){this.slideShow.destroy()}}.protect(),instantiateSlideShow:function(){var a={captions:this.showImageCaptions,center:this.centerImages,controller:this.showController,delay:this.slideChangeDelay,duration:this.effectDuration,fast:this.skipTransition,height:this.height,href:this.galeryLink,hu:this.imageFolderUri,linked:this.automaticallyLinkSlide,loop:this.loopShow,onComplete:this.onComplete,onEnd:this.onEnd,onShow:this.onShow,onStart:this.onStart,overlap:this.overlapImages,paused:this.startPaused,random:this.showSlidesRandom,replace:this.thumbnailFileNameRule,resize:this.resizeImages,slide:this.firstSlide,thumbnails:this.showThumbnails,transition:this.slideTransition,width:this.width};this.slideShow=new Slideshow(this.containerElement,this.data,a)}.protect(),resetFields:function(){this.accessKeys=null;this.automaticallyLinkSlide=null;this.centerImages=null;this.data=null;this.dataAsText="";this.effectDuration=null;this.firstSlide=null;this.galeryLink=null;this.height=null;this.imageFolderUri=null;this.loopShow=null;this.overlapImages=null;this.resizeImages=null;this.showController=null;this.showImageCaptions=null;this.showSlidesRandom=null;this.showThumbnails=null;this.skipTransition=null;this.slideChangeDelay=null;this.slideTransition=null;this.startPaused=null;this.thumbnailFileNameRule=null;this.width=null;this.images.clear()}.protect(),unmarshallImages:function(){var a=this.dataXml.selectNodes(this.options.imagesSelector);if(a){a.each(function(d,b){var c=new PhotoGaleryImage(d,this.i18Resource);c.unmarshall();this.images.put(c.getUri(),c)},this)}}.protect(),unmarshallProperties:function(){this.accessKeys=this.unmarshallProperty(this.options.accessKeysDefault,this.options.accessKeysSelector);this.automaticallyLinkSlide=this.unmarshallProperty(this.options.automaticallyLinkSlideDefault,this.options.automaticallyLinkSlideSelector);this.centerImages=parseBoolean(this.unmarshallProperty(this.options.centerImagesDefault,this.options.centerImagesSelector));this.effectDuration=parseInt(this.unmarshallProperty(this.options.effectDurationDefault,this.options.effectDurationSelector));this.firstSlide=parseInt(this.unmarshallProperty(this.options.firstSlideDefault,this.options.firstSlideSelector));this.galeryLink=this.unmarshallProperty(this.options.galeryLinkDefault,this.options.galeryLinkSelector);this.height=parseInt(this.unmarshallProperty(this.options.heightDefault,this.options.heightSelector));this.imageFolderUri=this.unmarshallProperty(this.options.imageFolderUriDefault,this.options.imageFolderUriSelector);this.loopShow=parseBoolean(this.unmarshallProperty(this.options.loopShowDefault,this.options.loopShowSelector));this.overlapImages=parseBoolean(this.unmarshallProperty(this.options.overlapImagesDefault,this.options.overlapImagesSelector));this.resizeImages=parseBoolean(this.unmarshallProperty(this.options.resizeImagesDefault,this.options.resizeImagesSelector));this.showController=parseBoolean(this.unmarshallProperty(this.options.showControllerDefault,this.options.showControllerSelector));this.showImageCaptions=parseBoolean(this.unmarshallProperty(this.options.showImageCaptionsDefault,this.options.showImageCaptionsSelector));this.showSlidesRandom=parseBoolean(this.unmarshallProperty(this.options.showSlidesRandomDefault,this.options.showSlidesRandomSelector));this.showThumbnails=parseBoolean(this.unmarshallProperty(this.options.showThumbnailsDefault,this.options.showThumbnailsSelector));this.skipTransition=eval("("+this.unmarshallProperty(this.options.skipTransitionDefault,this.options.skipTransitionSelector)+")");this.slideChangeDelay=parseInt(this.unmarshallProperty(this.options.slideChangeDefault,this.options.slideChangeDelaySelector));this.slideTransition=this.unmarshallProperty(this.options.slideTransitionDefault,this.options.slideTransitionSelector);this.startPaused=parseBoolean(this.unmarshallProperty(this.options.startPausedDefault,this.options.startPausedSelector));this.thumbnailFileNameRule=this.unmarshallProperty(this.options.thumbnailFileNameRuleDefault,this.options.thumbnailFileNameRuleSelector);this.width=parseInt(this.unmarshallProperty(this.options.widthDefault,this.options.widthSelector))}.protect(),unmarshallProperty:function(c,a){var b=this.definitionXml.selectNodeText(a);if(b){return b}else{return c}}.protect()});var DocumentResource=new Class({Implements:[Events,Options],Binds:["checkResourceAvailability","onResourceLoaded"],options:{idSelector:"@id",type:null},initialize:function(b,a){this.setOptions(a);this.availabilityCheckIsRunning;this.id=null;this.htmlElement=null;this.resourceElement=b;this.resourceAvailable=false;this.resourceUri=null;this.loadChain=new Chain();this.logger=Class.getInstanceOf(WebUILogger)},load:function(){if(!this.isResourceLoaded()){this.loadChain.chain(this.checkResourceAvailability,this.loadResource).callChain()}else{this.onResourceLoaded()}},onResourceError:function(){this.fireEvent("resourceError",this.resourceUri)},onResourceLoaded:function(){this.fireEvent("resourceLoaded",this)},release:function(){if(this.htmlElement){this.htmlElement.destroy()}},unmarshall:function(){this.id=XmlResource.selectNodeText(this.options.idSelector,this.resourceElement);this.resourceUri=XmlResource.determineNodeText(this.resourceElement);this.resourceUri=this.transformToResourceUriToAbsolute()},getId:function(){return this.htmlElement.get("id")},getResourceType:function(){return this.options.type},getResourceUri:function(){return this.resourceUri},checkResourceAvailability:function(){this.remoteResource=new RemoteResource(this.resourceUri,{async:false,onSuccess:function(b,c){this.resourceAvailable=true;this.availabilityCheckIsRunning=false;this.loadChain.callChain()}.bind(this),onException:function(c,b){this.loadChain.clearChain();if(this.availabilityCheckIsRunning){this.availabilityCheckIsRunning=false;this.onResourceError()}}.bind(this),onFailure:function(b){this.loadChain.clearChain();if(this.availabilityCheckIsRunning){this.availabilityCheckIsRunning=false;this.onResourceError()}}.bind(this)});try{this.availabilityCheckIsRunning=true;this.remoteResource.retrieve()}catch(a){throw new UndefinedDocumentResourceException(this.resourceUri,{cause:a,source:this.componentName})}}.protect(),determineBaseUri:function(){}.protect(),transformToResourceUriToAbsolute:function(){var b=this.resourceUri;var a=document.location.href;a=a.lastIndexOf("#")>0?a.substring(0,a.lastIndexOf("#")):a;a=a.lastIndexOf("?")>0?a.substring(0,a.lastIndexOf("?")):a;a=a.substring(0,a.lastIndexOf("/"));while(b.indexOf("../")==0){b=b.substring(b.indexOf("../")+3);a=a.substring(0,a.lastIndexOf("/"))}return a+"/"+b}});var DocumentImage=new Class({Extends:DocumentResource,Binds:["loadResource"],options:{titleSelector:"@title"},initialize:function(b,a){this.options.type="Image";this.parent(b,a);this.title=null},release:function(){this.parent()},unmarshall:function(){this.parent();this.title=XmlResource.selectNodeText(this.options.titleSelector,this.resourceElement)},getTitle:function(){return this.title},checkResourceAvailability:function(){this.resourceAvailable=true;this.availabilityCheckIsRunning=false;this.loadChain.callChain()}.protect(),isResourceLoaded:function(){return false}.protect(),loadResource:function(){Asset.image(this.resourceUri,{id:this.id,title:this.title,onAbort:function(){this.onResourceError()}.bind(this),onError:function(){this.onResourceError()}.bind(this),onLoad:function(){this.onResourceLoaded()}.bind(this)})}.protect()});var DocumentScript=new Class({Extends:DocumentResource,Binds:["loadResource"],initialize:function(b,a){this.options.type="Script";this.parent(b,a)},release:function(){this.parent()},isResourceLoaded:function(){var a=$$("script[src='"+this.resourceUri+"']");return a.length>0}.protect(),loadResource:function(){Asset.javascript(this.resourceUri,{id:this.id,onLoad:function(){this.htmlElement=$$("script[src='"+this.resourceUri+"']");this.onResourceLoaded()}.bind(this)})}.protect()});var DocumentStyleSheet=new Class({Extends:DocumentResource,Binds:["loadResource"],options:{componentName:"DocumentStyleSheet",idPrefix:"css-preload-"},initialize:function(b,a){this.options.type="StyleSheet";this.parent(b,a);this.remoteResource},release:function(){this.parent()},isResourceLoaded:function(){var a=$$("link[href='"+this.resourceUri+"']");return a.length>0}.protect(),loadResource:function(){new RemoteStyleSheet(this.resourceUri,{onReady:function(b,a){this.logger.debug("Stylesheet: '"+b+"' was added to the document.");this.htmlElement=a;this.onResourceLoaded()}.bind(this),onError:function(){this.logger.debug("Error: Couldn't load style sheet '"+this.resourceUri+"'.");this.onResourceError()}.bind(this),onStart:function(){this.logger.debug("Started to add: '"+this.resourceUri+"' to the document.")}.bind(this)}).start()}.protect()});var ResourceManager=new Class({Implements:[Events,Options],Binds:["onResourceError","onResourceLoaded"],options:{documentImagesSelector:"images/image",documentScriptsSelector:"javaScripts/javaScript",documentStyleSheetsSelector:"styleSheets/styleSheet",eventFireDelay:5,type:null},initialize:function(b,a){this.setOptions(a);this.error=null;this.numberOfResourcesLoaded=0;this.resourceDefinition=b;this.resourceUri=null;this.resources=new ArrayList();this.state=ResourceManager.States.INITIALIZED;this.styleSheets=new ArrayList()},load:function(){if(this.resources.size()>0){this.resources.each(function(b,a){b.load()},this)}else{this.state=ResourceManager.States.LOADED;this.fireEvent("resourcesLoaded",this)}},onResourceError:function(a){this.error=new UndefinedDocumentResourceException(a);this.fireEvent("resourceError",this.error,this.options.eventFireDelay);this.onResourceLoaded(a)},onResourceLoaded:function(a){this.numberOfResourcesLoaded++;if(this.resources.size()>0&&this.numberOfResourcesLoaded>=this.resources.size()){this.state=ResourceManager.States.LOADED;this.fireEvent("resourcesLoaded",this,this.options.eventFireDelay)}},release:function(){this.resources.each(function(b,a){b.release()},this);this.styleSheets.clear();this.resources.clear();this.numberOfResourcesLoaded=0},unmarshall:function(){this.unmarshallResources();this.state=ResourceManager.States.UNMARSHALLED},getError:function(){return this.error},getResources:function(){return this.resources},getResourceType:function(){return this.options.type},getResourceUri:function(){return resourceUri},getState:function(){return this.state},getStyleSheets:function(){return this.styleSheets},isSuccess:function(){return this.error==null},unmarshallResource:function(b,a){var c=XmlResource.selectNodes(b,this.resourceDefinition);c.each(function(e,d){var f=new a(e,{onResourceLoaded:this.onResourceLoaded,onResourceError:this.onResourceError});f.unmarshall();this.resources.add(f);if(instanceOf(f,DocumentStyleSheet)){this.styleSheets.add(f)}},this)}.protect(),unmarshallResources:function(){this.unmarshallResource(this.options.documentScriptsSelector,DocumentScript);this.unmarshallResource(this.options.documentStyleSheetsSelector,DocumentStyleSheet);this.unmarshallResource(this.options.documentImagesSelector,DocumentImage)}.protect()});ResourceManager.States={INITIALIZED:0,UNMARSHALLED:1,LOADED:2};var UndefinedDocumentResourceException=new Class({Extends:WebUIException,options:{description:"Given document resource: '{resourceName}' doesn't exist or can't be accessed.",name:"UndefinedDocumentException"},initialize:function(b,a){this.setOptions(a);this.parent(a);this.parameters={resourceName:b}}});var NoneExistingScrollableElementException=new Class({Extends:WebUIException,options:{description:"The specifified scrollable element: '{scrollableElementId}' doesn't exist.",name:"NoneExistingScrollableElementException"},initialize:function(b,a){this.setOptions(a);this.parent(a);this.parameters={scrollableElementId:b}}});var ScrollArea=new Class({Implements:Options,Binds:["onDocumentClick","onDocumentKeyDown","onDocumentMouseUp","onScrollableElementClick","onScrollableElementKeyDown","onScrollableElementMouseWheel","onWindowResize"],options:{contentElementClass:"contentEl",disabledOpacity:0,downBtnClass:"downBtn",handleOpacity:1,handleActiveOpacity:0.85,fullWindowMode:false,increment:30,paddingElementClass:"paddingEl",scrollBarClass:"scrollBar",scrollHandleClass:"scrollHandle",scrollHandleBGClass:"scrollHandleBG",scrollHandleTopClass:"scrollHandleTop",scrollHandleMiddleClass:"scrollHandleMiddle",scrollHandleBottomClass:"scrollHandleBottom",scrollControlsYClass:"scrollControlsY",upBtnClass:"upBtn"},initialize:function(b,c,a){assertThat(b,not(nil()));this.setOptions(a);this.borderHeight;this.contentEl;this.scrollableElement=b.setProperty("rel","MooScrollArea");this.scrollableElementPadding=this.scrollableElement.getStyles("padding-top","padding-right","padding-bottom","padding-left");this.overHang;this.paddingEl;this.paddingHeight;this.paddingWidth;this.slider;this.viewPort={x:$(window).getSize().x,y:$(window).getSize().y};this.windowFxScroll=c},construct:function(){this.createContentElement();this.adjustScrollableElementSize();this.determineBorderHeight();this.setContentElementStyle();this.createPaddingElement();if(this.options.fullWindowMode){this.switchToFullWindowMode()}this.createControlElements();this.fixIE6CSSbugs();this.determineOverHang();this.setHandleHeight();if(this.overHang<=0){this.greyOut();return}this.initSlider();this.addScrollableElementEvents();this.addContentElementEvents();this.addScrollHandleEvents();this.addDocumentEvents();this.addWindowEvents();this.addUpButtonEvents();this.addDownButtonEvents()},destroy:function(){this.removeContentElementEvents();this.removeDocumentEvents();this.removeDownButtonEvents();this.removeScrollableElementEvents();this.removeScrollHandleEvents();this.removeUpButtonEvents();this.removeWindowEvents();this.destroyControlElements();this.destroyPaddingElement();this.destroyContentElement()},loadContent:function(a){this.slider.set(0);this.paddingEl.empty().set("html",a);this.refresh()},onDocumentClick:function(a){this.hasFocus=false},onDocumentKeyDown:function(a){if((this.hasFocus||this.options.fullWindowMode)&&(a.key==="down"||a.key==="space"||a.key==="up")){this.scrollableElement.fireEvent("keydown",a)}},onDocumentMouseUp:function(a){this.scrollHandle.removeClass(this.options.scrollHandleClass+"-Active").setStyle("opacity",this.options.handleOpacity);this.upBtn.removeClass(this.options.upBtnClass+"-Active");this.downBtn.removeClass(this.options.downBtnClass+"-Active")},onScrollableElementClick:function(a){this.hasFocus=true;this.hasFocusTimeout=(function(){$clear(this.hasFocusTimeout);this.hasFocus=true}.bind(this)).delay(50)},onScrollableElementKeyDown:function(a){if(a.key==="up"){a=new Event(a).stop();this.scrollUp(true)}else{if(a.key==="down"||a.key==="space"){a=new Event(a).stop();this.scrollDown(true)}}},onScrollableElementMouseWheel:function(a){a=new Event(a).stop();if(a.wheel>0){this.scrollUp(true)}else{if(a.wheel<0){this.scrollDown(true)}}},onWindowResize:function(a){$clear(this.refreshTimeout);if(this.options.fullWindowMode){this.refreshTimeout=(function(){$clear(this.refreshTimeout);if(this.viewPort.x!=$(window).getSize().x||this.viewPort.y!=$(window).getSize().y){this.refresh();this.viewPort.x=$(window).getSize().x;this.viewPort.y=$(window).getSize().y}}.bind(this)).delay(250)}},refresh:function(){var a=Math.round(((100*this.step)/this.overHang));if(this.options.fullWindowMode){this.scrollableElement.setStyles({width:"100%",height:"100%"})}this.fixIE6CSSbugs();this.overHang=this.paddingEl.getSize().y-this.scrollableElement.getSize().y;this.setHandleHeight();if(this.overHang<=0){this.greyOut();return}else{this.unGrey()}this.scrollHandle.removeEvents();var b=Math.round((a*this.overHang)/100);this.initSlider();this.slider.set(b);if(Browser.Engine.trident4){this.scrollHandleBG.setStyle("height","0").setStyle("height","100%")}if(this.options.smoothMooScroll.toAnchor||this.options.smoothMooScroll.toMooScrollArea){this.smoothMooScroll=new SmoothMooScroll({toAnchor:this.options.smoothMooScroll.toAnchor,toMooScrollArea:this.options.smoothMooScroll.toMooScrollArea},this.contentEl,this.windowFxScroll)}},addContentElementEvents:function(){this.contentEl.addEvents({scroll:function(a){this.slider.set(this.contentEl.getScroll().y)}.bind(this)})}.protect(),addDocumentEvents:function(){document.addEvents({mouseup:this.onDocumentMouseUp,keydown:this.onDocumentKeyDown,click:this.onDocumentClick})}.protect(),addDownButtonEvents:function(){this.downBtn.addEvents({mousedown:function(a){$clear(this.upInterval);$clear(this.downInterval);this.downInterval=this.scrollDown.periodical(10,this);this.downBtn.addClass(this.options.downBtnClass+"-Active")}.bind(this),mouseup:function(a){$clear(this.upInterval);$clear(this.downInterval)}.bind(this),mouseout:function(a){$clear(this.upInterval);$clear(this.downInterval)}.bind(this)})}.protect(),adjustScrollableElementSize:function(){this.determinePadding();this.scrollableElement.setStyle("overflow","hidden").setStyles({padding:0,width:parseFloat(this.scrollableElement.getStyle("width"))+this.paddingWidth,height:parseFloat(this.scrollableElement.getStyle("height"))+this.paddingHeight})}.protect(),addScrollableElementEvents:function(){this.scrollableElement.addEvents({mousewheel:this.onScrollableElementMouseWheel,keydown:this.onScrollableElementKeyDown,click:this.onScrollableElementClick})}.protect(),addScrollHandleEvents:function(){this.scrollHandle.addEvents({mousedown:function(a){this.scrollHandle.addClass(this.options.scrollHandleClass+"-Active").setStyle("opacity",this.options.handleActiveOpacity)}.bind(this)})}.protect(),addUpButtonEvents:function(){this.upBtn.addEvents({mousedown:function(a){$clear(this.upInterval);$clear(this.downInterval);this.upInterval=this.scrollUp.periodical(10,this);this.upBtn.addClass(this.options.upBtnClass+"-Active")}.bind(this),mouseup:function(a){$clear(this.upInterval);$clear(this.downInterval)}.bind(this),mouseout:function(a){$clear(this.upInterval);$clear(this.downInterval)}.bind(this)})}.protect(),addWindowEvents:function(){window.addEvent("resize",this.onWindowResize)}.protect(),createContentElement:function(){this.contentEl=new Element("div",{"class":this.options.contentElementClass}).adopt(this.scrollableElement.getChildren()).inject(this.scrollableElement,"top")}.protect(),createControlElements:function(){this.scrollControlsYWrapper=new Element("div",{"class":this.options.scrollControlsYClass}).inject(this.scrollableElement,"bottom");this.upBtn=new Element("div",{"class":this.options.upBtnClass}).inject(this.scrollControlsYWrapper,"bottom");this.downBtn=new Element("div",{"class":this.options.downBtnClass}).inject(this.scrollControlsYWrapper,"bottom");this.scrollBar=new Element("div",{"class":this.options.scrollBarClass}).inject(this.scrollControlsYWrapper,"bottom");this.scrollHandle=new Element("div",{"class":this.options.scrollHandleClass}).inject(this.scrollBar,"inside");this.scrollHandleTop=new Element("div",{"class":this.options.scrollHandleTopClass}).inject(this.scrollHandle,"inside");this.scrollHandleBG=new Element("div",{"class":this.options.scrollHandleBGClass}).inject(this.scrollHandle,"inside");this.scrollHandleMiddle=new Element("div",{"class":this.options.scrollHandleMiddleClass}).inject(this.scrollHandle,"inside");this.scrollHandleBottom=new Element("div",{"class":this.options.scrollHandleBottomClass}).inject(this.scrollHandle,"inside");this.coverUp=new Element("div").inject(this.scrollControlsYWrapper,"bottom")}.protect(),createPaddingElement:function(){this.paddingEl=new Element("div",{"class":this.options.paddingElementClass}).adopt(this.contentEl.getChildren()).inject(this.contentEl,"top").setStyles(this.scrollableElementPadding)}.protect(),destroyContentElement:function(){if(this.contentEl&&this.contentEl.destroy){this.contentEl.destroy()}}.protect(),destroyControlElements:function(){if(this.scrollControlsYWrapper){this.scrollControlsYWrapper.destroy()}if(this.upBtn){this.upBtn.destroy()}if(this.downBtn){this.downBtn.destroy()}if(this.scrollBar){this.scrollBar.destroy()}if(this.scrollHandle){this.scrollHandle.destroy()}if(this.scrollHandleTop){this.scrollHandleTop.destroy()}if(this.scrollHandleBG){this.scrollHandleBG.destroy()}if(this.scrollHandleMiddle){this.scrollHandleMiddle.destroy()}if(this.scrollHandleBottom){this.scrollHandleBottom.destroy()}if(this.coverUp){this.coverUp.destroy()}}.protect(),destroyPaddingElement:function(){if(this.paddingEl&&this.paddingEl.destroy){this.paddingEl.destroy()}}.protect(),determineBorderHeight:function(){this.borderHeight=parseFloat(this.scrollableElement.getStyle("border-top-width"))+parseFloat(this.scrollableElement.getStyle("border-bottom-width"))}.protect(),determineOverHang:function(){this.overHang=this.paddingEl.getSize().y-this.scrollableElement.getSize().y}.protect(),determinePadding:function(){this.paddingHeight=parseFloat(this.scrollableElement.getStyle("padding-top"))+parseFloat(this.scrollableElement.getStyle("padding-bottom"));this.paddingWidth=parseFloat(this.scrollableElement.getStyle("padding-left"))+parseFloat(this.scrollableElement.getStyle("padding-right"))}.protect(),initSlider:function(){this.slider=new Slider(this.scrollBar,this.scrollHandle,{range:[0,Math.round(this.overHang)],mode:"vertical",onChange:function(a,b){this.contentEl.scrollTo(0,a);this.webKitKludge(a)}.bind(this)}).set(0)}.protect(),fixIE6CSSbugs:function(){if(Browser.Engine.trident4){this.scrollableElement.setStyle("height",this.scrollableElement.getStyle("height"));this.contentEl.setStyle("height",this.scrollableElement.getStyle("height"));var c=this.scrollBar.getStyle("top").toInt();var a=this.scrollBar.getStyle("bottom").toInt();var b=this.scrollableElement.getSize().y-this.borderHeight;this.scrollControlsYWrapper.setStyles({height:b});this.scrollBar.setStyles({height:b-c-a})}}.protect(),greyOut:function(){this.scrollHandle.setStyles({display:"none"});this.upBtn.setStyles({opacity:this.options.disabledOpacity});this.scrollControlsYWrapper.setStyles({opacity:this.options.disabledOpacity});this.downBtn.setStyles({opacity:this.options.disabledOpacity});this.scrollBar.setStyles({opacity:this.options.disabledOpacity});this.coverUp.setStyles({display:"block",position:"absolute",background:"white",opacity:0.01,right:"0",top:"0",width:"100%",height:this.scrollControlsYWrapper.getSize().y})}.protect(),removeContentElementEvents:function(){if(this.contentEl){this.contentEl.removeEvents()}}.protect(),removeDocumentEvents:function(){document.removeEvent("mouseup",this.onDocumentMouseUp);document.removeEvent("keydown",this.onDocumentKeyDown);document.removeEvent("click",this.onDocumentClick)}.protect(),removeDownButtonEvents:function(){if(this.downBtn){this.downBtn.removeEvents()}}.protect(),removeScrollableElementEvents:function(){if(this.scrollableElement){this.scrollableElement.removeEvent("mousewheel",this.onScrollableElementMouseWheel);this.scrollableElement.removeEvent("keydown",this.onScrollableElementKeyDown);this.scrollableElement.removeEvent("click",this.onScrollableElementClick)}}.protect(),removeScrollHandleEvents:function(){if(this.scrollHandle){this.scrollHandle.removeEvents()}}.protect(),removeUpButtonEvents:function(){if(this.upBtn){this.upBtn.removeEvents()}}.protect(),removeWindowEvents:function(){window.removeEvent("resize",this.onWindowResize)}.protect(),scrollUp:function(a){var b=this.contentEl.getScroll().y-30;this.slider.set(b);if(this.contentEl.getScroll().y<=0&&a){document.window.scrollTo(0,document.window.getScroll().y-this.options.increment)}},scrollDown:function(c){var d=this.contentEl.getScroll().y+this.options.increment;this.slider.set(d);var a=(1*this.paddingEl.getSize().y)/100;var b=(this.paddingEl.getSize().y-this.scrollableElement.getSize().y)<=(this.contentEl.getScroll().y+a);if(b&&c){document.window.scrollTo(0,document.window.getScroll().y+this.options.increment)}},setContentElementStyle:function(){this.contentEl.setStyles({height:this.scrollableElement.getSize().y-this.borderHeight,overflow:"hidden",padding:0})}.protect(),setHandleHeight:function(){var a=(100-((this.overHang*100)/this.paddingEl.getSize().y));this.handleHeight=((a*this.scrollableElement.getSize().y)/100)-(this.scrollHandleTop.getSize().y+this.scrollHandleBottom.getSize().y);if((this.handleHeight+this.scrollHandleTop.getSize().y+this.scrollHandleBottom.getSize().y)>=this.scrollBar.getSize().y){this.handleHeight-=(this.scrollHandleTop.getSize().y+this.scrollHandleBottom.getSize().y)*2}if(this.scrollHandle.getStyle("min-height")&&this.handleHeight<parseFloat(this.scrollHandle.getStyle("min-height"))){this.handleHeight=parseFloat(this.scrollHandle.getStyle("min-height"))+this.scrollHandleBottom.getSize().y+this.scrollHandleTop.getSize().y}this.scrollHandle.setStyles({height:this.handleHeight})}.protect(),setSlider:function(a){if(a=="top"){this.slider.set(0)}else{if(a=="bottom"){this.slider.set("100%")}else{this.slider.set(a)}}}.protect(),switchToFullWindowMode:function(){$(document).getElement("html").setStyle("overflow","hidden");this.scrollableElement.setStyles({height:"100%",width:"100%",position:"absolute"});this.contentEl.setStyles({height:"100%",width:"100%",position:"absolute"})}.protect(),unGrey:function(){this.scrollHandle.setStyles({display:"block",height:"auto"});this.scrollControlsYWrapper.setStyles({opacity:1});this.upBtn.setStyles({opacity:1});this.downBtn.setStyles({opacity:1});this.scrollBar.setStyles({opacity:1});this.coverUp.setStyles({display:"none",width:0,height:0});this.setHandleHeight()}.protect(),webKitKludge:function(a){if(!Browser.Engine.webkit){return}if(this.step>a){this.step=a;return}$clear(this.sliderTimeout);this.sliderTimeout=(function(){$clear(this.sliderTimeout);var b=(1*this.paddingEl.getSize().y)/100;if((b+a)>=this.overHang){if(this.paddingElTopMargin==null){this.paddingElTopMargin=parseFloat(this.paddingEl.getStyle("margin-top"))}this.paddingEl.setStyle("margin-top",this.paddingElTopMargin-b);if(!this.scrollHandleTopMargin){this.scrollHandleTopMargin=parseFloat(this.scrollHandle.getStyle("margin-top"))}this.scrollHandle.setStyle("margin-top",this.scrollHandleTopMargin+2);this.contentEl.scrollTo(0,this.overHang);this.step=this.overHang}else{this.paddingEl.setStyle("margin-top",this.paddingElTopMargin);this.scrollHandle.setStyle("margin-top",this.scrollHandleTopMargin);this.contentEl.scrollTo(0,a);this.step=a}}.bind(this)).delay(10)}});var ScrollBar=new Class({Implements:Options,options:{selector:".scroll",increment:30,upBtnClass:"upBtn",downBtnClass:"downBtn",scrollBarClass:"scrollBar",scrollHandleClass:"scrollHandle",scrollHandleBGClass:"scrollHandleBG",scrollHandleTopClass:"scrollHandleTop",scrollHandleMiddleClass:"scrollHandleMiddle",scrollHandleBottomClass:"scrollHandleBottom",scrollControlsYClass:"scrollControlsY",handleOpacity:1,handleActiveOpacity:0.85,disabledOpacity:0,fullWindowMode:false,smoothMooScroll:{toAnchor:true,toMooScrollArea:true},restrictedBrowsers:[Browser.Engine.presto925,Browser.Platform.ipod,Browser.Engine.webkit419]},initialize:function(b,a){if(this.options.restrictedBrowsers.contains(true)){return}this.setOptions(a);this.scrollArea;this.scrollableElement;this.windowFxScroll=new Fx.Scroll(document.window,{wait:false});this.identifyScrollableElement(b)},construct:function(){this.scrollArea=new ScrollArea(this.scrollableElement,this.windowFxScroll,this.options);this.scrollArea.construct();if(this.options.smoothMooScroll.toAnchor||this.options.smoothMooScroll.toMooScrollArea){this.smoothMooScroll=new SmoothScroll({toAnchor:this.options.smoothMooScroll.toAnchor,toMooScrollArea:this.options.smoothMooScroll.toMooScrollArea},this.scrollArea.contentEl,this.windowFxScroll)}},destroy:function(){this.scrollArea.destroy()},loadContent:function(a){this.scrollArea.loadContent(a)},refresh:function(){this.mooScrollAreas.each(function(b,a){b.refresh()})},setSlider:function(a){this.mooScrollAreas.each(function(c,b){c.setSlider(a)})},getScrollableElement:function(){return this.scrollableElement},getScrollArea:function(){return this.scrollArea},identifyScrollableElement:function(a){this.scrollableElement=$(a);if(!this.scrollableElement){throw new NoneExistingScrollableElementException(a)}}});var SmoothScroll=new Class({Extends:Fx.Scroll,initialize:function(b,c,d){this.setOptions(b);this.windowFxScroll=d;this.context=c;c=c||document;this.context=c;var f=c.getDocument(),e=c.getWindow();this.parent(c,b);this.links=(this.options.links)?$$(this.options.links):$$(f.links);var a=e.location.href.match(/^[^#]*/)[0]+"#";this.links.each(function(h){if(h.href.indexOf(a)!=0){return}var g=h.href.substr(a.length);if(g&&$(g)&&$(g).getParents().contains($(this.context))){this.useLink(h,g,true)}else{if(g&&$(g)&&!this.inMooScrollArea($(g))){this.useLink(h,g,false)}}},this);if(!Browser.Engine.webkit419){this.addEvent("complete",function(){e.location.hash=this.anchor},true)}},inMooScrollArea:function(a){return a.getParents().filter(function(c,b){return c.match("[rel=MooScrollArea]")}).length>0},putAnchorInAddressBar:function(a){window.location.href="#"+a},useLink:function(b,a,c){b.removeEvents("click");b.addEvent("click",function(d){if(!a||!$(a)){return}this.anchor=a;if(c){if(this.options.toMooScrollArea&&this.options.toAnchor){this.windowFxScroll.toElement(this.context.getParent()).chain(function(f,e){this.toElement(a).chain(function(){this.putAnchorInAddressBar(a)}.bind(this))}.bind(this))}else{if(this.options.toMooScrollArea){this.windowFxScroll.toElement(this.context.getParent()).chain(function(){this.putAnchorInAddressBar(a)}.bind(this))}else{if(this.options.toAnchor){this.toElement(a).chain(function(){this.putAnchorInAddressBar(a)}.bind(this))}}}}else{this.windowFxScroll.toElement(a).chain(function(){this.putAnchorInAddressBar(a)}.bind(this))}d.stop()}.bind(this))}});var SkinChangedMessage=new Class({Extends:WebUIMessage,options:{actionType:null,description:"A message about the event that WebUI's skin was changed.",name:"SkingChangedMessage",newSkin:null,previousSkin:null},initialize:function(a){this.setOptions(a);this.options.messageClass=SkinChangedMessage},getNewSkin:function(){return this.options.newSkin},getPreviousSkin:function(){return this.options.previousSkin}});var SkinSelectorWidget=new Class({Extends:BrowserWidget,Binds:["onSelection"],options:{componentPrefix:"SkinSelectorWidget",selectElementId:"SkinSelector",selectTextKey:"SkinSelectorWidget.select",widgetContainerId:"SkinSelectorWidget",wrapperElementStyle:"SkinSelectorWrapper"},initialize:function(a,b,c){this.setOptions(a);this.parent(a,b);this.availableSkins=new HashMap();this.isConfigured=false;this.selectElement=null;this.selectElementContainer=null;this.webUIConfiguration=c;this.determineInitializationArguments();this.determineAvailableSkins()},construct:function(){this.createSpanElements();this.createSelectElement();this.createSelectElementOptions();return this.parent()},destroy:function(){this.availableSkins.clear();this.parent()},onSelection:function(){var c=this.skin;var b=this.selectElement.options[this.selectElement.selectedIndex].value;var a=new SkinChangedMessage({previousSkin:c,newSkin:b,originator:this.options.widgetContainerId});this.messageBus.notifySubscribers(a)},getAvailableSkins:function(){return this.availableSkins},getWebUIConfiguration:function(){return this.webUIConfiguration},createSelectElement:function(){this.selectElement=this.elementFactory.create("select",null,this.selectElementContainer,WidgetElementFactory.Positions.FirstChild,{id:this.options.selectElementId});this.selectElement.addEvent("change",this.onSelection)}.protect(),createSelectElementOptions:function(){var a=this.elementFactory.createOption("",this.options.selectTextKey,this.selectElement,WidgetElementFactory.Positions.LastChild);a.set("selected");this.availableSkins.each(function(c,b){this.elementFactory.createOption(c.getKey(),c.getKey(),this.selectElement,WidgetElementFactory.Positions.LastChild)},this)}.protect(),createSpanElements:function(){var a=this.elementFactory.create("span",null,null,null,{"class":this.options.wrapperElementStyle});this.selectElementContainer=this.elementFactory.create("span",null,a,WidgetElementFactory.Positions.LastChild)}.protect(),determineAvailableSkins:function(){for(var b=0;b<this.webUIConfiguration.getAvailableSkinElements().length;b++){var a=this.webUIConfiguration.getSkinNameByIndex(b);var c=this.webUIConfiguration.getSkinPathByIndex(b);this.availableSkins.put(a,c)}}.protect(),determineInitializationArguments:function(){if(!this.webUIConfiguration){var a=Class.getInstanceOf(WebUIController);this.webUIConfiguration=a.getWebUIConfiguration()}}.protect()});var DocumentElement=new Class({Implements:[Events,Options,TimeOutBehaviour],Binds:["associateEditor","authorization","createHtmlElement","constructPlugin","finalizeConstruction","injectHtmlElement","onPluginConstructed","onPluginError"],options:{componentName:"DocumentElement",defaultTag:"div",idPrefix:"Desktop-Element-",idSelector:"@id",isEditable:false,pluginSelector:"plugin",referenceSelector:"@href",styleSelector:"@elementStyle",tagSelector:"@tag"},initialize:function(c,a,b){this.setOptions(b);this.definitionElement=c;this.resourceUri=null;this.constructionChain=new Chain();this.contextElement;this.editable;this.editor;this.elementFactory;this.error=null;this.htmlElement;this.id;this.logger=WebUILogger?Class.getInstanceOf(WebUILogger):null;this.plugin;this.reference;this.resourceBundle=a;this.status=DocumentElement.States.INITIALIZED;this.style;this.tag;this.text;this.where},construct:function(a,b){if(this.status!=DocumentElement.States.UNMARSHALLED){throw new UnconfiguredDocumentElementException("destroy","initialized")}this.logger.trace(this.options.componentName+".construct() of '"+this.id+"'started.");assertThat(a,not(nil()));this.contextElement=a;this.where=b;this.elementFactory=new WidgetElementFactory(a,this.resourceBundle);this.startTimeOutTimer("construct");this.compileConstructionChain();this.constructionChain.callChain()},destroy:function(){if(this.status==DocumentElement.States.INITIALIZED){throw new UnconfiguredDocumentElementException("destroy","initialized")}if(this.plugin){this.plugin.destroy()}if(this.status==DocumentElement.States.CONSTRUCTED){this.deleteHtmlElement()}if(this.status<=DocumentElement.States.CONSTRUCTED){this.resetProperties()}if(this.editor){this.editor.detach()}this.error=null;this.status=DocumentElement.States.INITIALIZED},onPluginConstructed:function(){this.constructionChain.callChain()},onPluginError:function(a){this.error=a;this.revertConstruction();this.fireEvent("constructionError",this.error)},unmarshall:function(){this.unmarshallId();this.unmarshallReference();this.unmarshallStyle();this.unmarshallTag();this.unmarshallText();this.unmarshallPlugin();this.status=DocumentElement.States.UNMARSHALLED},getDefinitionElement:function(){return this.definitionElement},getBind:function(){return this.bind},getEditor:function(){return this.editor},getHtmlElement:function(){return this.htmlElement},getId:function(){return this.id},getPlugin:function(){return this.plugin},getReference:function(){return this.reference},getState:function(){return this.status},getStyle:function(){return this.style},getTag:function(){return this.tag},getText:function(){return this.text},getResourceType:function(){return this.options.type},getResourceUri:function(){return resourceUri},isEditable:function(){return this.editable},isSuccess:function(){return this.error==null},associateEditor:function(){if(this.isEditable()){this.editor=DocumentElementEditorFactory.create(this,{});this.editor.attach()}this.constructionChain.callChain()}.protect(),authorization:function(){this.editable=this.options.isEditable;this.constructionChain.callChain()}.protect(),compileConstructionChain:function(){this.constructionChain.chain(this.createHtmlElement,this.injectHtmlElement,this.constructPlugin,this.authorization,this.associateEditor,this.finalizeConstruction)}.protect(),constructPlugin:function(){if(this.plugin){this.plugin.construct()}else{this.constructionChain.callChain()}}.protect(),createHtmlElement:function(){if(this.tag){this.htmlElement=new Element(this.tag);if(this.id){this.htmlElement.set("id",this.id)}if(this.style){this.htmlElement.addClass(this.style)}if(this.reference){var a=new Element("a",{href:this.reference});a.appendText(this.text);a.inject(this.htmlElement)}else{if(this.text){this.htmlElement.appendText(this.text)}}}this.constructionChain.callChain()}.protect(),deleteHtmlElement:function(){if(this.htmlElement){if(this.htmlElement.destroy){this.htmlElement.destroy()}this.htmlElement=null}}.protect(),definitionElementAttribute:function(a){var b=XmlResource.selectNode(a,this.definitionElement);if(b){return b.value}else{return null}}.protect(),finalizeConstruction:function(){this.stopTimeOutTimer();this.status=DocumentElement.States.CONSTRUCTED;this.constructionChain.clearChain();this.fireEvent("constructed",this)}.protect(),injectHtmlElement:function(){this.htmlElement.inject(this.contextElement,this.where);this.constructionChain.callChain()}.protect(),resetProperties:function(){this.id=null;this.htmlElement=null;this.reference=null;this.style=null;this.tag=null;this.text=null}.protect(),revertConstruction:function(){this.constructionChain.clearChain();if(this.plugin){this.plugin.destroy()}this.deleteHtmlElement()}.protect(),unmarshallId:function(){this.id=this.definitionElementAttribute(this.options.idSelector);if(!this.id){this.id=this.options.idPrefix+(new Date().getTime())}if(this.dataElementsIndex>0){this.id+="#"+this.dataElementsIndex}}.protect(),unmarshallPlugin:function(){var a=XmlResource.selectNode(this.options.pluginSelector,this.definitionElement);if(a){this.plugin=new DocumentPlugin(a,this.resourceBundle,{onConstructed:this.onPluginConstructed,onConstructionError:this.onPluginError});this.plugin.unmarshall()}}.protect(),unmarshallReference:function(){this.reference=this.definitionElementAttribute(this.options.referenceSelector)}.protect(),unmarshallStyle:function(){this.style=this.definitionElementAttribute(this.options.styleSelector)}.protect(),unmarshallTag:function(){this.tag=this.definitionElementAttribute(this.options.tagSelector);if(!this.tag){this.tag=this.options.defaultTag}}.protect(),unmarshallText:function(){this.text=XmlResource.determineNodeText(this.definitionElement);if(this.resourceBundle&&this.text){this.text=this.resourceBundle.getText(this.text.trim())}if(!this.text){this.text=""}}});DocumentElement.States={INITIALIZED:0,UNMARSHALLED:1,CONSTRUCTED:2};var CompositeDocumentElement=new Class({Extends:DocumentElement,Binds:["constructNestedElements","onNestedElementConstructed","onNestedElementConstructionError"],options:{componentName:"CompositeDocumentElement",subElementsSelector:"compositeElement | element | compositeDataElement | dataElement | formElement | formField",tagName:"div"},initialize:function(d,a,c,b){this.parent(d,a,b);this.dataXml=c;this.elements=new LinkedHashMap();this.nestedElementsContext;this.numberOfConstructedNestedElements=0},construct:function(a,b){this.parent(a,b)},destroy:function(){this.elements.each(function(b,a){var c=b.getValue();if(c.getState()>DocumentElement.States.INITIALIZED){c.destroy()}},this);this.numberOfConstructedNestedElements=0;this.parent()},onNestedElementConstructed:function(a){this.numberOfConstructedNestedElements++;if(this.numberOfConstructedNestedElements==this.elements.size()){this.constructionChain.callChain()}},onNestedElementConstructionError:function(a){this.error=a;this.revertConstruction();this.fireEvent("constructionError",this.error)},unmarshall:function(){this.parent();if(!this.tag){this.tag=this.options.tagName}this.unmarshallNestedElements()},getElement:function(a){return this.elements.get(a)},getElements:function(){return this.elements},addElement:function(a){this.elements.put(a.getId(),a)}.protect(),compileConstructionChain:function(){this.constructionChain.chain(this.createHtmlElement,this.injectHtmlElement,this.associateEditor,this.constructPlugin,this.constructNestedElements,this.authorization,this.finalizeConstruction)}.protect(),constructNestedElements:function(a){if(a){this.nestedElementsContext=a}else{this.nestedElementsContext=this.htmlElement}this.elements.each(function(c,b){var d=c.getValue();d.construct(this.nestedElementsContext)},this)}.protect(),instantiateDocumentElement:function(a){return DocumentElementFactory.create(a,this.resourceBundle,this.dataXml,{onConstructed:this.onNestedElementConstructed,onConstructionError:this.onNestedElementConstructionError})}.protect(),revertConstruction:function(){this.elements.each(function(b,a){var c=b.getValue();if(c.getState()>DocumentElement.States.INITIALIZED){c.destroy()}},this);this.elements.clear();this.numberOfConstructedNestedElements=0;this.parent()}.protect(),unmarshallNestedElement:function(c,b){var a=this.instantiateDocumentElement(c);a.unmarshall();this.addElement(a);return a}.protect(),unmarshallNestedElements:function(){var a=XmlResource.selectNodes(this.options.subElementsSelector,this.definitionElement);a.each(function(c,b){this.unmarshallNestedElement(c)},this)}.protect()});var DataElementBehaviour=new Class({options:{bindSelector:"@bind",maxOccuresSelector:"@maxOccures",minOccuresSelector:"@minOccures",sourceSelector:"@source",variables:{index:"'*'"}},initialize:function(d,a,c,b){this.bind;this.dataXml=c;this.dataElementsNumber;this.maxOccures;this.minOccures;this.numberOfConstructedSiblings;this.siblings;this.source},onSiblingConstructed:function(){this.numberOfConstructedSiblings++;if(this.numberOfConstructedSiblings==this.siblings.size()){this.constructionChain.callChain()}},getDataElementsIndex:function(){return this.dataElementsIndex},getDataElementsNumber:function(){return this.dataElementsNumber},getDataXml:function(){return this.dataXml},getBind:function(){return this.bind},getMaxOccures:function(){return this.maxOccures},getMinOccures:function(){return this.minOccures},getSiblings:function(){return this.siblings},getSource:function(){return this.source},checkIfBindVariableNeeded:function(){if(this.maxOccures){if((this.maxOccures=="unbounded"||this.maxOccures>0)&&(this.bind.search("{.*}")==-1)){throw new MissingBindVariableException(this.id)}}}.protect(),constructSiblings:function(){if(this.siblings.size()>0){this.siblings.each(function(a,b){a.construct(this.contextElement,this.where)},this)}else{this.constructionChain.callChain()}}.protect(),determineDataElementsNumber:function(){var b=this.bind.substitute(this.options.variables);var a=this.dataXml.selectNodes(b);if(this.maxOccures=="unbounded"&&a.length>1){this.dataElementsNumber=a.length}if(this.maxOccures>1&&this.maxOccures<a.length){this.dataElementsNumber=this.maxOccures}}.protect(),destroySiblings:function(){this.siblings.each(function(a,b){a.destroy()},this)}.protect(),instantiateSiblings:function(){for(var b=2;b<=this.dataElementsNumber;b++){var a=DocumentElementFactory.create(this.definitionElement,this.resourceBundle,this.dataXml,{onConstructed:this.onSiblingConstructed,variables:{index:b}});a.unmarshall();this.siblings.add(a)}if(this.dataElementsNumber>1){this.options.variables={index:1}}}.protect(),loadDataSource:function(){if(this.source){this.dataXml=new XmlResource(this.source)}}.protect(),resetProperties:function(){this.bind=null;this.maxOccures=null;this.minOccures=null;this.source=null}.protect(),retrieveData:function(){if(this.bind&&this.dataXml&&instanceOf(this.dataXml,XmlResource)){var a=this.bind.substitute(this.options.variables);this.text=this.dataXml.selectNodeText(a);if(this.text){this.text.trim()}}this.constructionChain.callChain()}.protect(),unmarshallDataProperties:function(){this.bind=this.definitionElementAttribute(this.options.bindSelector);this.maxOccures=this.definitionElementAttribute(this.options.maxOccuresSelector);this.minOccures=this.definitionElementAttribute(this.options.minOccuresSelector);this.source=this.definitionElementAttribute(this.options.sourceSelector);this.checkIfBindVariableNeeded()}});var CompositeDataElement=new Class({Extends:CompositeDocumentElement,Implements:DataElementBehaviour,options:{componentName:"CompositeDataElement"},initialize:function(d,a,c,b){this.parent(d,a,c,b);this.contextElement;this.bind;this.dataElementsNumber=1;this.maxOccures;this.minOccures;this.siblings=new ArrayList();this.source;this.where},construct:function(a,b){this.contextElement=a;this.where=b;this.retrieveData();this.constructSiblings();this.parent(a,b)},destroy:function(){this.destroySiblings();this.parent()},instantiateDocumentElement:function(a){return DocumentElementFactory.create(a,this.resourceBundle,this.dataXml,{onConstructed:this.onNestedElementConstructed,onConstructionError:this.onNestedElementConstructionError,variables:this.options.variables})}.protect(),unmarshall:function(a){this.unmarshallDataProperties();this.loadDataSource();this.determineDataElementsNumber();this.instantiateSiblings();this.parent()},});var DataElement=new Class({Extends:DocumentElement,Binds:["constructSiblings","finalizeConstruction","onSiblingConstructed","retrieveData"],Implements:DataElementBehaviour,options:{componentName:"DataElement",isEditable:true,},initialize:function(d,a,c,b){this.parent(d,a,b);this.setUp(c)},construct:function(a,b){this.parent(a,b)},destroy:function(){this.destroySiblings();this.parent();this.numberOfConstructedSiblings=0},unmarshall:function(){this.unmarshallDataProperties();this.loadDataSource();this.determineDataElementsNumber();this.instantiateSiblings();this.parent()},compileConstructionChain:function(){this.constructionChain.chain(this.retrieveData,this.constructSiblings,this.createHtmlElement,this.injectHtmlElement,this.constructPlugin,this.authorization,this.associateEditor,this.finalizeConstruction)}.protect(),injectHtmlElement:function(){this.htmlElement.addClass(DataElement.CLASS);this.parent()}.protect(),setUp:function(a){this.dataXml=a;this.numberOfConstructedSiblings=0;this.siblings=new ArrayList()}.protect(),});DataElement.CLASS="dataElement";var DocumentElementEditor=new Class({Implements:[Events,Options],Binds:["onBlur","onClick"],options:{dataType:"string",inputStyle:{background:"transparent",border:"none",width:"20em"},mininmumWidth:"400",restriction:null,styleProperties:["color","display","font-family","font-size","font-weight","line-height","margin","height","padding","position","text-align","width"],},initialize:function(b,a){this.setOptions(a);assertThat(b,not(nil()));this.inputElement;this.previousValue;this.state=DocumentElementEditor.States.DETACHED;this.subjectHtmlElement=b;this.text},attach:function(){if(this.state==DocumentElementEditor.States.DETACHED){this.subjectHtmlElement.addEvent("focus",this.onClick);this.subjectHtmlElement.addEvent("click",this.onClick);this.state=DocumentElementEditor.States.ATTACHED}},detach:function(){if(this.state==DocumentElementEditor.States.EDITING||this.state==DocumentElementEditor.States.ATTACHED){if(this.inputElement){this.removeInputElement()}this.state=DocumentElementEditor.States.DETACHED}},onBlur:function(){if(this.state==DocumentElementEditor.States.EDITING){this.removeInputElement();this.state=DocumentElementEditor.States.ATTACHED;this.fireEvent("editEnd",this)}},onClick:function(){if(this.state==DocumentElementEditor.States.ATTACHED){this.saveCurrentValue();this.injectInputElement();this.state=DocumentElementEditor.States.EDITING;this.fireEvent("editStart",this)}},onKeypress:function(){},getInputElement:function(){return this.inputElement},getPreviousValue:function(){return this.previousValue},getState:function(){return this.state},getSubjectElement:function(){return this.subjectHtmlElement},getText:function(){return this.text},isChanged:function(){return !(this.text&&this.text.equals(this.previousValue))},injectInputElement:function(){var a=this.subjectHtmlElement.getStyles(this.options.styleProperties);this.subjectHtmlElement.setStyle("display","none");this.inputElement=new Element("input",{events:{blur:this.onBlur},name:this.subjectHtmlElement.get("id"),type:"text",value:this.text,styles:this.options.inputStyle});this.inputElement.setStyles(a);if(this.inputElement.getStyle("width").toInt()<this.options.minimumWidth){this.inputElement.setStyle("width",this.options.minimumWidth)}this.inputElement.inject(this.subjectHtmlElement,"after")}.protect(),removeInputElement:function(){this.text=this.inputElement.get("value");this.inputElement.removeEvents();this.inputElement.destroy();this.subjectHtmlElement.removeEvent("focus",this.onClick);this.subjectHtmlElement.removeEvent("click",this.onClick);this.subjectHtmlElement.set("text",this.text);this.subjectHtmlElement.setStyle("display","inline")}.protect(),saveCurrentValue:function(){this.text=this.subjectHtmlElement.get("text");this.previousValue=this.text}});DocumentElementEditor.DataType={BOOLEAN:"boolean",INTEGER:"integer",LONG_INTEGER:"longInteger",STRING:"string",TEXT:"text",TIME_POINT:"timePoint"};DocumentElementEditor.DataType.TIME_POINT.Precission={YEAR:"year",MONTH:"month",DAY:"day",HOUR:"hour",MINUTE:"minute",SECOND:"second",MILLI_SECOND:"milliSecond"};DocumentElementEditor.States={DETACHED:"detached",ATTACHED:"attached",EDITING:"editing"};var DataElementEditor=new Class({Extends:DocumentElementEditor,options:{},initialize:function(b,a){this.parent(b,a)}});var DocumentBody=new Class({Extends:CompositeDocumentElement,options:{componentName:"DocumentBody"},initialize:function(b,a,d,c){this.parent(b,a,d,c)},construct:function(a,b){this.parent(a,b)},constructed:function(){this.parent()},unmarshall:function(){this.parent()}});var DocumentElementEditorFactory=new Class({Implements:Options,options:{},initialize:function(){},create:function(d,b){var c=d.getHtmlElement();var a=null;switch(d.options.componentName){case"CompositeDataElement":case"FormField":a=new DataElementEditor(d.getValueElement(),b);break;case"DataElement":a=new DataElementEditor(c,b);break;case"CompositeDocumentElement":case"DocumentElement":a=new DocumentElementEditor(c,b);break}return a}});DocumentElementEditorFactory.create=function(c,b){var a=new DocumentElementEditorFactory();var d=a.create(c,b);return d};var DocumentElementFactory=new Class({Implements:Options,options:{},initialize:function(){},create:function(d,a,c,b){var e;switch(d.tagName.toUpperCase()){case"COMPOSITEDATAELEMENT":e=new CompositeDataElement(d,a,c,b);break;case"COMPOSITEELEMENT":e=new CompositeDocumentElement(d,a,c,b);break;case"DATAELEMENT":e=new DataElement(d,a,c,b);break;case"DOCUMENTBODY":e=new DocumentBody(d,a,c,b);break;case"DOCUMENTFOOTER":e=new DocumentFooter(d,a,c,b);break;case"DOCUMENTHEADER":e=new DocumentHeader(d,a,c,b);break;case"FORMELEMENT":e=new FormElement(d,a,c,b);break;case"FORMFIELD":e=new FormField(d,a,c,b);break;case"ELEMENT":default:e=new DocumentElement(d,a,b);break}return e}});DocumentElementFactory.create=function(f,a,e,c){var b=new DocumentElementFactory();var d=b.create(f,a,e,c);return d};var DocumentFooter=new Class({Extends:CompositeDocumentElement,options:{componentName:"DocumentFooter"},initialize:function(b,a,d,c){this.parent(b,a,d,c)},unmarshall:function(){this.parent()}});var DocumentHeader=new Class({Extends:CompositeDocumentElement,options:{componentName:"DocumentHeader"},initialize:function(b,a,d,c){this.parent(b,a,d,c)},unmarshall:function(){this.parent()}});var DocumentPlugin=new Class({Implements:[Events,Options],Binds:["finalizeConstruction","instantiateWidget","loadResources","onResourceError","onResourcesLoaded","onWidgetConstructed","onWidgetError"],options:{componentName:"DocumentPlugin",nameSelector:"@name",optionsSelector:"widget/options",resourcesSelector:"resources",widgetNameSelector:"widget/@name"},initialize:function(b,c,a){this.setOptions(a);this.constructChain=new Chain();this.definitionElement=b;this.error=null;this.internationalization=c;this.logger=Class.getInstanceOf(WebUILogger);this.name;this.onLoad;this.resources;this.state=DocumentPlugin.States.INITIALIZED;this.widget;this.widgetName;this.widgetOptions;this.constructChain.chain(this.loadResources,this.instantiateWidget,this.finalizeConstruction)},construct:function(){this.logger.trace(this.options.componentName+".construct() of '"+this.name+"' started.");this.constructChain.callChain()},destroy:function(){if(this.resources){this.resources.release()}if(this.widget&&this.widget.destroy&&typeOf(this.widget.destroy)=="function"){this.widget.destroy()}this.state=DocumentPlugin.States.INITIALIZED},loadResources:function(){if(this.resources){this.resources.load()}else{this.constructChain.callChain()}},onResourceError:function(a){this.error=a},onResourcesLoaded:function(){if(this.resources.isSuccess()){this.state=DocumentPlugin.States.LOADED;this.fireEvent("resourcesLoaded",this);this.constructChain.callChain()}else{this.constructChain.clearChain();this.resources.release();this.fireEvent("constructionError",this.error)}},onWidgetConstructed:function(){this.constructChain.callChain()},onWidgetError:function(a){this.error=a;this.constructChain.clearChain();this.fireEvent("constructionError",this.error)},unmarshall:function(){this.unmarshallProperties();this.unmarshallResources();this.unmarshallWidget();this.state=DocumentPlugin.States.UNMARSHALLED},getDefinitionElement:function(){return this.definitionElement},getError:function(){return this.error},getOnLoad:function(){return this.onLoad},getResources:function(){return this.resources},getState:function(){return this.state},getWidget:function(){return this.widget},getWidgetName:function(){return this.widgetName},getWidgetOptions:function(){return this.widgetOptions},isSuccess:function(){return this.error==null},finalizeConstruction:function(){this.constructChain.clearChain();this.state=DocumentPlugin.States.CONSTRUCTED;this.fireEvent("constructed",this)}.protect(),instantiateWidget:function(){if(this.widgetName){try{var widgetClass=eval(this.widgetName);var mergedOptions=Object.merge(this.widgetOptions,{onConstructed:this.onWidgetConstructed,onError:this.onWidgetError});this.widget=new widgetClass(mergedOptions,this.internationalization);this.widget.unmarshall();this.widget.construct()}catch(exception){this.onWidgetError(exception)}}else{this.onWidgetConstructed()}}.protect(),unmarshallOptions:function(){var a=XmlResource.selectNode(this.options.optionsSelector,this.definitionElement);if(a){var b=new OptionsResource(a);b.unmarshall();this.widgetOptions=b.getOptions()}}.protect(),unmarshallProperties:function(){this.name=XmlResource.selectNodeText(this.options.nameSelector,this.definitionElement)}.protect(),unmarshallResources:function(){var a=XmlResource.selectNode(this.options.resourcesSelector,this.definitionElement);if(a){this.resources=new ResourceManager(a,{onResourcesLoaded:this.onResourcesLoaded,onResourceError:this.onResourceError});this.resources.unmarshall()}}.protect(),unmarshallWidget:function(){this.widgetName=XmlResource.selectNodeText(this.options.widgetNameSelector,this.definitionElement);this.unmarshallOptions()}});DocumentPlugin.States={INITIALIZED:0,UNMARSHALLED:1,LOADED:2,CONSTRUCTED:3};var FormElement=new Class({Extends:CompositeDataElement,options:{componentName:"FormElement",methodSelector:"method"},initialize:function(d,a,c,b){this.parent(d,a,c,b);this.controlsContainerElement;this.fieldsContainerElement;this.method},construct:function(a,b){this.parent(a,b)},destroy:function(){this.parent()},unmarshall:function(a){this.unmarshallProperties();this.parent()},getMethod:function(){return this.method},constructNestedElements:function(){this.parent(this.fieldsContainerElement)}.protect(),createHtmlElement:function(){this.htmlElement=this.elementFactory.createForm(this.id,this.method,this.contextElement,WidgetElementFactory.Positions.LastChild);this.controlsContainerElement=this.htmlElement.getChildren()[1];this.fieldsContainerElement=this.htmlElement.getChildren()[0];this.constructionChain.callChain()}.protect(),unmarshallProperties:function(){this.method=this.resourceBundle.getText(XmlResource.determineAttributeValue(this.definitionElement,this.options.methodSelector))}});var FormField=new Class({Extends:DataElement,options:{componentName:"FormField",labelSelector:"label"},initialize:function(d,a,c,b){this.parent(d,a,c,b);this.elementFactory;this.label;this.labelElement;this.valueElement},construct:function(a,b){this.parent(a,b)},destroy:function(){this.parent()},unmarshall:function(){this.unmarshallProperties();this.parent()},getElementFactory:function(){return this.elementFactory},getLabel:function(){return this.label},getLabelElement:function(){return this.labelElement},getValueElement:function(){return this.valueElement},associateEditor:function(){if(this.isEditable()){this.editor=DocumentElementEditorFactory.create(this,{});this.editor.attach()}this.constructionChain.callChain()}.protect(),createHtmlElement:function(){this.htmlElement=this.elementFactory.createStaticRow(this.label,this.text,this.id,this.contextElement,WidgetElementFactory.Positions.LastChild);this.labelElement=this.htmlElement.getChildren("label")[0];this.valueElement=this.htmlElement.getChildren("span")[0];this.constructionChain.callChain()},unmarshallProperties:function(){this.label=this.resourceBundle.getText(XmlResource.determineAttributeValue(this.definitionElement,this.options.labelSelector))}});var MissingBindVariableException=new Class({Extends:WebUIException,options:{description:"Data element's: '{dataElementId}' 'bind' property doesn't contains any variables.",name:"MissingBindVariableException"},initialize:function(a,b){this.setOptions(b);this.parent(b);this.parameters={dataElementId:a}}});var SmartDocument=new Class({Extends:AbstractDocument,Binds:["constructBody","constructFooter","constructHeader","destroyHeaderBodyAndFooter","determineContainerElement","loadResources","onBodyConstructed","onConstructionError","onFooterConstructed","onHeaderConstructed","onResourceError","onResourcesLoaded"],options:{componentName:"SmartDocument",bodySelector:"documentBody",footerSelector:"documentFooter",headerSelector:"documentHeader",rootElementName:"/smartDocumentDefinition"},initialize:function(b,a){this.parent(b,a);this.documentBody=null;this.documentFooter=null;this.documentHeader=null},construct:function(){this.parent()},destroy:function(){this.parent()},onBodyConstructed:function(){this.constructionChain.callChain()},onFooterConstructed:function(){this.state=AbstractDocument.States.CONSTRUCTED;this.constructionChain.callChain()},onHeaderConstructed:function(){this.constructionChain.callChain()},unmarshall:function(){this.documentHeader=this.unmarshallDocumentComponent(this.options.rootElementName+"/"+this.options.headerSelector,{onConstructed:this.onHeaderConstructed,onConstructionError:this.onConstructionError});this.documentBody=this.unmarshallDocumentComponent(this.options.rootElementName+"/"+this.options.bodySelector,{onConstructed:this.onBodyConstructed,onConstructionError:this.onConstructionError});this.documentFooter=this.unmarshallDocumentComponent(this.options.rootElementName+"/"+this.options.footerSelector,{onConstructed:this.onFooterConstructed,onConstructionError:this.onConstructionError});this.parent()},getBody:function(){return this.documentBody},getFooter:function(){return this.documentFooter},getHeader:function(){return this.documentHeader},compileConstructionChain:function(){this.constructionChain.chain(this.determineContainerElement,this.loadResources,this.constructHeader,this.constructBody,this.constructFooter,this.finalizeConstruction)}.protect(),compileDestructionChain:function(){this.destructionChain.chain(this.destroyHeaderBodyAndFooter,this.releseResource,this.detachEditor,this.resetProperties,this.finalizeDestruction)}.protect(),constructBody:function(){if(this.documentBody){this.documentBody.construct(this.containerElement,"bottom")}else{this.constructionChain.callChain()}}.protect(),constructFooter:function(){if(this.documentFooter){this.documentFooter.construct(this.containerElement,"bottom")}else{this.constructionChain.callChain()}}.protect(),constructHeader:function(){if(this.documentHeader){this.documentHeader.construct(this.containerElement,"bottom")}else{this.constructionChain.callChain()}}.protect(),destroyHeaderBodyAndFooter:function(){if(this.documentHeader){this.documentHeader.destroy()}if(this.documentBody){this.documentBody.destroy()}if(this.documentFooter){this.documentFooter.destroy()}this.destructionChain.callChain()}.protect(),resetProperties:function(){this.documentHeader=null;this.documentBody=null;this.documentFooter=null;this.parent()}.protect(),revertConstruction:function(){if(this.resources){this.resources.release()}if(this.documentHeader){this.documentHeader.destroy()}if(this.documentBody){this.documentBody.destroy()}if(this.documentFooter){this.documentFooter.destroy()}this.parent()}.protect(),unmarshallDocumentComponent:function(a,b){var d=null;var c=this.documentDefinition.selectNode(a);if(c){d=DocumentElementFactory.create(c,this.i18Resource,this.documentContent,b)}if(d){d.unmarshall()}return d}.protect()});var UnconfiguredDocumentElementException=new Class({Extends:WebUIException,options:{description:"When calling method: '{methodName}' of a DocumentElement it should be in: '{statusName}' .",name:"UnconfiguredDocumentElementException"},initialize:function(b,a,c){this.setOptions(c);this.parent(c);this.parameters={methodName:b,statusName:a}}});var SplashForm=new Class({Implements:[Events,Options],Binds:["constructForm","finalizeConstruction","onImageLoaded","onImageLoadError","preloadImage"],options:{componentName:"SplashForm",containerElementId:"splashForm",imageId:"splashFormImage",imageTitle:"Splashform Image",imageUri:"Desktops/Images/SplashForm.png"},initialize:function(a){this.setOptions(a);this.constructionChain=new Chain();this.containerElement=$(this.options.containerElementId);this.imageElement;this.splashFormElement},construct:function(){this.constructionChain.chain(this.preloadImage,this.constructForm,this.finalizeConstruction);this.constructionChain.callChain()},destroy:function(){this.destroyElement(this.imageElement);this.destroyElement(this.splashFormElement)},onImageLoaded:function(){this.constructionChain.callChain()},onImageLoadError:function(a){this.error=a;this.fireEvent("error",a);this.destroy()},getContainerElement:function(){return this.containerElement},getImageElement:function(){return this.imageElement},getSplashFormElement:function(){return this.splashFormElement},constructForm:function(){this.splashFormElement=new Element("div",{id:"splashForm",styles:{left:"50%",position:"absolute",visibility:"hidden",top:"50%",zIndex:"999"}});this.containerElement.grab(this.splashFormElement,"top");this.splashFormElement.grab(this.imageElement);this.splashFormElement.setStyle("margin-left",-(this.splashFormElement.getStyle("width").toInt()/2));this.splashFormElement.setStyle("margin-top",-(this.splashFormElement.getStyle("height").toInt()/2));this.splashFormElement.setStyle("visibility","visible");this.constructionChain.callChain()}.protect(),destroyElement:function(a){if(a){if(a.removeEvents){a.removeEvents()}if(a.destroy){a.destroy()}}}.protect(),finalizeConstruction:function(){this.constructionChain.clearChain();this.fireEvent("constructed",this)}.protect(),preloadImage:function(){this.imageElement=Asset.image(this.options.imageUri,{id:this.options.imageId,title:this.options.imageTitle,onAbort:function(){this.onImageLoadError()}.bind(this),onError:function(){this.onImageLoadError()}.bind(this),onLoad:function(){this.onImageLoaded()}.bind(this)})}.protect()});var DuplicatedTabException=new Class({Extends:WebUIException,options:{description:"Tab name violates uniquness constraint.",name:"DuplicatedTabException",tabName:null},initialize:function(a){this.setOptions(a);this.parent(a)},getTabName:function(){return this.options.tabName}});var Tab=new Class({Implements:[Events,Options],Binds:["onSelection"],options:{caption:null,captionSelector:"@caption",componentName:"Tab",currentTabId:"current",id:null,idPrefix:"tab_",idSelector:"@tabId",isDefaultSelector:"@isDefault",messagePropertiesSelector:"messageProperties",tabsStyle:"Tabs"},initialize:function(b,c,a){assertThat(c,not(nil()));this.setOptions(a);this.active=false;this.anchorElement;this.caption=this.options.caption?c.getText(this.options.caption):null;this.defaultTab;this.definitionElement=b;this.id=this.options.id;this.internationalization=c;this.listItemElement;this.logger=Class.getInstanceOf(WebUILogger);this.messageProperties;this.visible=false},activate:function(){if(this.isVisible()){this.active=true;this.setListItemId(this.options.currentTabId)}},changeCaption:function(a){this.caption=a.getText(this.id);if(this.anchorElement!=null&&this.anchorText!=null){this.anchorElement.removeChild(this.anchorText);var b=caption.replace(/ /g,String.fromCharCode(160));this.anchorText=document.createTextNode(b);this.anchorElement.appendChild(this.anchorText)}},construct:function(a){assertThat(a,not(nil()));this.createHtmlElements(a);this.visible=true},deActivate:function(){if(this.isVisible()){this.active=false;this.setListItemId("")}},destroy:function(){if(this.isVisible()){this.removeLIElement()}this.visible=false;this.active=false},equals:function(a){if(!instanceOf(a,Tab)){return false}return this.id.equals(a.id)},onSelection:function(){this.activate();this.fireEvent("tabSelected",this)},unmarshall:function(){this.unmarshallProperties()},getCaption:function(){return this.caption},getId:function(){return this.id},getMessageProperties:function(){return this.messageProperties},isActive:function(){return this.active},isDefault:function(){return this.defaultTab},isVisible:function(){return this.visible},createHtmlElements:function(a){var b=this.caption.replace(/ /g,String.fromCharCode(160));this.anchorElement=new Element("a",{id:this.id,href:"#",events:{click:this.onSelection}});this.anchorElement.appendText(b);this.listItemElement=new Element("li");this.listItemElement.appendChild(this.anchorElement);a.grab(this.listItemElement,"bottom");this.logger.trace(this.options.componentName+".createHtmlElements added a 'LI' element to represent tab: "+this.id)}.protect(),removeLIElement:function(){if(this.listItemElement!=null){if(this.anchorElement.destroy){this.anchorElement.removeEvents();this.anchorElement.destroy()}else{this.anchorElement.removeNode()}this.anchorElement=null;if(this.listItemElement.destroy){this.listItemElement.destroy()}else{this.listItemElement.removeNode()}this.listItemElement=null}else{throw new UnconfiguredWidgetException({message:"Can't remove tab's parent LI element.",source:"Tab.removeLIElement"})}}.protect(),setListItemId:function(a){if(this.listItemElement!=null){this.listItemElement.set("id",a)}else{throw new UnconfiguredWidgetException({message:"Can't set undefined LI element's id.",source:"Tab.setListItemId"})}}.protect(),unmarshallProperties:function(){this.id=this.options.idPrefix+XmlResource.selectNodeText(this.options.idSelector,this.definitionElement);this.caption=this.internationalization.getText(XmlResource.selectNodeText(this.options.captionSelector,this.definitionElement));this.defaultTab=parseBoolean(XmlResource.selectNodeText(this.options.isDefaultSelector,this.definitionElement,null,false));this.messageProperties=XmlResource.selectNodeText(this.options.messagePropertiesSelector,this.definitionElement)}.protect()});var TabSelectedMessage=new Class({Extends:WebUIMessage,options:{actionType:null,contextItemId:null,description:"A message about the event that a tab was selected.",documentContentURI:null,documentType:AbstractDocument.Types.SMART,documentURI:null,name:"TabSelectedMessage",tabId:null},initialize:function(a){this.setOptions(a);this.options.messageClass=TabSelectedMessage},getActionType:function(){return this.options.actionType},getActivityType:function(){return this.options.activityType},getContextItemId:function(){return this.options.contextItemId},getDocumentContentURI:function(){return this.options.documentContentURI},getDocumentType:function(){return this.options.documentType},getDocumentURI:function(){return this.options.documentURI},getId:function(){return this.options.tabId}});var TabWidget=new Class({Extends:BrowserWidget,Binds:["onClose","onTabSelected"],options:{TAB_LIST_STYLE:"Tabs",TAB_WIDGET_STYLE:"TabWidgetWrapper",BUTTONCLASSNAME:"Buttons",backgroundImage:"Images/bg.gif",buttonPrefix:"button_",closeButtonCaptionKey:"TabWidget.Close",componentName:"TabWidget",idDefault:"TabWidget",idSelector:"/pp:tabWidgetDefinition/tabWidget/@tabWidgetId",printButtonCaptionKey:"TabWidget.Print",selectedTabClassDefault:"selectedTab",selectedTabClassSelector:"/pp:tabWidgetDefinition/tabWidget/@selectedTabClass",showCloseButtonDefault:false,showCloseButtonSelector:"/pp:tabWidgetDefinition/tabWidget/@showCloseButton",showPrintButtonDefault:false,showPrintButtonSelector:"/pp:tabWidgetDefinition/tabWidget/@showPrintButton",tabCaptionSelector:"@caption",tabDefinitionSelector:"/pp:tabWidgetDefinition/tabWidget/tab",tabIdSelector:"@tabId",tabIsDefaultSelector:"@isDefault",tabLeftImage:"Images/DocumentTab-Left.gif",tabRightImage:"Images/DocumentTab-Right.gif",tabLeftOnImage:"Images/DocumentTab-Left-Selected.gif",tabRightOnImage:"Images/DocumentTab-Right-Selected.gif",tabsSelector:"tab",widgetContainerId:"TabWidget",widgetDefinitionSelector:"/pp:tabWidgetDefinition/tabWidget",widgetDefinitionURI:"TabsDefinition.xml"},initialize:function(a,b){this.setOptions(a);this.parent(a,b);this.activeTab=null;this.buttonsListElement;this.id;this.isVisible=false;this.selectedTabClass;this.showCloseButton;this.showPrintButton;this.tabListElement;this.tabs=new LinkedHashMap();this.tabsWrapperElement},activateTab:function(a){if(this.activeTab!=null){this.activeTab.deActivate()}var b=this.tabs.get(a);b.activate();this.activeTab=b;this.storeComponentState();this.notifySubscribers()},addTab:function(d,a,c){if(this.state<=BrowserWidget.States.INITIALIZED){throw new UnconfiguredWidgetException()}if(this.tabs.get(d)!=null){throw new DuplicatedTabException({tabName:d})}var b=new Tab(null,this.i18Resource,{id:d,caption:a,onTabSelected:this.onTabSelected});this.tabs.put(b.getId(),b);if(this.state==BrowserWidget.States.CONSTRUCTED){b.construct(this.tabListElement)}if(c==null||(c!=null&&c==false)){this.activateTab(d)}},changeCaptions:function(a){tabs.moveFirst();var b;while(b=tabs.getNext()){if(b.changeCaption!=null){b.changeCaption(a)}}},construct:function(){if(this.isVisible){return}this.createHtmlElements();this.constructTabs();this.constructButtons();this.isVisible=true;this.parent();this.activateDefaultTab()},destroy:function(){if(this.tabListElement){this.tabs.each(function(b,a){b.getValue().destroy()},this);if(this.tabListElement.destroy){this.tabListElement.removeEvents();this.tabListElement.destroy()}else{this.tabListElement.removeNode()}}if(this.tabsWrapperElement&&this.tabsWrapperElement.destroy){this.tabsWrapperElement.destroy()}if(this.buttonsListElement){if(this.buttonsListElement.destroy){this.buttonsListElement.removeEvents();this.buttonsListElement.destroy()}else{this.buttonsListElement.removeNode()}}this.parent()},moveFirstToLast:function(){var a=null;if(htmlDivElement!=null){var d=htmlDivElement.getElementsByTagName("ul");for(var b=0;b<d.length;b++){if(d[b].className==TAB_LIST_STYLE){a=d[b]}}}if(a==null){return}var c=a.firstChild;if(c!=null){a.appendChild(c)}},moveLastToFirst:function(){var a=null;if(htmlDivElement!=null){var e=htmlDivElement.getElementsByTagName("ul");for(var b=0;b<e.length;b++){if(e[b].className==TAB_LIST_STYLE){a=e[b]}}}if(a==null){return}var d=a.firstChild;if(d!=null){var c=a.lastChild;if(d!=c){a.insertBefore(c,d)}}},onClose:function(){if(this.activeTab){this.removeTab(this.activeTab.getId())}},onPrint:function(){},onTabSelected:function(a){if(!a.getId().equals(this.activeTab.getId())){this.activateTab(a.getId())}},removeAllTabs:function(){this.tabs.each(function(c,a){var b=c.getValue();b.destroy()},this);this.tabs.clear();this.activeTab=null},removeTab:function(b){if(this.state<=BrowserWidget.States.INITIALIZED){throw new UnconfiguredWidgetException()}var a=this.tabs.next(this.activeTab.getId());var c=this.tabs.previous(this.activeTab.getId());if(a!=null&&!a.getId().equals(b)){this.activateTab(a.getId())}else{if(c!=null&&!c.getId().equals(b)){this.activateTab(c.getId())}}this.tabs.get(b).destroy();this.tabs.remove(b);if(this.tabs.size()==0){this.activeTab=null}},unmarshall:function(){this.unmarshallProperties();this.unmarshallTabs();this.parent()},activeTabId:function(){return(tabs.getCountOfObjects()>0?activeTab.getId():"undefined")},getActiveTab:function(){return this.activeTab},getCloseButtonId:function(){return this.options.buttonPrefix+this.options.closeButtonCaptionKey},getId:function(){return this.id},getPrintButtonId:function(){return this.options.buttonPrefix+this.options.printButtonCaptionKey},getSelectedTabClass:function(){return this.selectedTabClass},getShowCloseButton:function(){return this.showCloseButton},getShowPrintButton:function(){return this.showPrintButton},getTabById:function(a){return this.tabs.get(a)},getTabCount:function(){return this.tabs.size()},getTabExist:function(a){return tabs.exists(a)},getTabs:function(){return this.tabs},isCloseButtonVisible:function(){return this.showCloseButton},isPrintButtonVisible:function(){return this.showPrintButton},setCloseButtonVisibility:function(a){this.options.showCloseButton=a},setPrintButtonVisibility:function(a){this.options.showPrintButton=a},setBackgroundImage:function(a){backgroundImage=(a==null?backgroundImage:a)},setTabLefImage:function(a){tabLeftImage=(a==null?tabLeftImage:a)},setTabRightImage:function(a){tabRightImage=(a==null?tabRightImage:a)},setTabLeftOnImage:function(a){tabLeftOnImage=(a==null?tabLeftOnImage:a)},setTabRightOnImage:function(a){tabRightOnImage=(a==null?tabRightOnImage:a)},activateDefaultTab:function(){if(this.activeTab){this.activateTab(this.activeTab.getId())}else{this.activateTab(this.tabs.get(this.tabs.firstKey()).getId())}}.protect(),compileStateSpecification:function(){this.stateSpecification={currentTabId:this.activeTab.getId()}}.protect(),constructButtons:function(){if(this.showCloseButton||this.showPrintButton){this.buttonsListElement=this.elementFactory.create("ul",null,null,null,{"class":this.options.BUTTONCLASSNAME});if(this.showCloseButton){this.createButton(this.options.closeButtonCaptionKey,this.onClose)}if(this.showPrintButton){this.createButton(this.options.printButtonCaptionKey,this.onPrint)}}}.protect(),constructTabs:function(){this.tabs.each(function(b,a){var c=b.getValue();c.construct(this.tabListElement)},this)}.protect(),createButton:function(a,c){var d=this.elementFactory.create("li",null,this.buttonsListElement,WidgetElementFactory.Positions.LastChild);var b={href:"#",id:this.options.buttonPrefix+a};this.elementFactory.createAnchor(a.replace(/ /g,String.fromCharCode(160)),null,c,d,WidgetElementFactory.Positions.LastChild,b)}.protect(),createHtmlElements:function(){this.tabsWrapperElement=this.elementFactory.create("div",null,null,null,{"class":this.options.TAB_WIDGET_STYLE});this.tabListElement=this.elementFactory.create("ul",null,this.tabsWrapperElement,null,{"class":this.options.TAB_LIST_STYLE})}.protect(),hideButtons:function(){if(htmlDivElement!=null){var c=htmlDivElement.getElementsByTagName("ul");for(var b=0;b<c.length;b++){if(c[b].className==BUTTONCLASSNAME){var a=c[b];htmlDivElement.removeChild(a)}}}else{throw new UserException("Division not defined","TabWidget._RemoveUnorderedListTag()")}}.protect(),notifySubscribers:function(){var argumentText=this.activeTab.getMessageProperties();var arguments=argumentText!=null?eval("("+argumentText+")"):{};arguments.originator=this.options.componentName;arguments.tabId=this.activeTab.getId();var tabSelectedMessage=new TabSelectedMessage(arguments);this.messageBus.notifySubscribers(tabSelectedMessage)}.protect(),parseStateSpecification:function(){if(this.stateSpecification){this.currentItemId=this.stateSpecification.currentTabId}}.protect(),removeUnorderedListTag:function(){if(htmlDivElement!=null){var c=htmlDivElement.getElementsByTagName("ul");for(var b=0;b<c.length;b++){if(c[b].className==this.options.TAB_LIST_STYLE){var a=c[b];htmlDivElement.removeChild(a)}}}else{throw new UserException("Division not defined","TabWidget._RemoveUnorderedListTag()")}}.protect(),saveComponentState:function(b){var d="";if(this.activeTab!=null){d=d+b+this.activeTab.caption}else{d=d+b+"null"}for(var c=1;c<=this.tabs.getCountOfObjects();c++){var a=this.tabs.getItemByIndex(c-1);d=d+b+a.caption+b+a.state+b+a.id}return d}.protect(),unmarshallProperties:function(){this.id=this.definitionXml.selectNodeText(this.options.idSelector,null,this.options.idDefault);this.selectedTabClass=this.definitionXml.selectNodeText(this.options.selectedTabClassSelector,null,this.options.selectedTabClassDefault);this.showCloseButton=parseBoolean(this.definitionXml.selectNodeText(this.options.showCloseButtonSelector,null,this.options.showCloseButtonDefault));this.showPrintButton=parseBoolean(this.definitionXml.selectNodeText(this.options.showCloseButtonSelector,null,this.options.showCloseButtonDefault))}.protect(),unmarshallTabs:function(){var a=this.definitionXml.selectNodes(this.options.tabDefinitionSelector);a.each(function(d,b){var c=new Tab(d,this.i18Resource,{onTabSelected:this.onTabSelected});c.unmarshall();this.tabs.put(c.getId(),c);if(c.isDefault()){this.activeTab=c}},this)}.protect(),});var MooEditableDialog=new Class({Implements:[Options],Binds:["open"],options:{action:null,componentName:"MooEditableDialog",notification:null,windowName:null},initialize:function(b,a){this.setOptions(a);this.editor=b;this.name},open:function(){switch(this.options.action){case DesktopWindow.Activity.SHOW_NOTIFICATION:this.editor.showNotification(this.options.notification);break;case DesktopWindow.Activity.SHOW_WINDOW:this.editor.showWindow(this.options.windowName);break}},prompt:function(){this.editor.showNotification(this.options.windowName)},isCollapsed:function(){return false},});var WebUIConfiguration=new Class({Implements:[Class.Singleton,Options],options:{appenderBatchSizeSelector:"wui:appenders/wui:ajaxAppender[@name='{appenderName}']/@batchSize | wui:appenders/wui:popUpAppender[@name='{appenderName}']/@batchSize | wui:appenders/wui:inPageAppender[@name='{appenderName}']/@batchSize | wui:appenders/wui:browserConsoleAppender[@name='{appenderName}']/@batchSize",appenderCommandLineObjectExpansionDepthSelector:"wui:appenders/wui:ajaxAppender[@name='{appenderName}']/@commandLineObjectExpansionDepth | wui:appenders/wui:popUpAppender[@name='{appenderName}']/@commandLineObjectExpansionDepth | wui:appenders/wui:inPageAppender[@name='{appenderName}']/@commandLineObjectExpansionDepth | wui:appenders/wui:browserConsoleAppender[@name='{appenderName}']/@commandLineObjectExpansionDepth",appenderComplainAboutPopUpBlockingSelector:"wui:appenders/wui:ajaxAppender[@name='{appenderName}']/@complainAboutPopUpBlocking | wui:appenders/wui:popUpAppender[@name='{appenderName}']/@complainAboutPopUpBlocking | wui:appenders/wui:inPageAppender[@name='{appenderName}']/@complainAboutPopUpBlocking | wui:appenders/wui:browserConsoleAppender[@name='{appenderName}']/@complainAboutPopUpBlocking",appenderContainerElementIdSelector:"wui:appenders/wui:ajaxAppender[@name='{appenderName}']/@containerElementId | wui:appenders/wui:popUpAppender[@name='{appenderName}']/@containerElementId | wui:appenders/wui:inPageAppender[@name='{appenderName}']/@containerElementId | wui:appenders/wui:browserConsoleAppender[@name='{appenderName}']/@containerElementId",appenderFailCallbackSelector:"wui:appenders/wui:ajaxAppender[@name='{appenderName}']/@failCallback | wui:appenders/wui:popUpAppender[@name='{appenderName}']/@failCallback | wui:appenders/wui:inPageAppender[@name='{appenderName}']/@failCallback | wui:appenders/wui:browserConsoleAppender[@name='{appenderName}']/@failCallback",appenderFocusPopUpSelector:"wui:appenders/wui:ajaxAppender[@name='{appenderName}']/@focusPopUp | wui:appenders/wui:popUpAppender[@name='{appenderName}']/@focusPopUp | wui:appenders/wui:inPageAppender[@name='{appenderName}']/@focusPopUp | wui:appenders/wui:browserConsoleAppender[@name='{appenderName}']/@focusPopUp",appenderHeightSelector:"wui:appenders/wui:ajaxAppender[@name='{appenderName}']/@height | wui:appenders/wui:popUpAppender[@name='{appenderName}']/@height | wui:appenders/wui:inPageAppender[@name='{appenderName}']/@height | wui:appenders/wui:browserConsoleAppender[@name='{appenderName}']/@height",appenderInitiallyMinimizedSelector:"wui:appenders/wui:ajaxAppender[@name='{appenderName}']/@initiallyMinimized | wui:appenders/wui:popUpAppender[@name='{appenderName}']/@initiallyMinimized | wui:appenders/wui:inPageAppender[@name='{appenderName}']/@initiallyMinimized | wui:appenders/wui:browserConsoleAppender[@name='{appenderName}']/@initiallyMinimized",appenderLayoutSelector:"wui:appenders/wui:ajaxAppender[@name='{appenderName}']/@layoutReference | wui:appenders/wui:popUpAppender[@name='{appenderName}']/@layoutReference | wui:appenders/wui:inPageAppender[@name='{appenderName}']/@layoutReference | wui:appenders/wui:browserConsoleAppender[@name='{appenderName}']/@layoutReference",appenderLazyInitSelector:"wui:appenders/wui:ajaxAppender[@name='{appenderName}']/@lazyInit | wui:appenders/wui:popUpAppender[@name='{appenderName}']/@lazyInit | wui:appenders/wui:inPageAppender[@name='{appenderName}']/@lazyInit | wui:appenders/wui:browserConsoleAppender[@name='{appenderName}']/@lazyInit",appenderMaxMessagesSelector:"wui:appenders/wui:ajaxAppender[@name='{appenderName}']/@maxMessages | wui:appenders/wui:popUpAppender[@name='{appenderName}']/@maxMessages | wui:appenders/wui:inPageAppender[@name='{appenderName}']/@maxMessages | wui:appenders/wui:browserConsoleAppender[@name='{appenderName}']/@maxMessages",appenderNameSelector:"@name",appenderNewestMessageAtTopSelector:"wui:appenders/wui:ajaxAppender[@name='{appenderName}']/@newestMessageAtTop | wui:appenders/wui:popUpAppender[@name='{appenderName}']/@newestMessageAtTop | wui:appenders/wui:inPageAppender[@name='{appenderName}']/@newestMessageAtTop | wui:appenders/wui:browserConsoleAppender[@name='{appenderName}']/@newestMessageAtTop",appenderPostVariableNameSelector:"wui:appenders/wui:ajaxAppender[@name='{appenderName}']/@postVariableName | wui:appenders/wui:popUpAppender[@name='{appenderName}']/@postVariableName | wui:appenders/wui:inPageAppender[@name='{appenderName}']/@postVariableName | wui:appenders/wui:browserConsoleAppender[@name='{appenderName}']/@postVariableName",appenderReopenWhenClosedSelector:"wui:appenders/wui:ajaxAppender[@name='{appenderName}']/@reopenWhenClosed | wui:appenders/wui:popUpAppender[@name='{appenderName}']/@reopenWhenClosed | wui:appenders/wui:inPageAppender[@name='{appenderName}']/@reopenWhenClosed | wui:appenders/wui:browserConsoleAppender[@name='{appenderName}']/@reopenWhenClosed",appenderRequestSuccessCallbackSelector:"wui:appenders/wui:ajaxAppender[@name='{appenderName}']/@requestSuccessCallback | wui:appenders/wui:popUpAppender[@name='{appenderName}']/@requestSuccessCallback | wui:appenders/wui:inPageAppender[@name='{appenderName}']/@requestSuccessCallback | wui:appenders/wui:browserConsoleAppender[@name='{appenderName}']/@requestSuccessCallback",appenderScrollToLatestMessageSelector:"wui:appenders/wui:ajaxAppender[@name='{appenderName}']/@scrollToLatestMessage | wui:appenders/wui:popUpAppender[@name='{appenderName}']/@scrollToLatestMessage | wui:appenders/wui:inPageAppender[@name='{appenderName}']/@scrollToLatestMessage | wui:appenders/wui:browserConsoleAppender[@name='{appenderName}']/@scrollToLatestMessage",appenderShowCommandLineSelector:"wui:appenders/ajaxAppender[@name='{appenderName}']/@showCommandLine | wui:appenders/wui:popUpAppender[@name='{appenderName}']/@showCommandLine | wui:appenders/wui:inPageAppender[@name='{appenderName}']/@showCommandLine | wui:appenders/wui:browserConsoleAppender[@name='{appenderName}']/@showCommandLine",appenderSendAllOnUnloadSelector:"wui:appenders/wui:ajaxAppender[@name='{appenderName}']/@sendAllOnUnload | wui:appenders/wui:popUpAppender[@name='{appenderName}']/@sendAllOnUnload | wui:appenders/wui:inPageAppender[@name='{appenderName}']/@sendAllOnUnload | wui:appenders/wui:browserConsoleAppender[@name='{appenderName}']/@sendAllOnUnload",appenderTimedSendingSelector:"wui:appenders/wui:ajaxAppender[@name='{appenderName}']/@timedSending | wui:appenders/wui:popUpAppender[@name='{appenderName}']/@timedSending | wui:appenders/wui:inPageAppender[@name='{appenderName}']/@timedSending | wui:appenders/wui:browserConsoleAppender[@name='{appenderName}']/@timedSending",appenderTimerIntervalSelector:"wui:appenders/wui:ajaxAppender[@name='{appenderName}']/@timerInterval | wui:appenders/wui:popUpAppender[@name='{appenderName}']/@timerInterval | wui:appenders/wui:inPageAppender[@name='{appenderName}']/@timerInterval | wui:appenders/wui:browserConsoleAppender[@name='{appenderName}']/@timerInterval",appenderThresholdSelector:"wui:appenders/wui:ajaxAppender[@name='{appenderName}']/@threshold | wui:appenders/wui:popUpAppender[@name='{appenderName}']/@threshold | wui:appenders/wui:inPageAppender[@name='{appenderName}']/@threshold | wui:appenders/wui:browserConsoleAppender[@name='{appenderName}']/@threshold",appenderTypeSelector:"wui:appenders/wui:ajaxAppender[@name='{appenderName}'] | wui:appenders/wui:popUpAppender[@name='{appenderName}'] | wui:appenders/wui:inPageAppender[@name='{appenderName}'] | wui:appenders/wui:browserConsoleAppender[@name='{appenderName}']",appenderURLSelector:"wui:appenders/wui:ajaxAppender[@name='{appenderName}']/@url | wui:appenders/wui:popUpAppender[@name='{appenderName}']/@url | wui:appenders/wui:inPageAppender[@name='{appenderName}']/@url | wui:appenders/wui:browserConsoleAppender[@name='{appenderName}']/@url",appenderUseDocumentWriteSelector:"wui:appenders/wui:ajaxAppender[@name='{appenderName}']/@useDocumentWrite | wui:appenders/wui:popUpAppender[@name='{appenderName}']/@useDocumentWrite | wui:appenders/wui:inPageAppender[@name='{appenderName}']/@useDocumentWrite | wui:appenders/wui:browserConsoleAppender[@name='{appenderName}']/@useDocumentWrite",appenderUseOldPopUpSelector:"wui:appenders/wui:ajaxAppender[@name='{appenderName}']/@useOldPopUp | wui:appenders/wui:popUpAppender[@name='{appenderName}']/@useOldPopUp | wui:appenders/wui:inPageAppender[@name='{appenderName}']/@useOldPopUp | wui:appenders/wui:browserConsoleAppender[@name='{appenderName}']/@useOldPopUp",appenderWaitForResponseSelector:"wui:appenders/wui:ajaxAppender[@name='{appenderName}']/@waitForResponse | wui:appenders/wui:popUpAppender[@name='{appenderName}']/@waitForResponse | wui:appenders/wui:inPageAppender[@name='{appenderName}']/@waitForResponse | wui:appenders/wui:browserConsoleAppender[@name='{appenderName}']/@waitForResponse",appenderWidthSelector:"wui:appenders/wui:ajaxAppender[@name='{appenderName}']/@width | wui:appenders/wui:popUpAppender[@name='{appenderName}']/@width | wui:appenders/wui:inPageAppender[@name='{appenderName}']/@width | wui:appenders/wui:browserConsoleAppender[@name='{appenderName}']/@width",availableSkinElementsSelector:"wui:desktop/wui:availableSkins/wui:skin",defaultSkinSelector:"wui:desktop/wui:defaultSkin/@name",desktopConfigurationURISelector:"/pp:processPuzzleConfiguration/wui:webUI/wui:desktop/@configurationURI",i18DefaultLocaleSelector:"in:defaultLocale/text()",i18ElementSelector:"/pp:processPuzzleConfiguration/in:internationalization",i18LocaleSelector:"text()",i18LocaleElementsSelector:"in:availableLocales/in:locale",i18ResourceBundleElementsSelector:"in:resouceBundles/in:resourceBundle",i18ResourceBundleNameSelector:"text()",i18ResourceBundleNameSpaceSelector:"in:resouceBundles/@nameSpace",layoutElementsSelector:"wui:logging/wui:layouts/wui:patternLayout | wui:logging/wui:layouts/wui:xmlLayout",layoutNameSelector:"@name",layoutPatternSelector:"wui:layouts/wui:patternLayout[@name='{layoutName}']/@pattern | wui:layouts/wui:xmlLayout[@name='{layoutName}']/@pattern",loggerAppenderLayoutSelector:"wui:appender/@layout",loggerAppenderLevelSelector:"wui:appender/@level",loggerAppenderReferenceSelector:"wui:loggers/wui:logger[@name='{loggerName}']/wui:appenderReference/@name",loggerAppendersSelector:"wui:logging/wui:appenders/wui:ajaxAppender | wui:logging/wui:appenders/wui:popUpAppender | wui:logging/wui:appenders/wui:inPageAppender | wui:logging/wui:appenders/wui:browserConsoleAppender",loggerAppenderTypeSelector:"wui:appender/@type",loggerElementsSelector:"wui:logging/wui:loggers/wui:logger",loggerLayoutPatternSelector:"wui:layout/@pattern",loggerLayoutTypeSelector:"wui:layout/@type",loggerLevelSelector:"wui:loggers/wui:logger[@name='{loggerName}']/@level",loggerNameSelector:"@name",loggerIsDefaultSelector:"wui:loggers/wui:logger[@name='{loggerName}']/@isDefault",loggingSelector:"/pp:processPuzzleConfiguration/wui:webUI/wui:logging",menuDefinitionURISelector:"/pp:processPuzzleConfiguration/wui:webUI/wui:desktop/wui:menu/@definitionURI",nameSpaces:"xmlns:pp='http://www.processpuzzle.com' xmlns:ac='http://www.processpuzzle.com/ApplicationConfiguration' xmlns:bc='http://www.processpuzzle.com/BeanContainerConfiguration' xmlns:bd='http://www.processpuzzle.com/BusinessDefinitionsConfiguration' xmlns:bi='http://www.processpuzzle.com/BusinessImplementationsConfiguration' xmlns:dl='http://www.processpuzzle.com/DataLoadersConfiguration' xmlns:em='http://www.processpuzzle.com/EmailConfiguration' xmlns:fc='http://www.processpuzzle.com/FrontControllerConfiguration' xmlns:in='http://www.processpuzzle.com/InternationalizationConfiguration' xmlns:pr='http://www.processpuzzle.com/PersistenceConfiguration' xmlns:rt='http://www.processpuzzle.com/RuntimeConfiguration' xmlns:wui='http://www.processpuzzle.com/WebUIConfiguration'",resourceBundleNameSpaceSelector:"xmlns:pp='http://www.processpuzzle.com'",skinConfigurationSelector:"wui:desktop/wui:availableSkins/wui:skin[@name='{skinName}']/@configurationURI",skinNameAttributeSelector:"@name",skinPathSelector:"wui:desktop/wui:availableSkins/wui:skin[@name='{skinName}']/@relativePath",skinPathAttributeSelector:"@relativePath",webUIElementSelector:"/pp:processPuzzleConfiguration/wui:webUI"},initialize:function(a,b){return this.check()||this.setUp(a,b)},setUp:function(a,b){this.setOptions(b);this.availableLocales=new ArrayList();this.configurationURI=a;this.i18Element=null;this.isLoaded=false;this.loggingElement=null;this.xmlResource=null;this.webUIElement=null;this.load();this.determineAvailableLocales()},load:function(){if(this.isLoaded){this.release()}this.xmlResource=new XmlResource(this.configurationURI,{nameSpaces:this.options.nameSpaces});this.i18Element=this.xmlResource.selectNode(this.options.i18ElementSelector);this.loggingElement=this.xmlResource.selectNode(this.options.loggingSelector);this.webUIElement=this.xmlResource.selectNode(this.options.webUIElementSelector);this.isLoaded=true},release:function(){if(this.isLoaded){this.i18Element=null;this.loggingElement=null;this.xmlResource=null;this.webUIElement=null;this.isLoaded=false}},getAvailableLocales:function(){return this.availableLocales},getAvailableSkinElements:function(){return this.xmlResource.selectNodes(this.options.availableSkinElementsSelector,this.webUIElement)},getConfigurationElement:function(){return this.webUIElement},getDefaultSkin:function(){return this.xmlResource.selectNode(this.options.defaultSkinSelector,this.webUIElement).nodeValue},getI18DefaultLocale:function(){return this.xmlResource.selectNode(this.options.i18DefaultLocaleSelector,this.i18Element).nodeValue},getI18Element:function(){return this.i18Element},getI18Locale:function(a){return this.xmlResource.selectNode(this.options.i18LocaleSelector,this.getI18LocaleElements()[a]).nodeValue},getI18LocaleElements:function(){return this.xmlResource.selectNodes(this.options.i18LocaleElementsSelector,this.i18Element)},getI18ResourceBundleElements:function(){return this.xmlResource.selectNodes(this.options.i18ResourceBundleElementsSelector,this.i18Element)},getI18ResourceBundleName:function(a){return this.xmlResource.selectNode(this.options.i18ResourceBundleNameSelector,this.getI18ResourceBundleElements()[a]).nodeValue},getI18ResourceBundleNameSpace:function(){return this.xmlResource.selectNode(this.options.i18ResourceBundleNameSpaceSelector,this.i18Element).value},getLoggerAppenderElement:function(){return this.xmlResource.selectNode(this.options.loggerAppenderSelector,this.webUIElement)},getLoggerAppenderType:function(){return this.xmlResource.selectNode(this.options.loggerAppenderTypeSelector,this.loggingElement).value},getLoggerElements:function(){return this.xmlResource.selectNodes(this.options.loggerElementsSelector,this.webUIElement)},getLoggerLayoutElement:function(){return this.xmlResource.selectNode(this.options.loggerLayoutSelector,this.loggingElement)},getLoggerLayoutPattern:function(){return this.xmlResource.selectNode(this.options.loggerLayoutPatternSelector,this.loggingElement).value},getLoggerLayoutType:function(){return this.xmlResource.selectNode(this.options.loggerLayoutTypeSelector,this.loggingElement).value},getLoggerLevel:function(b){var a=this.options.loggerLevelSelector.substitute({loggerName:b});return this.xmlResource.selectNode(a,this.loggingElement).value},getLoggerName:function(b){var a=this.getLoggerElements();return this.xmlResource.selectNode(this.options.loggerNameSelector,a[b]).value},getLoggingAppenderBatchSize:function(b){var a=this.options.appenderBatchSizeSelector.substitute({appenderName:b});var c=this.xmlResource.selectNode(a,this.loggingElement);if(c){return c.value}else{return null}},getLoggingAppenderCommandLineObjectExpansionDepth:function(b){var a=this.options.appenderCommandLineObjectExpansionDepthSelector.substitute({appenderName:b});var c=this.xmlResource.selectNode(a,this.loggingElement);if(c){return c.value}else{return null}},getLoggingAppenderComplainAboutPopUpBlocking:function(a){return this.determineLoggingElementValue(this.options.appenderComplainAboutPopUpBlockingSelector.substitute({appenderName:a}))},getLoggingAppenderContainerElementId:function(a){return this.determineLoggingElementValue(this.options.appenderContainerElementIdSelector.substitute({appenderName:a}))},getLoggingAppenderElements:function(){return this.xmlResource.selectNodes(this.options.loggerAppendersSelector,this.webUIElement)},getLoggingAppenderFailCallback:function(b){var a=this.options.appenderFailCallbackSelector.substitute({appenderName:b});var c=this.xmlResource.selectNode(a,this.loggingElement);if(c){return c.value}else{return null}},getLoggingAppenderFocusPopUp:function(b){var a=this.options.appenderFocusPopUpSelector.substitute({appenderName:b});var c=this.xmlResource.selectNode(a,this.loggingElement);if(c){return c.value}else{return null}},getLoggingAppenderHeight:function(a){return parseInt(this.determineLoggingElementValue(this.options.appenderHeightSelector.substitute({appenderName:a})))},getLoggingAppenderInitiallyMinimized:function(b){var a=this.determineLoggingElementValue(this.options.appenderInitiallyMinimizedSelector.substitute({appenderName:b}));return new Boolean().parseBoolean(a)},getLoggingAppenderLazyInit:function(b){var a=this.options.appenderLazyInitSelector.substitute({appenderName:b});var c=this.xmlResource.selectNode(a,this.loggingElement);if(c){return c.value}else{return null}},getLoggingAppenderLayoutReference:function(b){var a=this.options.appenderLayoutSelector.substitute({appenderName:b});return this.xmlResource.selectNode(a,this.loggingElement).value},getLoggingAppenderMaxMessages:function(b){var a=this.options.appenderMaxMessagesSelector.substitute({appenderName:b});var c=this.xmlResource.selectNode(a,this.loggingElement);if(c){return c.value}else{return null}},getLoggingAppenderName:function(a){var b=this.getLoggingAppenderElements();return this.xmlResource.selectNode(this.options.appenderNameSelector,b[a]).value},getLoggingAppenderNewestMessageAtTop:function(b){var a=this.options.appenderNewestMessageAtTopSelector.substitute({appenderName:b});var c=this.xmlResource.selectNode(a,this.loggingElement);if(c){return c.value}else{return null}},getLoggingAppenderPostVariableName:function(b){var a=this.options.appenderPostVariableNameSelector.substitute({appenderName:b});var c=this.xmlResource.selectNode(a,this.loggingElement);if(c){return c.value}else{return null}},getLoggingAppenderReopenWhenClosed:function(b){var a=this.options.appenderReopenWhenClosedSelector.substitute({appenderName:b});var c=this.xmlResource.selectNode(a,this.loggingElement);if(c){return c.value}else{return null}},getLoggingAppenderRequestSuccessCallback:function(b){var a=this.options.appenderRequestSuccessCallbackSelector.substitute({appenderName:b});var c=this.xmlResource.selectNode(a,this.loggingElement);if(c){return c.value}else{return null}},getLoggingAppenderScrollToLatestMessage:function(b){var a=this.options.appenderScrollToLatestMessageSelector.substitute({appenderName:b});var c=this.xmlResource.selectNode(a,this.loggingElement);if(c){return c.value}else{return null}},getLoggingAppenderSendAllOnUnload:function(b){var a=this.options.appenderSendAllOnUnloadSelector.substitute({appenderName:b});var c=this.xmlResource.selectNode(a,this.loggingElement);if(c){return c.value}else{return null}},getLoggingAppenderShowCommandLine:function(b){var a=this.options.appenderShowCommandLineSelector.substitute({appenderName:b});var c=this.xmlResource.selectNode(a,this.loggingElement);if(c){return c.value}else{return null}},getLoggingAppenderThreshold:function(a){return this.determineLoggingElementValue(this.options.appenderThresholdSelector.substitute({appenderName:a}))},getLoggingAppenderTimedSending:function(b){var a=this.options.appenderTimedSendingSelector.substitute({appenderName:b});var c=this.xmlResource.selectNode(a,this.loggingElement);if(c){return c.value}else{return null}},getLoggingAppenderTimerInterval:function(b){var a=this.options.appenderTimerIntervalSelector.substitute({appenderName:b});var c=this.xmlResource.selectNode(a,this.loggingElement);if(c){return c.value}else{return null}},getLoggingAppenderType:function(b){var a=this.options.appenderTypeSelector.substitute({appenderName:b});var c=this.xmlResource.selectNode(a,this.loggingElement);if(c){return c.nodeName}else{return null}},getLoggingAppenderURL:function(b){var a=this.options.appenderURLSelector.substitute({appenderName:b});var c=this.xmlResource.selectNode(a,this.loggingElement);if(c){return c.value}else{return null}},getLoggingAppenderUseDocumentWrite:function(a){return this.determineLoggingElementValue(this.options.appenderUseDocumentWriteSelector.substitute({appenderName:a}))},getLoggingAppenderUseOldPopUp:function(b){var a=this.options.appenderUseOldPopUpSelector.substitute({appenderName:b});var c=this.xmlResource.selectNode(a,this.loggingElement);if(c){return c.value}else{return null}},getLoggingAppenderWaitForResponse:function(b){var a=this.options.appenderWaitForResponseSelector.substitute({appenderName:b});var c=this.xmlResource.selectNode(a,this.loggingElement);if(c){return c.value}else{return null}},getLoggingAppenderWidth:function(a){return parseInt(this.determineLoggingElementValue(this.options.appenderWidthSelector.substitute({appenderName:a})))},getLoggingLayoutName:function(a){var b=this.getLoggingLayoutElements();return this.xmlResource.selectNode(this.options.layoutNameSelector,b[a]).value},getLoggingLayoutElements:function(){return this.xmlResource.selectNodes(this.options.layoutElementsSelector,this.webUIElement)},getLoggingLayoutPattern:function(b){var a=this.options.layoutPatternSelector.substitute({layoutName:b});return this.xmlResource.selectNode(a,this.loggingElement).value},getLoggingLoggerAppenderReference:function(b){var a=this.options.loggerAppenderReferenceSelector.substitute({loggerName:b});return this.xmlResource.selectNode(a,this.loggingElement).value},getLoggingLoggerIsDefault:function(a){return this.determineLoggingElementValue(this.options.loggerIsDefaultSelector.substitute({loggerName:a}))},getMenuDefinitionURI:function(){return this.xmlResource.selectNode(this.options.menuDefinitionURISelector).nodeValue},getSkinConfiguration:function(a){var b=this.options.skinConfigurationSelector.substitute({skinName:a});return this.xmlResource.selectNode(b,this.webUIElement).value},getSkinNameByIndex:function(a){var b=this.getAvailableSkinElements();return this.xmlResource.selectNode(this.options.skinNameAttributeSelector,b[a]).value},getSkinPath:function(a){var b=this.options.skinPathSelector.substitute({skinName:a});return this.xmlResource.selectNode(b,this.webUIElement).value},getSkinPathByIndex:function(a){var b=this.getAvailableSkinElements();return this.xmlResource.selectNode(this.options.skinPathAttributeSelector,b[a]).value},isSupportedLocale:function(a){var b=false;this.availableLocales.each(function(c,d){if(a.equals(c)){b=true}}.bind(this));return b},determineAvailableLocales:function(){for(var b=0;b<this.getI18LocaleElements().length;b++){var c=this.getI18Locale(b);var a=new Locale();a.parse(c);this.availableLocales.add(a)}}.protect(),determineLoggingElementValue:function(a){var b=this.xmlResource.selectNode(a,this.loggingElement);if(b){return b.value}else{return null}}});SYSTEM_WINDOWS={ABOUT:"about",DOCUMENT_EXPLORER:"documentExplorer"};var TextAreaEditor=new Class({Extends:DocumentEditor,Binds:["onDocumentSelectedMessage","onEditorClick","onMooEditableAttach"],options:{componentName:"TextAreaEditor",createLinkAlert:"selectionNeeded",createLinkPromt:SYSTEM_WINDOWS.DOCUMENT_EXPLORER,dimensions:{x:500,y:100},numberOfColumns:120,numberOfRows:50,urlImagePromt:SYSTEM_WINDOWS.DOCUMENT_EXPLORER,},initialize:function(b,a){this.parent(b,a);this.initialContent;this.mooEditable},attach:function(b,a){this.initialContent=a;this.parent(b)},detach:function(){this.mooEditable.detach();this.parent()},onContainerResize:function(a){this.mooEditable.onContainerResize(a)},onDocumentSelectedMessage:function(a){this.mooEditable.execute("createlink",null,a.getDocumentURI())},onEditorClick:function(event,editor){var subjectElement=event.target;if(subjectElement.get("tag").toUpperCase()!="A"&&subjectElement.getParent().get("tag").toUpperCase()=="A"){subjectElement=subjectElement.getParent()}if(subjectElement.get("tag").toUpperCase()=="A"){if(subjectElement.get("onclick")){eval(subjectElement.get("onclick"))}else{if(subjectElement.get("href")){document.location.href=subjectElement.get("href")}}}},onMooEditableAttach:function(){this.attachChain.callChain()},textAddImage:function(){this.mooEditable.action("urlimage",[])},textAddLink:function(){this.mooEditable.action("createlink",[])},textAlignCenter:function(){this.mooEditable.action("justifycenter",[])},textAlignLeft:function(){this.mooEditable.action("justifyleft",[])},textAlignJustify:function(){this.mooEditable.action("justifyfull",[])},textAlignRight:function(){this.mooEditable.action("justifyright",[])},textBold:function(){this.mooEditable.action("bold",[])},textIndent:function(){this.mooEditable.action("indent",[])},textItalic:function(){this.mooEditable.action("italic",[])},textOrderedList:function(){this.mooEditable.action("insertorderedlist",[])},textOutdent:function(){this.mooEditable.action("outdent",[])},textRedo:function(){this.mooEditable.action("redo",[])},textRemoveLink:function(){this.mooEditable.action("unlink",[])},textStrikethrough:function(){this.mooEditable.action("strikethrough",[])},textToggleView:function(){this.mooEditable.action("toggleview",[])},textUnderline:function(){this.mooEditable.action("underline",[])},textUndo:function(){this.mooEditable.action("undo",[])},textUnorderedList:function(){this.mooEditable.action("insertunorderedlist",[])},getMooEditable:function(){return this.mooEditable},defineDialogWindows:function(){MooEditable.Actions.createlink.dialogs.alert=function(a){return new MooEditableDialog(this,{action:DesktopWindow.Activity.SHOW_NOTIFICATION,notification:this.options.createLinkAlert})}.bind(this);MooEditable.Actions.createlink.dialogs.prompt=function(a){return new MooEditableDialog(this,{action:DesktopWindow.Activity.SHOW_WINDOW,windowName:this.options.createLinkPromt})}.bind(this);MooEditable.Actions.urlimage.dialogs.prompt=function(a){return new MooEditableDialog(this,{action:DesktopWindow.Activity.SHOW_WINDOW,windowName:this.options.urlImagePromt})}.bind(this)}.protect(),instantiateTools:function(){this.defineDialogWindows();var a="";this.styleSheets.each(function(c,b){a+="<link rel='stylesheet' type='text/css' href='"+c+"'>"},this);this.mooEditable=new MooEditable(this.subjectElement,{externalCSS:a,handleDialogs:false,handleLabel:false,handleSubmit:false,onAttach:this.onMooEditableAttach,onEditorClick:this.onEditorClick,toolbar:false})}.protect(),});var ToolBarButton=new Class({Implements:[Events,Options],Binds:["onSelection"],options:{buttonStyle:"toolBarButton",captionSelector:"caption",iconImageSelector:"iconImage",messagePropertiesSelector:"messageProperties",nameSelector:"@name",showCaption:false,toolTipStyle:"toolBarToolTip"},initialize:function(c,a,b){this.setOptions(b);this.anchorElement;this.definitionXml=c;this.caption;this.factory=a;this.iconImageUri;this.imageElement;this.listItemElement;this.messageProperties;this.name=new Date().getTime();this.parentElement;this.spanElement;this.state=ToolBarButton.States.INITIALIZED;this.toolTipElement},construct:function(a){assertThat(a,not(nil()));this.parentElement=a;this.instantiateHtmlElements();this.state=ToolBarButton.States.CONSTRUCTED},destroy:function(){if(this.toolTipElement&&this.toolTipElement.destroy){this.toolTipElement.destroy()}if(this.imageElement&&this.imageElement.destroy){this.imageElement.destroy()}if(this.spanElement&&this.spanElement.destroy){this.spanElement.destroy()}if(this.anchorElement&&this.anchorElement.destroy){this.anchorElement.destroy()}if(this.listItemElement&&this.listItemElement.destroy){this.listItemElement.destroy()}this.state=ToolBarButton.States.INITIALIZED},onSelection:function(){this.fireEvent("onSelection",this)},unmarshall:function(){this.unmarshallProperties();this.state=ToolBarButton.States.UNMARSHALLED},getCaption:function(){return this.caption},getIconImage:function(){return this.iconImageUri},getMessageProperties:function(){return this.messageProperties},getName:function(){return this.name},getParentElement:function(){return this.parentElement},getState:function(){return this.state},instantiateHtmlElements:function(){var a=this.options.showCaption?this.caption:"";this.listItemElement=this.factory.create("li",null,this.parentElement,WidgetElementFactory.Positions.lastChild,{id:this.name});this.anchorElement=this.factory.createAnchor(a,null,this.onSelection,this.listItemElement,WidgetElementFactory.Positions.lastChild);this.spanElement=this.factory.create("span",null,this.anchorElement,WidgetElementFactory.Positions.lastChild,{"class":this.options.buttonStyle});this.imageElement=this.factory.create("img",null,this.spanElement,WidgetElementFactory.Positions.lastChild,{src:this.iconImageUri,alt:a});this.toolTipElement=this.factory.create("span",this.caption,this.anchorElement,WidgetElementFactory.Positions.lastChild,{"class":this.options.toolTipStyle})},unmarshallProperties:function(){this.caption=XmlResource.selectNodeText(this.options.captionSelector,this.definitionXml);this.iconImageUri=XmlResource.selectNodeText(this.options.iconImageSelector,this.definitionXml);this.messageProperties=XmlResource.selectNodeText(this.options.messagePropertiesSelector,this.definitionXml);this.name=XmlResource.selectNodeText(this.options.nameSelector,this.definitionXml)}.protect(),});ToolBarButton.States={UNINITIALIZED:0,INITIALIZED:1,UNMARSHALLED:2,CONSTRUCTED:3};var ToolBarButtonFactory=new Class({Implements:Options,options:{},initialize:function(){},create:function(d,c,a){var b;switch(d.tagName.toUpperCase()){case"DIVIDER":b=new ToolBarDivider(d,c,a);break;case"BUTTON":default:b=new ToolBarButton(d,c,a);break}return b}});ToolBarButtonFactory.create=function(e,d,b){var a=new ToolBarButtonFactory();var c=a.create(e,d,b);return c};var ToolBarDivider=new Class({Implements:Options,options:{dividerStyle:"toolBarDivider",iconImageSelector:"iconImage",dividerIconImageUri:"Desktops/Images/ToolboxDivider.jpg",namePrefix:"divider_"},initialize:function(c,a,b){this.setOptions(b);this.definitionXml=c;this.factory=a;this.dividerIconImageUri;this.imageElement;this.listItemElement;this.name=UniqueId.generate(this.options.namePrefix);this.parentElement;this.state=ToolBarButton.States.INITIALIZED;this.toolTipElement},construct:function(a){assertThat(a,not(nil()));this.parentElement=a;this.instantiateHtmlElements();this.state=ToolBarButton.States.CONSTRUCTED},destroy:function(){if(this.imageElement&&this.imageElement.destroy){this.imageElement.destroy()}if(this.spanElement&&this.spanElement.destroy){this.spanElement.destroy()}if(this.listItemElement&&this.listItemElement.destroy){this.listItemElement.destroy()}this.state=ToolBarButton.States.INITIALIZED},onSelection:function(){},unmarshall:function(){this.unmarshallProperties();this.state=ToolBarButton.States.UNMARSHALLED},getIconImage:function(){return this.dividerIconImageUri},getName:function(){return this.name},getParentElement:function(){return this.parentElement},getState:function(){return this.state},instantiateHtmlElements:function(){this.listItemElement=this.factory.create("li",null,this.parentElement,WidgetElementFactory.Positions.lastChild,{id:this.name});this.spanElement=this.factory.create("span",null,this.listItemElement,WidgetElementFactory.Positions.lastChild,{"class":this.options.dividerStyle});this.imageElement=this.factory.create("img",null,this.spanElement,WidgetElementFactory.Positions.lastChild,{src:this.dividerIconImageUri})},unmarshallProperties:function(){this.dividerIconImageUri=XmlResource.selectNodeText(this.options.iconImageSelector,this.definitionXml,null,this.options.dividerIconImageUri)}.protect(),});var ToolBarWidget=new Class({Extends:BrowserWidget,Binds:["onButtonSelection"],options:{buttonsSelector:"/toolBarDefinition/buttons/button | /toolBarDefinition/buttons/divider",componentName:"ToolBarWidget",descriptionSelector:"/toolBarDefinition/description",dividerIconImageUri:"Desktops/Images/ToolboxDivider.jpg",listStyleSelector:"/toolBarDefinition/buttons/@elementStyle",nameSelector:"/toolBarDefinition/name",showCaptionsSelector:"/toolBarDefinition/showCaptions"},initialize:function(a,b){this.parent(a,b);this.buttons=new LinkedHashMap();this.description;this.dividers=new ArrayList();this.name;this.listElement;this.listStyle;this.showCaptions=false;this.wrapperElement},construct:function(){this.constructHtmlElements();this.constructButtons();return this.parent()},destroy:function(){this.destroyButtons();this.destroyDividers();if(this.listElement&&this.listElement.destroy){this.listElement.destroy()}if(this.wrapperElement&&this.wrapperElement.destroy){this.wrapperElement.destroy()}this.parent()},onButtonSelection:function(button){var argumentText=button.getMessageProperties();var arguments=argumentText!=null?eval("("+argumentText+")"):null;arguments.originator=this.name;this.messageBus.notifySubscribers(new MenuSelectedMessage(arguments))},unmarshall:function(){this.unmarshallProperties();this.unmarshallButtons();return this.parent()},getButtons:function(){return this.buttons},getDescription:function(){return this.description},getListStyle:function(){return this.listStyle},getName:function(){return this.name},constructButtons:function(){this.buttons.each(function(a,c){var b=a.getValue();b.construct(this.listElement)},this)}.protect(),constructHtmlElements:function(){this.wrapperElement=this.elementFactory.create("div",null,this.containerElement,WidgetElementFactory.Positions.LastChild,{id:this.name});this.listElement=this.elementFactory.create("ul",null,this.wrapperElement,WidgetElementFactory.Positions.LastChild,{"class":this.listStyle})}.protect(),destroyButtons:function(){this.buttons.each(function(a,b){var c=a.getValue();c.destroy()},this);this.buttons.clear()}.protect(),destroyDividers:function(){this.buttons.each(function(b,a){b.destroy()},this);this.buttons.clear()}.protect(),unmarshallButtons:function(){var a=this.definitionXml.selectNodes(this.options.buttonsSelector);a.each(function(d,c){var b=ToolBarButtonFactory.create(d,this.elementFactory,{onSelection:this.onButtonSelection,showCaption:this.showCaptions,dividerIconImageUri:this.options.dividerIconImageUri});b.unmarshall();this.buttons.put(b.getName(),b)},this)}.protect(),unmarshallProperties:function(){this.description=this.definitionXml.selectNodeText(this.options.descriptionSelector);this.listStyle=this.definitionXml.selectNodeText(this.options.listStyleSelector);this.name=this.definitionXml.selectNodeText(this.options.nameSelector);this.showCaptions=parseBoolean(this.definitionXml.selectNodeText(this.options.showCaptionsSelector,null,false))}.protect()});var VideoPlayerWidget=new Class({Extends:ToolBarWidget,options:{componentName:"VideoPlayerWidget",descriptionSelector:"/pp:widgetDefinition/description",nameSelector:"/pp:widgetDefinition/name"},initialize:function(a,b){this.setOptions(a);this.parent(a,b)},construct:function(){return this.parent()},destroy:function(){this.parent()},unmarshall:function(){return this.parent()},});function getWebUIController(){try{return parent.webUIController}catch(a){return null}}function loadDocument(a,b,c){getWebUIController().loadDocument(a,b,c)}function loadInfo(a,b,c){getWebUIController().loadInfoPanelDocument(a,b,c)}function setToDirty(){getWebUIController().getDocumentManager().getActiveDocument().setToDirty()}function setToClean(){getWebUIController().getDocumentManager().getActiveDocument().setToClean()}function saveDocument(){getWebUIController().getDocumentManager().getActiveDocument().save()}function cancelModification(){getWebUIController().getDocumentManager().getActiveDocument().cancel()}var UnconfiguredWebUIControllerException=new Class({Extends:WebUIException,options:{description:"WebUIController is unconfigured, therefore the requested operation can't be carried out.",name:"UnconfiguredWebUIControllerException"},initialize:function(a){this.setOptions(a);this.parent(a)}});ROOT_LOGGER_NAME="WebUI";FRONT_CONTROLLER="CommandControllerServlet";var WebUIController=new Class({Implements:[Class.Singleton,Events,Options],Binds:["changeLanguage","constructDesktop","configureLogger","destroySplashForm","determineCurrentUserLocale","finalizeConfiguration","loadDocument","loadInternationalizations","loadWebUIConfiguration","onDesktopConstructed","onError","restoreStateFromUrl","storeComponentState","storeStateInUrl","subscribeToWebUIMessages","webUIMessageHandler"],options:{artifactTypesXslt:"Commons/JavaScript/WebUIController/TransformBusinessDefinitionToArtifactTypes.xsl",compatibleBrowserVersions:{ie:8,firefox:4,safari:4,chrome:10,opera:10},componentName:"WebUIController",configurationUri:"Configuration.xml",contextRootPrefix:"../../",errorPageUri:"Commons/FrontController/WebUiError.jsp",languageSelectorElementId:"LanguageSelectorWidget",loggerGroupName:"WebUIController",messageOriginator:"webUIController",reConfigurationDelay:500,showSplashForm:false,splashFormUri:"Desktops/Images/SplashForm.png",unsupportedBrowserMessage:"We appologize. This site utilizes more modern browsers, namely: Internet Explorer 8+, FireFox 4+, Chrome 10+, Safari 4+",urlRefreshPeriod:3000,window:window},initialize:function(b,a){return this.check()||this.setUp(b,a)},setUp:function(b,a){this.setOptions(b);if(a!=null&&a!="undefined"){this.options.window=a}this.configurationChain=new Chain();this.desktop;this.error;this.isConfigured=false;this.languageSelector;this.locale;this.logger;this.messageBus=new WebUIMessageBus();this.resourceBundle;this.prefferedLanguage;this.recentHash=this.determineCurrentHash();this.refreshUrlTimer;this.skin;this.splashForm;this.stateManager=new ComponentStateManager();this.userName;this.userLocation;this.warningContainer;this.webUIConfiguration;this.webUIException;if(this.browserIsSupported()){if(this.options.showSplashForm){this.showSplashForm()}this.loadWebUIConfiguration();this.configureLogger();this.restoreStateFromUrl(),this.determineCurrentUserLocale();this.determineDefaultSkin();this.loadInternationalizations();this.logger.debug("Browser Interface is initialized with context root prefix: "+this.options.contextRootPrefix)}else{this.showWebUIExceptionPage(new Error(this.options.unsupportedBrowserMessage))}}.protect(),changeLanguage:function(a){this.logger.debug(this.options.componentName+".changeLanguage().");this.destroy();this.locale=a;this.configure.delay(this.options.reConfigurationDelay,this)},changeSkin:function(a){this.logger.debug(this.options.componentName+".changeSkin().");this.destroy();this.skin=a;this.configure.delay(this.options.reConfigurationDelay,this)},configure:function(){this.configurationChain.chain(this.loadWebUIConfiguration,this.configureLogger,this.restoreStateFromUrl,this.determineCurrentUserLocale,this.loadInternationalizations,this.constructDesktop,this.subscribeToWebUIMessages,this.storeComponentState,this.destroySplashForm,this.finalizeConfiguration).callChain()},destroy:function(){if(this.isConfigured){this.locale=null;this.messageBus.tearDown();if(this.languageSelector){this.languageSelector.destroy()}this.desktop.destroy();this.webUIConfiguration.release();this.resourceBundle.release();this.options.window.location.hash="";clearInterval(this.refreshUrlTimer);this.isConfigured=false}},loadDocument:function(d,b,a){this.logger.debug(this.options.componentName+".loadDocument( '"+d+"' )");var c=new MenuSelectedMessage({activityType:AbstractDocument.Activity.LOAD_DOCUMENT,documentType:a,documentURI:d,documentContentURI:b,originator:this.options.messageOriginator});this.messageBus.notifySubscribers(c)},loadHtmlDocument:function(a){this.loadDocument(a,null,AbstractDocument.Types.HTML)},loadSmartDocument:function(b,a){this.loadDocument(b,a,AbstractDocument.Types.SMART)},onDesktopConstructed:function(){this.logger.debug(this.options.componentName+", constructing desktop is finished.");this.configurationChain.callChain()},onError:function(a){this.error=a;this.showWebUIExceptionPage(this.error)},restoreStateFromUrl:function(){this.logger.debug(this.options.componentName+".restoreStateFromUrl() started.");if(this.options.window.location.hash.substring(2)){var a=this.stateManager.toString();try{this.stateManager.parse(this.options.window.location.hash.substring(2));this.messageBus.notifySubscribers(new WebUIStateRestoredMessage())}catch(b){this.stateManager.parse(a);this.logger.debug("restoreStateFromUrl() exception: "+b)}}this.configurationChain.callChain()},storeStateInUrl:function(){var a=this.stateManager.toString();if(this.recentHash!=a){this.recentHash=a;this.options.window.location.hash="!"+a}},webUIMessageHandler:function(a){if(!this.isConfigured){throw new UnconfiguredWebUIControllerException({source:"WebUIController.webUIMessageHandler()"})}if(instanceOf(a,LanguageChangedMessage)&&a.getNewLocale()!=this.getCurrentLocale()){this.changeLanguage(a.getNewLocale())}else{if(instanceOf(a,SkinChangedMessage)&&a.getNewSkin()!=this.getCurrentSkin()){this.changeSkin(a.getNewSkin())}}this.lastHandledMessage=a},getContextRootPrefix:function(){return this.contextRootPrefix},getCurrentLocale:function(){return this.locale},getCurrentSkin:function(){return this.skin},getDesktop:function(){return this.desktop},getIsConfigured:function(){return this.isConfigured},getLanguageSelector:function(){return this.languageSelector},getLocale:function(){return this.locale},getLogger:function(){return this.logger},getMessageBus:function(){return this.messageBus},getPrefferedLanguage:function(){return this.prefferedLanguage},getResourceBundle:function(){return this.resourceBundle},getStateManager:function(){return this.stateManager},getText:function(b,a){return this.getTextInternal(b,a)},getUserLocation:function(){return this.userLocation},getUserName:function(){return this.userName},getWebUIConfiguration:function(){return this.webUIConfiguration},getWebUIException:function(){return this.webUiException},setUserLocation:function(a){this.userLocation=a},setUserName:function(a){this.userName=a},setLanguage:function(a){this.setLanguageInternal(a)},browserIsSupported:function(){if(Browser.version>=this.options.compatibleBrowserVersions[Browser.name]){return true}else{return false}}.protect(),configureLogger:function(){this.logger=new WebUILogger(this.webUIConfiguration);this.logger.debug(this.options.componentName+".configureLogger() started.");this.configurationChain.callChain()}.protect(),constructDesktop:function(){this.logger.debug(this.options.componentName+".constructDesktop() started.");var a=this.webUIConfiguration.getSkinConfiguration(this.skin);this.desktop=new Desktop(this.webUIConfiguration,this.resourceBundle,{configurationURI:a,onConstructed:this.onDesktopConstructed,onError:this.onError});this.desktop.unmarshall();try{this.desktop.construct()}catch(b){this.onError(b)}}.protect(),destroySplashForm:function(){if(this.splashForm){this.splashForm.destroy()}this.configurationChain.callChain()}.protect(),determineCurrentHash:function(){if(this.options.window.location.hash.indexOf("#")!=-1){return this.options.window.location.hash.substring(1)}else{return""}}.protect(),determineCurrentUserLocale:function(){this.logger.debug(this.options.componentName+".determineCurrentUserLocale() started.");var a=new Locale();a.parse(navigator.language||navigator.userLanguage);a.options.country=null;a.options.variant=null;if(this.locale==null){var c=this.stateManager.retrieveComponentState(this.options.componentName);if(c){var b=c.locale;this.locale=new Locale();this.locale.parse(b)}else{if(this.webUIConfiguration.isSupportedLocale(a)){this.locale=a}else{this.locale=new Locale();this.locale.parse(this.webUIConfiguration.getI18DefaultLocale())}}}this.configurationChain.callChain()}.protect(),determineDefaultSkin:function(){this.skin=this.webUIConfiguration.getDefaultSkin()}.protect(),finalizeConfiguration:function(){this.refreshUrlTimer=this.storeStateInUrl.periodical(this.options.urlRefreshPeriod,this);this.isConfigured=true;this.fireEvent("configured",this)}.protect(),getTextInternal:function(c,a){if(this.resourceBundle==null){if(a!=null){return a}else{return c}}var d;try{d=this.resourceBundle.getText(c)}catch(f){if(f instanceof IllegalArgumentException){if(a!=null){return a}return c}else{var b=new UserException("Unknown problem occured.","WebUIController getText()");throw b}}return d}.protect(),loadInternationalizations:function(){this.logger.debug(this.options.componentName+".loadInternationalizations() started.");try{this.resourceBundle=new XMLResourceBundle(this.webUIConfiguration);this.resourceBundle.load(this.locale);this.logger.debug("Resource bundles: "+this.options.contextRootPrefix+this.resourceBundle.getResourceBundleNames()+" was loaded.")}catch(a){this.onError(a)}this.configurationChain.callChain()}.protect(),loadWebUIConfiguration:function(){try{this.webUIConfiguration=new WebUIConfiguration(this.options.configurationUri);if(!this.webUIConfiguration.isLoaded){this.webUIConfiguration.load()}}catch(a){this.onError(a)}this.configurationChain.callChain()}.protect(),setLanguage:function(b){this.logger.debug(this.options.componentName+".setLanguage() started.");prefferedLanguage=b;if(b!=null){var a=new Locale(b);if(applicationConfiguration!=null){applicationConfiguration.setLocale(a);this.loadInternationalizations(applicationConfiguration.getBundlePath(),a)}}}.protect(),showSplashForm:function(){this.splashForm=new SplashForm({imageUri:this.options.splashFormUri});this.splashForm.construct()}.protect(),showWebUIExceptionPage:function(c){var d=$$("body");this.warningContainer=new Element("div",{id:"warning"});d.grab(this.warningContainer,"top");var f=new Element("h1");f.appendText("Error Occured");this.warningContainer.grab(f);var a=new Element("h3");a.appendText(c.name);this.warningContainer.grab(a);var b=new Element("p");b.appendText(c.message);this.warningContainer.grab(b);var e=new Element("p");if(c.stack){e.appendText(c.stack);this.warningContainer.grab(e)}}.protect(),storeComponentState:function(){this.logger.debug(this.options.componentName+".storeComponentState() started.");this.stateManager.storeComponentState(this.options.componentName,{locale:this.locale.toString()});this.configurationChain.callChain()}.protect(),subscribeToWebUIMessages:function(){this.logger.debug(this.options.componentName+".subscribeToWebUIMessages() started.");this.messageBus.subscribeToMessage(LanguageChangedMessage,this.webUIMessageHandler);this.messageBus.subscribeToMessage(SkinChangedMessage,this.webUIMessageHandler);this.configurationChain.callChain()}.protect()});var WebUIStateRestoredMessage=new Class({Extends:WebUIMessage,options:{description:"State of Web User Interface restored from URL.",name:"WebUIStateRestoredMessage"},initialize:function(a){this.setOptions(a);this.options.messageClass=WebUIStateRestoredMessage}});var TestMessageOne=new Class({Extends:WebUIMessage,options:{description:"Test Message One description",name:"Test Message One"},initialize:function(a){this.setOptions(a);this.options.messageClass=TestMessageOne}});var TestMessageTwo=new Class({Extends:WebUIMessage,options:{description:"Test Message Two description",name:"Test Message Two"},initialize:function(a){this.setOptions(a);this.options.messageClass=TestMessageTwo}});